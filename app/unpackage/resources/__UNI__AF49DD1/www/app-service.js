if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const i=t=>(a,i=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,a,i)},o=i("onLoad"),r=i("onUnload"),l={data:()=>({}),created(){this.popup=this.getParent()},methods:{getParent(e="uniPopup"){let t=this.$parent,a=t.$options.name;for(;a!==e;){if(t=t.$parent,!t)return!1;a=t.$options.name}return t}}},n=["{","}"];const s=/^(?:\d)+/,c=/^(?:\w)+/;const h="zh-Hans",d="zh-Hant",u="en",p=Object.prototype.hasOwnProperty,x=(e,t)=>p.call(e,t),g=new class{constructor(){this._caches=Object.create(null)}interpolate(e,t,a=n){if(!t)return[e];let i=this._caches[e];return i||(i=function(e,[t,a]){const i=[];let o=0,r="";for(;o<e.length;){let l=e[o++];if(l===t){r&&i.push({type:"text",value:r}),r="";let t="";for(l=e[o++];void 0!==l&&l!==a;)t+=l,l=e[o++];const n=l===a,h=s.test(t)?"list":n&&c.test(t)?"named":"unknown";i.push({value:t,type:h})}else r+=l}return r&&i.push({type:"text",value:r}),i}(e,a),this._caches[e]=i),function(e,t){const a=[];let i=0;const o=Array.isArray(t)?"list":(r=t,null!==r&&"object"==typeof r?"named":"unknown");var r;if("unknown"===o)return a;for(;i<e.length;){const r=e[i];switch(r.type){case"text":a.push(r.value);break;case"list":a.push(t[parseInt(r.value,10)]);break;case"named":"named"===o&&a.push(t[r.value])}i++}return a}(i,t)}};function f(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if("chinese"===(e=e.toLowerCase()))return h;if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?h:e.indexOf("-hant")>-1?d:(a=e,["-tw","-hk","-mo","-cht"].find((e=>-1!==a.indexOf(e)))?d:h);var a;let i=[u,"fr","es"];t&&Object.keys(t).length>0&&(i=Object.keys(t));const o=function(e,t){return t.find((t=>0===e.indexOf(t)))}(e,i);return o||void 0}class m{constructor({locale:e,fallbackLocale:t,messages:a,watcher:i,formater:o}){this.locale=u,this.fallbackLocale=u,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=o||g,this.messages=a||{},this.setLocale(e||u),i&&this.watchLocale(i)}setLocale(e){const t=this.locale;this.locale=f(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach((e=>{e(this.locale,t)}))}getLocale(){return this.locale}watchLocale(e){const t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,a=!0){const i=this.messages[e];i?a?Object.assign(i,t):Object.keys(t).forEach((e=>{x(i,e)||(i[e]=t[e])})):this.messages[e]=t}f(e,t,a){return this.formater.interpolate(e,t,a).join("")}t(e,t,a){let i=this.message;return"string"==typeof t?(t=f(t,this.messages))&&(i=this.messages[t]):a=t,x(i,e)?this.formater.interpolate(i[e],a).join(""):(console.warn(`Cannot translate the value of keypath ${e}. Use the value of keypath as default.`),e)}}const y={en:{"uni-popup.cancel":"cancel","uni-popup.ok":"ok","uni-popup.placeholder":"pleace enter","uni-popup.title":"Hint","uni-popup.shareTitle":"Share to"},"zh-Hans":{"uni-popup.cancel":"取消","uni-popup.ok":"确定","uni-popup.placeholder":"请输入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"},"zh-Hant":{"uni-popup.cancel":"取消","uni-popup.ok":"確定","uni-popup.placeholder":"請輸入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}},v=(e,t)=>{const a=e.__vccOpts||e;for(const[i,o]of t)a[i]=o;return a},{t:b}=function(e,t={},a,i){if("string"!=typeof e){const a=[t,e];e=a[0],t=a[1]}"string"!=typeof e&&(e="undefined"!=typeof uni&&uni.getLocale?uni.getLocale():"undefined"!=typeof global&&global.getLocale?global.getLocale():u),"string"!=typeof a&&(a="undefined"!=typeof __uniConfig&&__uniConfig.fallbackLocale||u);const o=new m({locale:e,fallbackLocale:a,messages:t,watcher:i});let r=(e,t)=>{if("function"!=typeof getApp)r=function(e,t){return o.t(e,t)};else{let e=!1;r=function(t,a){const i=getApp().$vm;return i&&(i.$locale,e||(e=!0,function(e,t){e.$watchLocale?e.$watchLocale((e=>{t.setLocale(e)})):e.$watch((()=>e.$locale),(e=>{t.setLocale(e)}))}(i,o))),o.t(t,a)}}return r(e,t)};return{i18n:o,f:(e,t,a)=>o.f(e,t,a),t:(e,t)=>r(e,t),add:(e,t,a=!0)=>o.add(e,t,a),watch:e=>o.watchLocale(e),getLocale:()=>o.getLocale(),setLocale:e=>o.setLocale(e)}}(y);const w=v({name:"uniPopupDialog",mixins:[l],emits:["confirm","close","update:modelValue","input"],props:{inputType:{type:String,default:"text"},showClose:{type:Boolean,default:!0},modelValue:{type:[Number,String],default:""},placeholder:{type:[String,Number],default:""},type:{type:String,default:"error"},mode:{type:String,default:"base"},title:{type:String,default:""},content:{type:String,default:""},beforeClose:{type:Boolean,default:!1},cancelText:{type:String,default:""},confirmText:{type:String,default:""},maxlength:{type:Number,default:-1},focus:{type:Boolean,default:!0}},data:()=>({dialogType:"error",val:""}),computed:{okText(){return this.confirmText||b("uni-popup.ok")},closeText(){return this.cancelText||b("uni-popup.cancel")},placeholderText(){return this.placeholder||b("uni-popup.placeholder")},titleText(){return this.title||b("uni-popup.title")}},watch:{type(e){this.dialogType=e},mode(e){"input"===e&&(this.dialogType="info")},value(e){-1!=this.maxlength&&"input"===this.mode?this.val=e.slice(0,this.maxlength):this.val=e},val(e){this.$emit("update:modelValue",e)}},created(){this.popup.disableMask(),"input"===this.mode?(this.dialogType="info",this.val=this.value,this.val=this.modelValue):this.dialogType=this.type},methods:{onOk(){"input"===this.mode?this.$emit("confirm",this.val):this.$emit("confirm"),this.beforeClose||this.popup.close()},closeDialog(){this.$emit("close"),this.beforeClose||this.popup.close()},close(){this.popup.close()}}},[["render",function(t,a,i,o,r,l){return e.openBlock(),e.createElementBlock("view",{class:"uni-popup-dialog"},[e.createElementVNode("view",{class:"uni-dialog-title"},[e.createElementVNode("text",{class:e.normalizeClass(["uni-dialog-title-text",["uni-popup__"+r.dialogType]])},e.toDisplayString(l.titleText),3)]),"base"===i.mode?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-dialog-content"},[e.renderSlot(t.$slots,"default",{},(()=>[e.createElementVNode("text",{class:"uni-dialog-content-text"},e.toDisplayString(i.content),1)]),!0)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"uni-dialog-content"},[e.renderSlot(t.$slots,"default",{},(()=>[e.withDirectives(e.createElementVNode("input",{class:"uni-dialog-input",maxlength:i.maxlength,"onUpdate:modelValue":a[0]||(a[0]=e=>r.val=e),type:i.inputType,placeholder:l.placeholderText,focus:i.focus},null,8,["maxlength","type","placeholder","focus"]),[[e.vModelDynamic,r.val]])]),!0)])),e.createElementVNode("view",{class:"uni-dialog-button-group"},[i.showClose?(e.openBlock(),e.createElementBlock("view",{key:0,class:"uni-dialog-button",onClick:a[1]||(a[1]=(...e)=>l.closeDialog&&l.closeDialog(...e))},[e.createElementVNode("text",{class:"uni-dialog-button-text"},e.toDisplayString(l.closeText),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["uni-dialog-button",i.showClose?"uni-border-left":""]),onClick:a[2]||(a[2]=(...e)=>l.onOk&&l.onOk(...e))},[e.createElementVNode("text",{class:"uni-dialog-button-text uni-button-color"},e.toDisplayString(l.okText),1)],2)])])}],["__scopeId","data-v-fcde97b3"]]);class S{constructor(e,t){this.options=e,this.animation=uni.createAnimation({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let a=this.currentStepAnimates[this.next],i={};if(i=a||{styles:{},config:{}},A.includes(e)){i.styles.transform||(i.styles.transform="");let a="";"rotate"===e&&(a="deg"),i.styles.transform+=`${e}(${t+a}) `}else i.styles[e]=`${t}`;this.currentStepAnimates[this.next]=i}_animateRun(e={},t={}){let a=this.$.$refs.ani.ref;if(a)return new Promise(((i,o)=>{nvueAnimation.transition(a,{styles:e,...t},(e=>{i()}))}))}_nvueNextAnimate(e,t=0,a){let i=e[t];if(i){let{styles:o,config:r}=i;this._animateRun(o,r).then((()=>{t+=1,this._nvueNextAnimate(e,t,a)}))}else this.currentStepAnimates={},"function"==typeof a&&a(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const A=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function T(e,t){if(t)return clearTimeout(t.timer),new S(e,t)}A.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{S.prototype[e]=function(...t){return this.animation[e](...t),this}}));const k=v({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let a in e){t+=this.toLine(a)+":"+e[a]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=T(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){if(this.animation){for(let t in e)try{"object"==typeof e[t]?this.animation[t](...e[t]):this.animation[t](e[t])}catch(a){console.error(`方法 ${t} 不存在`)}return this.animation.step(t),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=T(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},a=(e,a)=>{"fade"===a?t.opacity=this.animationType(e)[a]:t.transform+=this.animationType(e)[a]+" "};return"string"==typeof this.modeClass?a(e,this.modeClass):this.modeClass.forEach((t=>{a(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let a=null;"fade"===t?a=e?0:1:(a=e?"-100%":"0","zoom-in"===t&&(a=e?.8:1),"zoom-out"===t&&(a=e?1.2:1),"slide-right"===t&&(a=e?"100%":"0"),"slide-bottom"===t&&(a=e?"100%":"0")),this.animation[this.animationMode()[t]](a)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((a=>{t(e,a)})),this.animation},animationType:e=>({fade:e?0:1,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,a,i,o,r,l){return e.withDirectives((e.openBlock(),e.createElementBlock("view",{ref:"ani",animation:r.animationData,class:e.normalizeClass(i.customClass),style:e.normalizeStyle(l.transformStyles),onClick:a[0]||(a[0]=(...e)=>l.onClick&&l.onClick(...e))},[e.renderSlot(t.$slots,"default")],14,["animation"])),[[e.vShow,r.isShow]])}]]);const C=v({name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},borderRadius:{type:String}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{backgroundColor:"transparent",borderRadius:this.borderRadius||"0",position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}},computed:{getStyles(){let e={backgroundColor:this.bg};return this.borderRadius,e=Object.assign(e,{borderRadius:this.borderRadius}),e},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:a,safeArea:i,screenHeight:o,safeAreaInsets:r}=uni.getSystemInfoSync();this.popupWidth=e,this.popupHeight=t+(a||0),i&&this.safeArea?this.safeAreaInsets=r.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},activated(){this.setH5Visible(!this.showPopup)},deactivated(){this.setH5Visible(!0)},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(e=!0){},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]?(this[this.config[e]](),this.$emit("change",{show:!0,type:e})):console.error("缺少类型：",e)},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.showPoptrans(),this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||this.showPoptrans()},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius||"0"},e||this.showPoptrans()},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||this.showPoptrans()},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||this.showPoptrans()},showPoptrans(){this.$nextTick((()=>{this.showPopup=!0,this.showTrans=!0}))}}},[["render",function(t,i,o,r,l,n){const s=a(e.resolveDynamicComponent("uni-transition"),k);return l.showPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-popup",[l.popupstyle,n.isDesktop?"fixforpc-z-index":""]])},[e.createElementVNode("view",{onTouchstart:i[1]||(i[1]=(...e)=>n.touchstart&&n.touchstart(...e))},[l.maskShow?(e.openBlock(),e.createBlock(s,{key:"1",name:"mask","mode-class":"fade",styles:l.maskClass,duration:l.duration,show:l.showTrans,onClick:n.onTap},null,8,["styles","duration","show","onClick"])):e.createCommentVNode("",!0),e.createVNode(s,{key:"2","mode-class":l.ani,name:"content",styles:l.transClass,duration:l.duration,show:l.showTrans,onClick:n.onTap},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-popup__wrapper",[l.popupstyle]]),style:e.normalizeStyle(n.getStyles),onClick:i[0]||(i[0]=(...e)=>n.clear&&n.clear(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)])),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],2)):e.createCommentVNode("",!0)}],["__scopeId","data-v-8c8ca210"]]),P="192.168.1.100",E={API_BASE_URL:`http://${P}:3000`,SERVER_IP:P,VIDEO_SERVER_IP:P},_={__name:"device",setup(i){const o=e.ref([]),r=e.ref(0),l=e.ref(1),n=e.ref(9),s=e.ref(!1),c=e.ref(null),h=e.ref(null),d=e.ref({device_name:"",number:"",remarks:""}),u=e.ref(null),p=e.ref(null),x=async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/devices",method:"GET",data:{page:l.value,pageSize:n.value}});200===e.statusCode&&(o.value=e.data.data,r.value=e.data.total)}catch(e){t("error","at pages/device.vue:117","获取机房列表失败:",e),uni.showToast({title:"获取机房列表失败",icon:"none"})}},g=e=>{uni.navigateTo({url:`/pages/roomDetail?roomId=${e.number}`})},f=()=>{s.value=!1,S(),u.value.open()},m=async()=>{try{const e=s.value?`${E.API_BASE_URL}/api/devices/${c.value}`:`${E.API_BASE_URL}/api/devices`,t=s.value?"PUT":"POST";200===(await uni.request({url:e,method:t,data:d.value})).statusCode&&(uni.showToast({title:s.value?"更新成功":"添加成功",icon:"success"}),u.value.close(),S(),await x())}catch(e){t("error","at pages/device.vue:182","提交失败:",e),uni.showToast({title:s.value?"更新失败":"添加失败",icon:"none"})}},y=async()=>{try{200===(await uni.request({url:`${E.API_BASE_URL}/api/devices/${h.value}`,method:"DELETE"})).statusCode&&(uni.showToast({title:"删除成功",icon:"success"}),p.value.close(),await x())}catch(e){t("error","at pages/device.vue:207","删除失败:",e),uni.showToast({title:"删除失败",icon:"none"})}},v=()=>{S()},b=()=>{h.value=null},S=()=>{d.value={device_name:"",number:"",remarks:""},s.value=!1,c.value=null},A=()=>{l.value>1&&(l.value--,x())},T=()=>{l.value<Math.ceil(r.value/n.value)&&(l.value++,x())};return e.onMounted((()=>{x()})),(t,i)=>{const x=a(e.resolveDynamicComponent("uni-popup-dialog"),w),S=a(e.resolveDynamicComponent("uni-popup"),C);return e.openBlock(),e.createElementBlock("view",{class:"device-container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},"机房导航"),e.createElementVNode("button",{class:"add-btn",onClick:f},"+ 添加机房")]),e.createElementVNode("view",{class:"room-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"room-card",onClick:e=>g(t)},[e.createElementVNode("view",{class:"room-image"},[e.createElementVNode("text",{class:"room-icon"},"🏢")]),e.createElementVNode("view",{class:"room-info"},[e.createElementVNode("text",{class:"room-name"},e.toDisplayString(t.device_name),1),e.createElementVNode("text",{class:"room-number"},"编号: "+e.toDisplayString(t.number),1),e.createElementVNode("view",{class:"room-status"},[e.createElementVNode("text",{class:"status-tag success"},"运行正常")]),e.createElementVNode("text",{class:"room-desc"},e.toDisplayString(t.remarks||"暂无描述"),1),e.createElementVNode("view",{class:"room-actions"},[e.createElementVNode("button",{class:"action-btn edit",onClick:e.withModifiers((e=>(e=>{s.value=!0,c.value=e.id,d.value={device_name:e.device_name,number:e.number,remarks:e.remarks},u.value.open()})(t)),["stop"])},"编辑",8,["onClick"]),e.createElementVNode("button",{class:"action-btn detail",onClick:e.withModifiers((e=>g(t)),["stop"])},"详情",8,["onClick"]),e.createElementVNode("button",{class:"action-btn delete",onClick:e.withModifiers((e=>(e=>{h.value=e.id,p.value.open()})(t)),["stop"])},"删除",8,["onClick"])])])],8,["onClick"])))),128))]),e.createElementVNode("view",{class:"pagination"},[e.createElementVNode("button",{disabled:l.value<=1,onClick:A,class:"page-btn"},"上一页",8,["disabled"]),e.createElementVNode("text",{class:"page-info"},"第 "+e.toDisplayString(l.value)+" 页，共 "+e.toDisplayString(Math.ceil(r.value/n.value))+" 页",1),e.createElementVNode("button",{disabled:l.value>=Math.ceil(r.value/n.value),onClick:T,class:"page-btn"},"下一页",8,["disabled"])]),e.createVNode(S,{ref_key:"addPopup",ref:u,type:"dialog"},{default:e.withCtx((()=>[e.createVNode(x,{title:s.value?"编辑机房":"添加机房",value:d.value,placeholder:"请输入机房信息",onConfirm:m,onClose:v},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"form-content"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"机房名称:"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[0]||(i[0]=e=>d.value.device_name=e),placeholder:"请输入机房名称",class:"form-input"},null,512),[[e.vModelText,d.value.device_name]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"机房编号:"),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[1]||(i[1]=e=>d.value.number=e),placeholder:"请输入机房编号",class:"form-input"},null,512),[[e.vModelText,d.value.number]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"描述:"),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":i[2]||(i[2]=e=>d.value.remarks=e),placeholder:"请输入机房描述",class:"form-textarea"},null,512),[[e.vModelText,d.value.remarks]])])])])),_:1},8,["title","value"])])),_:1},512),e.createVNode(S,{ref_key:"deletePopup",ref:p,type:"dialog"},{default:e.withCtx((()=>[e.createVNode(x,{title:"确认删除",content:"确定要删除这个机房吗？",onConfirm:y,onClose:b})])),_:1},512)])}}};var D={version:"v2.5.0-20230101",yAxisWidth:15,xAxisHeight:22,padding:[10,10,10,10],rotate:!1,fontSize:13,fontColor:"#666666",dataPointShape:["circle","circle","circle","circle"],color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#FC8452","#9A60B4","#ea7ccc"],linearColor:["#0EE2F8","#2BDCA8","#FA7D8D","#EB88E2","#2AE3A0","#0EE2F8","#EB88E2","#6773E3","#F78A85"],pieChartLinePadding:15,pieChartTextPadding:5,titleFontSize:20,subtitleFontSize:15,radarLabelTextMargin:13},N=function(e,...t){if(null==e)throw new TypeError("[uCharts] Cannot convert undefined or null to object");if(!t||t.length<=0)return e;function a(e,t){for(let i in t)e[i]=e[i]&&"[object Object]"===e[i].toString()?a(e[i],t[i]):e[i]=t[i];return e}return t.forEach((t=>{e=a(e,t)})),e},M={toFixed:function(e,t){return t=t||2,this.isFloat(e)&&(e=e.toFixed(t)),e},isFloat:function(e){return e%1!=0},approximatelyEqual:function(e,t){return Math.abs(e-t)<1e-10},isSameSign:function(e,t){return Math.abs(e)===e&&Math.abs(t)===t||Math.abs(e)!==e&&Math.abs(t)!==t},isSameXCoordinateArea:function(e,t){return this.isSameSign(e.x,t.x)},isCollision:function(e,t){return e.end={},e.end.x=e.start.x+e.width,e.end.y=e.start.y-e.height,t.end={},t.end.x=t.start.x+t.width,t.end.y=t.start.y-t.height,!(t.start.x>e.end.x||t.end.x<e.start.x||t.end.y>e.start.y||t.start.y<e.end.y)}};function L(e,t){var a=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,a,i){return t+t+a+a+i+i})),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+t+")"}function F(e,t,a){if(isNaN(e))throw new Error("[uCharts] series数据需为Number格式");a=a||10,t=t||"upper";for(var i=1;a<1;)a*=10,i*=10;for(e="upper"===t?Math.ceil(e*i):Math.floor(e*i);e%a!=0;)if("upper"===t){if(e==e+1)break;e++}else e--;return e/i}function V(e,t,a,i,o){var r=o.width-o.area[1]-o.area[3],l=a.eachSpacing*(o.chartData.xAxisData.xAxisPoints.length-1);"mount"==o.type&&o.extra&&o.extra.mount&&o.extra.mount.widthRatio&&o.extra.mount.widthRatio>1&&(o.extra.mount.widthRatio>2&&(o.extra.mount.widthRatio=2),l+=(o.extra.mount.widthRatio-1)*a.eachSpacing);var n=t;return t>=0?(n=0,e.uevent.trigger("scrollLeft"),e.scrollOption.position="left",o.xAxis.scrollPosition="left"):Math.abs(t)>=l-r?(n=r-l,e.uevent.trigger("scrollRight"),e.scrollOption.position="right",o.xAxis.scrollPosition="right"):(e.scrollOption.position=t,o.xAxis.scrollPosition=t),n}function I(e,t,a){function i(e){for(;e<0;)e+=2*Math.PI;for(;e>2*Math.PI;)e-=2*Math.PI;return e}return e=i(e),(t=i(t))>(a=i(a))&&(a+=2*Math.PI,e<t&&(e+=2*Math.PI)),e>=t&&e<=a}function B(e,t){function a(e,t){return!(!e[t-1]||!e[t+1])&&(e[t].y>=Math.max(e[t-1].y,e[t+1].y)||e[t].y<=Math.min(e[t-1].y,e[t+1].y))}function i(e,t){return!(!e[t-1]||!e[t+1])&&(e[t].x>=Math.max(e[t-1].x,e[t+1].x)||e[t].x<=Math.min(e[t-1].x,e[t+1].x))}var o=.2,r=.2,l=null,n=null,s=null,c=null;if(t<1?(l=e[0].x+(e[1].x-e[0].x)*o,n=e[0].y+(e[1].y-e[0].y)*o):(l=e[t].x+(e[t+1].x-e[t-1].x)*o,n=e[t].y+(e[t+1].y-e[t-1].y)*o),t>e.length-3){var h=e.length-1;s=e[h].x-(e[h].x-e[h-1].x)*r,c=e[h].y-(e[h].y-e[h-1].y)*r}else s=e[t+1].x-(e[t+2].x-e[t].x)*r,c=e[t+1].y-(e[t+2].y-e[t].y)*r;return a(e,t+1)&&(c=e[t+1].y),a(e,t)&&(n=e[t].y),i(e,t+1)&&(s=e[t+1].x),i(e,t)&&(l=e[t].x),(n>=Math.max(e[t].y,e[t+1].y)||n<=Math.min(e[t].y,e[t+1].y))&&(n=e[t].y),(c>=Math.max(e[t].y,e[t+1].y)||c<=Math.min(e[t].y,e[t+1].y))&&(c=e[t+1].y),(l>=Math.max(e[t].x,e[t+1].x)||l<=Math.min(e[t].x,e[t+1].x))&&(l=e[t].x),(s>=Math.max(e[t].x,e[t+1].x)||s<=Math.min(e[t].x,e[t+1].x))&&(s=e[t+1].x),{ctrA:{x:l,y:n},ctrB:{x:s,y:c}}}function z(e,t,a){return{x:a.x+e,y:a.y-t}}function O(e,t){if(t)for(;M.isCollision(e,t);)e.start.x>0?e.start.y--:e.start.x<0||e.start.y>0?e.start.y++:e.start.y--;return e}function R(e,t,a){for(var i=0,o=0;o<e.length;o++){let r=e[o];if(r.color||(r.color=a.color[i],i=(i+1)%a.color.length),r.linearIndex||(r.linearIndex=o),r.index||(r.index=0),r.type||(r.type=t.type),void 0===r.show&&(r.show=!0),r.type||(r.type=t.type),r.pointShape||(r.pointShape="circle"),!r.legendShape)switch(r.type){case"line":r.legendShape="line";break;case"column":case"bar":r.legendShape="rect";break;case"area":case"mount":r.legendShape="triangle";break;default:r.legendShape="circle"}}return e}function W(e,t,a,i){var o=t||[];if("custom"==e&&0==o.length&&(o=i.linearColor),"custom"==e&&o.length<a.length){let e=a.length-o.length;for(var r=0;r<e;r++)o.push(i.linearColor[(r+1)%i.linearColor.length])}return o}function $(e,t,a){var i=0;if(e=String(e),!1!==a&&void 0!==a&&a.setFontSize&&a.measureText)return a.setFontSize(t),a.measureText(e).width;e=e.split("");for(let o=0;o<e.length;o++){let t=e[o];/[a-zA-Z]/.test(t)?i+=7:/[0-9]/.test(t)?i+=5.5:/\./.test(t)?i+=2.7:/-/.test(t)?i+=3.25:/:/.test(t)?i+=2.5:/[\u4e00-\u9fa5]/.test(t)?i+=10:/\(|\)/.test(t)?i+=3.73:/\s/.test(t)?i+=2.5:/%/.test(t)?i+=8:i+=10}return i*t/10}function G(e){return e.reduce((function(e,t){return(e.data?e.data:e).concat(t.data)}),[])}function X(e,t){for(var a=new Array(t),i=0;i<a.length;i++)a[i]=0;for(var o=0;o<e.length;o++)for(i=0;i<a.length;i++)a[i]+=e[o].data[i];return e.reduce((function(e,t){return(e.data?e.data:e).concat(t.data).concat(a)}),[])}function U(e,t,a){let i,o;return e.clientX?t.rotate?(o=t.height-e.clientX*t.pix,i=(e.pageY-a.currentTarget.offsetTop-t.height/t.pix/2*(t.pix-1))*t.pix):(i=e.clientX*t.pix,o=(e.pageY-a.currentTarget.offsetTop-t.height/t.pix/2*(t.pix-1))*t.pix):t.rotate?(o=t.height-e.x*t.pix,i=e.y*t.pix):(i=e.x*t.pix,o=e.y*t.pix),{x:i,y:o}}function H(e,t,a){var i=[],o=[],r=t.constructor.toString().indexOf("Array")>-1;if(r){let t=j(e);for(var l=0;l<a.length;l++)o.push(t[a[l]])}else o=e;for(let n=0;n<o.length;n++){let e=o[n],a=-1;if(a=r?t[n]:t,null!==e.data[a]&&void 0!==e.data[a]&&e.show){let t={};t.color=e.color,t.type=e.type,t.style=e.style,t.pointShape=e.pointShape,t.disableLegend=e.disableLegend,t.legendShape=e.legendShape,t.name=e.name,t.show=e.show,t.data=e.formatter?e.formatter(e.data[a]):e.data[a],i.push(t)}}return i}function q(e,t,a,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},l=t.chartData.calPoints?t.chartData.calPoints:[];let n={};if(i.length>0){let e=[];for(let t=0;t<i.length;t++)e.push(l[i[t]]);n=e[0][a[0]]}else for(let s=0;s<l.length;s++)if(l[s][a]){n=l[s][a];break}return{textList:e.map((function(e){let i=null;return t.categories&&t.categories.length>0&&(i=o[a]),{text:r.formatter?r.formatter(e,i,a,t):e.name+": "+e.data,color:e.color,legendShape:"auto"==t.extra.tooltip.legendShape?e.legendShape:t.extra.tooltip.legendShape}})),offset:{x:Math.round(n.x),y:Math.round(n.y)}}}function j(e){let t=[];for(let a=0;a<e.length;a++)1==e[a].show&&t.push(e[a]);return t}function Y(e,t,a){return e.x<=t.width-t.area[1]+10&&e.x>=t.area[3]-10&&e.y>=t.area[0]&&e.y<=t.height-t.area[2]}function Z(e,t,a){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)<=Math.pow(a,2)}function J(e,t){var a=[],i=[];return e.forEach((function(e,o){t.connectNulls?null!==e&&i.push(e):null!==e?i.push(e):(i.length&&a.push(i),i=[])})),i.length&&a.push(i),a}function K(e,t,a,i,o){var r={angle:0,xAxisHeight:t.xAxis.lineHeight*t.pix+t.xAxis.marginTop*t.pix},l=t.xAxis.fontSize*t.pix,n=e.map((function(e,a){var i=t.xAxis.formatter?t.xAxis.formatter(e,a,t):e;return $(String(i),l,o)})),s=Math.max.apply(this,n);if(1==t.xAxis.rotateLabel){r.angle=t.xAxis.rotateAngle*Math.PI/180;let e=t.xAxis.marginTop*t.pix*2+Math.abs(s*Math.sin(r.angle));e=e<l+t.xAxis.marginTop*t.pix*2?e+t.xAxis.marginTop*t.pix*2:e,r.xAxisHeight=e}return t.enableScroll&&t.xAxis.scrollShow&&(r.xAxisHeight+=6*t.pix),t.xAxis.disabled&&(r.xAxisHeight=0),r}function Q(e,t,a,i){var o=N({},{type:""},t.extra.bar),r={angle:0,xAxisHeight:t.xAxis.lineHeight*t.pix+t.xAxis.marginTop*t.pix};r.ranges=function(e,t,a,i){var o,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;o="stack"==i?X(e,t.categories.length):G(e);var l=[];(o=o.filter((function(e){return"object"==typeof e&&null!==e?e.constructor.toString().indexOf("Array")>-1?null!==e:null!==e.value:null!==e}))).map((function(e){"object"==typeof e?e.constructor.toString().indexOf("Array")>-1?"candle"==t.type?e.map((function(e){l.push(e)})):l.push(e[0]):l.push(e.value):l.push(e)}));var n=0,s=0;l.length>0&&(n=Math.min.apply(this,l),s=Math.max.apply(this,l)),r>-1?("number"==typeof t.xAxis.data[r].min&&(n=Math.min(t.xAxis.data[r].min,n)),"number"==typeof t.xAxis.data[r].max&&(s=Math.max(t.xAxis.data[r].max,s))):("number"==typeof t.xAxis.min&&(n=Math.min(t.xAxis.min,n)),"number"==typeof t.xAxis.max&&(s=Math.max(t.xAxis.max,s))),n===s&&(s+=s||10);for(var c=n,h=[],d=(s-c)/t.xAxis.splitNumber,u=0;u<=t.xAxis.splitNumber;u++)h.push(c+d*u);return h}(e,t,a,o.type),r.rangesFormat=r.ranges.map((function(e){return e=M.toFixed(e,2)}));var l=r.ranges.map((function(e){return e=M.toFixed(e,2)}));return(r=Object.assign(r,oe(l,t))).eachSpacing,l.map((function(e){return $(e,t.xAxis.fontSize*t.pix,i)})),!0===t.xAxis.disabled&&(r.xAxisHeight=0),r}function ee(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=0,o=0;for(let r=0;r<e.length;r++){let t=e[r];t.data=null===t.data?0:t.data,i+=t.data}for(let r=0;r<e.length;r++){let o=e[r];o.data=null===o.data?0:o.data,o._proportion_=0===i?1/e.length*a:o.data/i*a,o._radius_=t}for(let r=0;r<e.length;r++){let t=e[r];t._start_=o,o+=2*t._proportion_*Math.PI}return e}function te(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=0,l=0,n=[];for(let d=0;d<e.length;d++){let t=e[d];t.data=null===t.data?0:t.data,r+=t.data,n.push(t.data)}var s=Math.min.apply(null,n),c=Math.max.apply(null,n),h=i-a;for(let d=0;d<e.length;d++){let l=e[d];l.data=null===l.data?0:l.data,0===r?(l._proportion_=1/e.length*o,l._rose_proportion_=1/e.length*o):(l._proportion_=l.data/r*o,l._rose_proportion_="area"==t?1/e.length*o:l.data/r*o),l._radius_=a+h*((l.data-s)/(c-s))||i}for(let d=0;d<e.length;d++){let t=e[d];t._start_=l,l+=2*t._rose_proportion_*Math.PI}return e}function ae(e,t,a,i,o,r){return e.map((function(e){if(null===e)return null;var o=0,l=0;return"mix"==r.type?(o=r.extra.mix.column.seriesGap*r.pix||0,l=r.extra.mix.column.categoryGap*r.pix||0):(o=r.extra.column.seriesGap*r.pix||0,l=r.extra.column.categoryGap*r.pix||0),o=Math.min(o,t/a),l=Math.min(l,t/a),e.width=Math.ceil((t-2*l-o*(a-1))/a),r.extra.mix&&r.extra.mix.column.width&&+r.extra.mix.column.width>0&&(e.width=Math.min(e.width,+r.extra.mix.column.width*r.pix)),r.extra.column&&r.extra.column.width&&+r.extra.column.width>0&&(e.width=Math.min(e.width,+r.extra.column.width*r.pix)),e.width<=0&&(e.width=1),e.x+=(i+.5-a/2)*(e.width+o),e}))}function ie(e,t,a,i,o,r){return e.map((function(e){if(null===e)return null;var o=0,l=0;return o=r.extra.bar.seriesGap*r.pix||0,l=r.extra.bar.categoryGap*r.pix||0,o=Math.min(o,t/a),l=Math.min(l,t/a),e.width=Math.ceil((t-2*l-o*(a-1))/a),r.extra.bar&&r.extra.bar.width&&+r.extra.bar.width>0&&(e.width=Math.min(e.width,+r.extra.bar.width*r.pix)),e.width<=0&&(e.width=1),e.y+=(i+.5-a/2)*(e.width+o),e}))}function oe(e,t,a){var i=t.width-t.area[1]-t.area[3],o=t.enableScroll?Math.min(t.xAxis.itemCount,e.length):e.length;("line"==t.type||"area"==t.type||"scatter"==t.type||"bubble"==t.type||"bar"==t.type)&&o>1&&"justify"==t.xAxis.boundaryGap&&(o-=1);var r=0;"mount"==t.type&&t.extra&&t.extra.mount&&t.extra.mount.widthRatio&&t.extra.mount.widthRatio>1&&(t.extra.mount.widthRatio>2&&(t.extra.mount.widthRatio=2),o+=r=t.extra.mount.widthRatio-1);var l=i/o,n=[],s=t.area[3],c=t.width-t.area[1];return e.forEach((function(e,t){n.push(s+r/2*l+t*l)})),"justify"!==t.xAxis.boundaryGap&&(!0===t.enableScroll?n.push(s+r*l+e.length*l):n.push(c)),{xAxisPoints:n,startX:s,endX:c,eachSpacing:l}}function re(e,t,a,i,o,r,l){var n=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,s="center";"line"!=r.type&&"area"!=r.type&&"scatter"!=r.type&&"bubble"!=r.type||(s=r.xAxis.boundaryGap);var c=[],h=r.height-r.area[0]-r.area[2],d=r.width-r.area[1]-r.area[3];return e.forEach((function(e,l){if(null===e)c.push(null);else{var u={};u.color=e.color,u.x=i[l];var p=e;if("object"==typeof e&&null!==e)if(e.constructor.toString().indexOf("Array")>-1){let t,a,i;t=[].concat(r.chartData.xAxisData.ranges),a=t.shift(),i=t.pop(),p=e[1],u.x=r.area[3]+d*(e[0]-a)/(i-a),"bubble"==r.type&&(u.r=e[2],u.t=e[3])}else p=e.value;"center"==s&&(u.x+=o/2);var x=h*(p-t)/(a-t);x*=n,u.y=r.height-x-r.area[2],c.push(u)}})),c}function le(e,t,a,i,o,r,l,n,s){s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;var c=[],h=r.height-r.area[0]-r.area[2],d=r.width-r.area[1]-r.area[3];return e.forEach((function(e,l){if(null===e)c.push(null);else{var n={};n.color=e.color,n.x=i[l];var u=e;if("object"==typeof e&&null!==e)if(e.constructor.toString().indexOf("Array")>-1){let t,a,i;t=[].concat(r.chartData.xAxisData.ranges),a=t.shift(),i=t.pop(),u=e[1],n.x=r.area[3]+d*(e[0]-a)/(i-a)}else u=e.value;n.x+=o/2;var p=h*(u*s-t)/(a-t);n.y=r.height-p-r.area[2],c.push(n)}})),c}function ne(e,t,a,i,o,r,l,n){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=[],h=r.height-r.area[0]-r.area[2];r.width,r.area[1],r.area[3];var d=o*l.widthRatio;return e.forEach((function(e,l){if(null===e)c.push(null);else{var n={};n.color=e.color,n.x=i[l],n.x+=o/2;var u=e.data,p=h*(u*s-t)/(a-t);n.y=r.height-p-r.area[2],n.value=u,n.width=d,c.push(n)}})),c}function se(e,t,a,i,o,r,l){var n=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,s=[];r.height,r.area[0],r.area[2];var c=r.width-r.area[1]-r.area[3];return e.forEach((function(e,o){if(null===e)s.push(null);else{var l={};l.color=e.color,l.y=i[o];var h=e;"object"==typeof e&&null!==e&&(h=e.value);var d=c*(h-t)/(a-t);d*=n,l.height=d,l.value=h,l.x=d+r.area[3],s.push(l)}})),s}function ce(e,t,a,i,o,r,l,n,s){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,h=[],d=r.height-r.area[0]-r.area[2];return e.forEach((function(e,l){if(null===e)h.push(null);else{var u={};if(u.color=e.color,u.x=i[l]+Math.round(o/2),n>0){var p=0;for(let e=0;e<=n;e++)p+=s[e].data[l];var x=d*(p-t)/(a-t),g=d*(p-e-t)/(a-t)}else{p=e;"object"==typeof e&&null!==e&&(p=e.value);x=d*(p-t)/(a-t),g=0}var f=g;x*=c,f*=c,u.y=r.height-Math.round(x)-r.area[2],u.y0=r.height-Math.round(f)-r.area[2],h.push(u)}})),h}function he(e,t,a,i,o,r,l,n,s){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,h=[],d=r.width-r.area[1]-r.area[3];return e.forEach((function(e,o){if(null===e)h.push(null);else{var l={};if(l.color=e.color,l.y=i[o],n>0){var u=0;for(let e=0;e<=n;e++)u+=s[e].data[o];var p=d*(u-t)/(a-t),x=d*(u-e-t)/(a-t)}else{u=e;"object"==typeof e&&null!==e&&(u=e.value);p=d*(u-t)/(a-t),x=0}var g=x;p*=c,g*=c,l.height=p-g,l.x=r.area[3]+p,l.x0=r.area[3]+g,h.push(l)}})),h}function de(e,t,a,i,o){var r;r="stack"==i?X(e,t.categories.length):G(e);var l=[];(r=r.filter((function(e){return"object"==typeof e&&null!==e?e.constructor.toString().indexOf("Array")>-1?null!==e:null!==e.value:null!==e}))).map((function(e){"object"==typeof e?e.constructor.toString().indexOf("Array")>-1?"candle"==t.type?e.map((function(e){l.push(e)})):l.push(e[1]):l.push(e.value):l.push(e)}));var n=o.min||0,s=o.max||0;l.length>0&&(n=Math.min.apply(this,l),s=Math.max.apply(this,l)),n===s&&(0==s?s=10:n=0);for(var c=function(e,t){var a=0,i=t-e;return{minRange:F(e,"lower",a=i>=1e4?1e3:i>=1e3?100:i>=100?10:i>=10?5:i>=1?1:i>=.1?.1:i>=.01?.01:i>=.001?.001:i>=1e-4?1e-4:i>=1e-5?1e-5:1e-6),maxRange:F(t,"upper",a)}}(n,s),h=void 0===o.min||null===o.min?c.minRange:o.min,d=((void 0===o.max||null===o.max?c.maxRange:o.max)-h)/t.yAxis.splitNumber,u=[],p=0;p<=t.yAxis.splitNumber;p++)u.push(h+d*p);return u.reverse()}function ue(e,t,a,i){var o=N({},{type:""},t.extra.column),r=t.yAxis.data.length,l=new Array(r);if(r>0){for(let t=0;t<r;t++){l[t]=[];for(let a=0;a<e.length;a++)e[a].index==t&&l[t].push(e[a])}var n=new Array(r),s=new Array(r),c=new Array(r);for(let e=0;e<r;e++){let r=t.yAxis.data[e];1==t.yAxis.disabled&&(r.disabled=!0),"categories"===r.type?(r.formatter||(r.formatter=(e,t,a)=>e+(r.unit||"")),r.categories=r.categories||t.categories,n[e]=r.categories):(r.formatter||(r.formatter=(e,t,a)=>M.toFixed(e,r.tofix||0)+(r.unit||"")),n[e]=de(l[e],t,0,o.type,r));let h=r.fontSize*t.pix||a.fontSize;c[e]={position:r.position?r.position:"left",width:0},s[e]=n[e].map((function(a,o){return a=r.formatter(a,o,t),c[e].width=Math.max(c[e].width,$(a,h,i)+5),a}));let d=r.calibration?4*t.pix:0;c[e].width+=d+3*t.pix,!0===r.disabled&&(c[e].width=0)}}else{n=new Array(1),s=new Array(1),c=new Array(1);"bar"===t.type?(n[0]=t.categories,t.yAxis.formatter||(t.yAxis.formatter=(e,t,a)=>e+(a.yAxis.unit||""))):(t.yAxis.formatter||(t.yAxis.formatter=(e,t,a)=>e.toFixed(a.yAxis.tofix)+(a.yAxis.unit||"")),n[0]=de(e,t,0,o.type,{})),c[0]={position:"left",width:0};var h=t.yAxis.fontSize*t.pix||a.fontSize;s[0]=n[0].map((function(e,a){return e=t.yAxis.formatter(e,a,t),c[0].width=Math.max(c[0].width,$(e,h,i)+5),e})),c[0].width+=3*t.pix,!0===t.yAxis.disabled?(c[0]={position:"left",width:0},t.yAxis.data[0]={disabled:!0}):(t.yAxis.data[0]={disabled:!1,position:"left",max:t.yAxis.max,min:t.yAxis.min,formatter:t.yAxis.formatter},"bar"===t.type&&(t.yAxis.data[0].categories=t.categories,t.yAxis.data[0].type="categories"))}return{rangesFormat:s,ranges:n,yAxisWidth:c}}function pe(e,t){!0!==t.rotateLock?(e.translate(t.height,0),e.rotate(90*Math.PI/180)):!0!==t._rotate_&&(e.translate(t.height,0),e.rotate(90*Math.PI/180),t._rotate_=!0)}function xe(e,t,a,i,o){if(i.beginPath(),"hollow"==o.dataPointShapeType?(i.setStrokeStyle(t),i.setFillStyle(o.background),i.setLineWidth(2*o.pix)):(i.setStrokeStyle("#ffffff"),i.setFillStyle(t),i.setLineWidth(1*o.pix)),"diamond"===a)e.forEach((function(e,t){null!==e&&(i.moveTo(e.x,e.y-4.5),i.lineTo(e.x-4.5,e.y),i.lineTo(e.x,e.y+4.5),i.lineTo(e.x+4.5,e.y),i.lineTo(e.x,e.y-4.5))}));else if("circle"===a)e.forEach((function(e,t){null!==e&&(i.moveTo(e.x+2.5*o.pix,e.y),i.arc(e.x,e.y,3*o.pix,0,2*Math.PI,!1))}));else if("square"===a)e.forEach((function(e,t){null!==e&&(i.moveTo(e.x-3.5,e.y-3.5),i.rect(e.x-3.5,e.y-3.5,7,7))}));else if("triangle"===a)e.forEach((function(e,t){null!==e&&(i.moveTo(e.x,e.y-4.5),i.lineTo(e.x-4.5,e.y+4.5),i.lineTo(e.x+4.5,e.y+4.5),i.lineTo(e.x,e.y-4.5))}));else if("none"===a)return;i.closePath(),i.fill(),i.stroke()}function ge(e,t,a,i,o,r,l){if(o.tooltip&&!(o.tooltip.group.length>0&&0==o.tooltip.group.includes(l))){var n="number"==typeof o.tooltip.index?o.tooltip.index:o.tooltip.index[o.tooltip.group.indexOf(l)];if(i.beginPath(),"hollow"==r.activeType?(i.setStrokeStyle(t),i.setFillStyle(o.background),i.setLineWidth(2*o.pix)):(i.setStrokeStyle("#ffffff"),i.setFillStyle(t),i.setLineWidth(1*o.pix)),"diamond"===a)e.forEach((function(e,t){null!==e&&n==t&&(i.moveTo(e.x,e.y-4.5),i.lineTo(e.x-4.5,e.y),i.lineTo(e.x,e.y+4.5),i.lineTo(e.x+4.5,e.y),i.lineTo(e.x,e.y-4.5))}));else if("circle"===a)e.forEach((function(e,t){null!==e&&n==t&&(i.moveTo(e.x+2.5*o.pix,e.y),i.arc(e.x,e.y,3*o.pix,0,2*Math.PI,!1))}));else if("square"===a)e.forEach((function(e,t){null!==e&&n==t&&(i.moveTo(e.x-3.5,e.y-3.5),i.rect(e.x-3.5,e.y-3.5,7,7))}));else if("triangle"===a)e.forEach((function(e,t){null!==e&&n==t&&(i.moveTo(e.x,e.y-4.5),i.lineTo(e.x-4.5,e.y+4.5),i.lineTo(e.x+4.5,e.y+4.5),i.lineTo(e.x,e.y-4.5))}));else if("none"===a)return;i.closePath(),i.fill(),i.stroke()}}function fe(e,t,a,i){var o=e.title.fontSize||t.titleFontSize,r=e.subtitle.fontSize||t.subtitleFontSize,l=e.title.name||"",n=e.subtitle.name||"",s=e.title.color||e.fontColor,c=e.subtitle.color||e.fontColor,h=l?o:0,d=n?r:0;if(n){var u=$(n,r*e.pix,a),p=i.x-u/2+(e.subtitle.offsetX||0)*e.pix,x=i.y+r*e.pix/2+(e.subtitle.offsetY||0)*e.pix;l&&(x+=(h*e.pix+5)/2),a.beginPath(),a.setFontSize(r*e.pix),a.setFillStyle(c),a.fillText(n,p,x),a.closePath(),a.stroke()}if(l){var g=$(l,o*e.pix,a),f=i.x-g/2+(e.title.offsetX||0),m=i.y+o*e.pix/2+(e.title.offsetY||0)*e.pix;n&&(m-=(d*e.pix+5)/2),a.beginPath(),a.setFontSize(o*e.pix),a.setFillStyle(s),a.fillText(l,f,m),a.closePath(),a.stroke()}}function me(e,t,a,i,o){var r=t.data,l=t.textOffset?t.textOffset:0;e.forEach((function(e,n){if(null!==e){i.beginPath();var s=t.textSize?t.textSize*o.pix:a.fontSize;i.setFontSize(s),i.setFillStyle(t.textColor||o.fontColor);var c=r[n];"object"==typeof r[n]&&null!==r[n]&&(c=r[n].constructor.toString().indexOf("Array")>-1?r[n][1]:r[n].value);var h=t.formatter?t.formatter(c,n,t,o):c;i.setTextAlign("center"),i.fillText(String(h),e.x,e.y-4+l*o.pix),i.closePath(),i.stroke(),i.setTextAlign("left")}}))}function ye(e,t,a,i,o){var r=t.data,l=t.textOffset?t.textOffset:0,n=o.extra.column.labelPosition;e.forEach((function(e,s){if(null!==e){i.beginPath();var c=t.textSize?t.textSize*o.pix:a.fontSize;i.setFontSize(c),i.setFillStyle(t.textColor||o.fontColor);var h=r[s];"object"==typeof r[s]&&null!==r[s]&&(h=r[s].constructor.toString().indexOf("Array")>-1?r[s][1]:r[s].value);var d=t.formatter?t.formatter(h,s,t,o):h;i.setTextAlign("center");var u=e.y-4*o.pix+l*o.pix;e.y>t.zeroPoints&&(u=e.y+l*o.pix+c),"insideTop"==n&&(u=e.y+c+l*o.pix,e.y>t.zeroPoints&&(u=e.y-l*o.pix-4*o.pix)),"center"==n&&(u=e.y+l*o.pix+(o.height-o.area[2]-e.y+c)/2,t.zeroPoints<o.height-o.area[2]&&(u=e.y+l*o.pix+(t.zeroPoints-e.y+c)/2),e.y>t.zeroPoints&&(u=e.y-l*o.pix-(e.y-t.zeroPoints-c)/2),"stack"==o.extra.column.type&&(u=e.y+l*o.pix+(e.y0-e.y+c)/2)),"bottom"==n&&(u=o.height-o.area[2]+l*o.pix-4*o.pix,t.zeroPoints<o.height-o.area[2]&&(u=t.zeroPoints+l*o.pix-4*o.pix),e.y>t.zeroPoints&&(u=t.zeroPoints-l*o.pix+c+2*o.pix),"stack"==o.extra.column.type&&(u=e.y0+l*o.pix-4*o.pix)),i.fillText(String(d),e.x,u),i.closePath(),i.stroke(),i.setTextAlign("left")}}))}function ve(e,t,a,i,o){var r=t.data;t.textOffset&&t.textOffset,e.forEach((function(e,l){if(null!==e){i.beginPath();var n=t.textSize?t.textSize*o.pix:a.fontSize;i.setFontSize(n),i.setFillStyle(t.textColor||o.fontColor);var s=r[l];"object"==typeof r[l]&&null!==r[l]&&(s=r[l].value);var c=t.formatter?t.formatter(s,l,t,o):s;i.setTextAlign("left"),i.fillText(String(c),e.x+4*o.pix,e.y+n/2-3),i.closePath(),i.stroke()}}))}function be(e,t,a,i,o,r){var l=a.pieChartLinePadding,n=[],s=null,c=e.map((function(a,i){var o=a.formatter?a.formatter(a,i,e,t):M.toFixed(100*a._proportion_.toFixed(4))+"%";o=a.labelText?a.labelText:o;var r=2*Math.PI-(a._start_+2*Math.PI*a._proportion_/2);return a._rose_proportion_&&(r=2*Math.PI-(a._start_+2*Math.PI*a._rose_proportion_/2)),{arc:r,text:o,color:a.color,radius:a._radius_,textColor:a.textColor,textSize:a.textSize,labelShow:a.labelShow}}));for(let h=0;h<c.length;h++){let e=c[h],o=Math.cos(e.arc)*(e.radius+l),r=Math.sin(e.arc)*(e.radius+l),d=Math.cos(e.arc)*e.radius,u=Math.sin(e.arc)*e.radius,p=o>=0?o+a.pieChartTextPadding:o-a.pieChartTextPadding,x=r,g=$(e.text,e.textSize*t.pix||a.fontSize,i),f=x;s&&M.isSameXCoordinateArea(s.start,{x:p})&&(f=p>0?Math.min(x,s.start.y):o<0||x>0?Math.max(x,s.start.y):Math.min(x,s.start.y)),p<0&&(p-=g),s=O({lineStart:{x:d,y:u},lineEnd:{x:o,y:r},start:{x:p,y:f},width:g,height:a.fontSize,text:e.text,color:e.color,textColor:e.textColor,textSize:e.textSize},s),n.push(s)}for(let h=0;h<n.length;h++){if(!1===c[h].labelShow)continue;let e=n[h],o=z(e.lineStart.x,e.lineStart.y,r),l=z(e.lineEnd.x,e.lineEnd.y,r),s=z(e.start.x,e.start.y,r);i.setLineWidth(1*t.pix),i.setFontSize(e.textSize*t.pix||a.fontSize),i.beginPath(),i.setStrokeStyle(e.color),i.setFillStyle(e.color),i.moveTo(o.x,o.y);let d=e.start.x<0?s.x+e.width:s.x,u=e.start.x<0?s.x-5:s.x+5;i.quadraticCurveTo(l.x,l.y,d,s.y),i.moveTo(o.x,o.y),i.stroke(),i.closePath(),i.beginPath(),i.moveTo(s.x+e.width,s.y),i.arc(d,s.y,2*t.pix,0,2*Math.PI),i.closePath(),i.fill(),i.beginPath(),i.setFontSize(e.textSize*t.pix||a.fontSize),i.setFillStyle(e.textColor||t.fontColor),i.fillText(e.text,u,s.y+3),i.closePath(),i.stroke(),i.closePath()}}function we(e,t,a){let i=N({},{type:"solid",dashLength:4,data:[]},e.extra.markLine),o=e.area[3],r=e.width-e.area[1],l=function(e,t){let a,i,o=t.height-t.area[0]-t.area[2];for(let r=0;r<e.length;r++){e[r].yAxisIndex=e[r].yAxisIndex?e[r].yAxisIndex:0;let l=[].concat(t.chartData.yAxisData.ranges[e[r].yAxisIndex]);a=l.pop(),i=l.shift();let n=o*(e[r].value-a)/(i-a);e[r].y=t.height-Math.round(n)-t.area[2]}return e}(i.data,e);for(let n=0;n<l.length;n++){let t=N({},{lineColor:"#DE4A42",showLabel:!1,labelFontSize:13,labelPadding:6,labelFontColor:"#666666",labelBgColor:"#DFE8FF",labelBgOpacity:.8,labelAlign:"left",labelOffsetX:0,labelOffsetY:0},l[n]);if("dash"==i.type&&a.setLineDash([i.dashLength,i.dashLength]),a.setStrokeStyle(t.lineColor),a.setLineWidth(1*e.pix),a.beginPath(),a.moveTo(o,t.y),a.lineTo(r,t.y),a.stroke(),a.setLineDash([]),t.showLabel){let i=t.labelFontSize*e.pix,o=t.labelText?t.labelText:t.value;a.setFontSize(i);let r=$(o,i,a)+t.labelPadding*e.pix*2,l="left"==t.labelAlign?e.area[3]-r:e.width-e.area[1];l+=t.labelOffsetX;let n=t.y-.5*i-t.labelPadding*e.pix;n+=t.labelOffsetY;let s=l+t.labelPadding*e.pix;t.y,a.setFillStyle(L(t.labelBgColor,t.labelBgOpacity)),a.setStrokeStyle(t.labelBgColor),a.setLineWidth(1*e.pix),a.beginPath(),a.rect(l,n,r,i+2*t.labelPadding*e.pix),a.closePath(),a.stroke(),a.fill(),a.setFontSize(i),a.setTextAlign("left"),a.setFillStyle(t.labelFontColor),a.fillText(String(o),s,n+i+t.labelPadding*e.pix/2),a.stroke(),a.setTextAlign("left")}}}function Se(e,t,a,i,o){var r=N({},{gridType:"solid",dashLength:4},e.extra.tooltip),l=e.area[3],n=e.width-e.area[1];if("dash"==r.gridType&&a.setLineDash([r.dashLength,r.dashLength]),a.setStrokeStyle(r.gridColor||"#cccccc"),a.setLineWidth(1*e.pix),a.beginPath(),a.moveTo(l,e.tooltip.offset.y),a.lineTo(n,e.tooltip.offset.y),a.stroke(),a.setLineDash([]),r.yAxisLabel){let i=r.boxPadding*e.pix,o=function(e,t,a){let i=[].concat(a.chartData.yAxisData.ranges),o=a.height-a.area[0]-a.area[2],r=a.area[0],l=[];for(let n=0;n<i.length;n++){let t=Math.max.apply(this,i[n]),s=t-(t-Math.min.apply(this,i[n]))*(e-r)/o;s=a.yAxis.data&&a.yAxis.data[n].formatter?a.yAxis.data[n].formatter(s,n,a):s.toFixed(0),l.push(String(s))}return l}(e.tooltip.offset.y,e.series,e),l=e.chartData.yAxisData.yAxisWidth,n=e.area[3],s=e.width-e.area[1];for(let c=0;c<o.length;c++){a.setFontSize(r.fontSize*e.pix);let h,d,u,p=$(o[c],r.fontSize*e.pix,a);"left"==l[c].position?(h=n-(p+2*i)-2*e.pix,d=Math.max(h,h+p+2*i)):(h=s+2*e.pix,d=Math.max(h+l[c].width,h+p+2*i)),u=d-h;let x=h+(u-p)/2,g=e.tooltip.offset.y;a.beginPath(),a.setFillStyle(L(r.labelBgColor||t.toolTipBackground,r.labelBgOpacity||t.toolTipOpacity)),a.setStrokeStyle(r.labelBgColor||t.toolTipBackground),a.setLineWidth(1*e.pix),a.rect(h,g-.5*t.fontSize-i,u,t.fontSize+2*i),a.closePath(),a.stroke(),a.fill(),a.beginPath(),a.setFontSize(t.fontSize),a.setFillStyle(r.labelFontColor||e.fontColor),a.fillText(o[c],x,g+.5*t.fontSize),a.closePath(),a.stroke(),"left"==l[c].position?n-=l[c].width+e.yAxis.padding*e.pix:s+=l[c].width+e.yAxis.padding*e.pix}}}function Ae(e,t,a,i,o,r,l){var n=N({},{showBox:!0,showArrow:!0,showCategory:!1,bgColor:"#000000",bgOpacity:.7,borderColor:"#000000",borderWidth:0,borderRadius:0,borderOpacity:.7,boxPadding:3,fontColor:"#FFFFFF",fontSize:13,lineHeight:20,legendShow:!0,legendShape:"auto",splitLine:!0},a.extra.tooltip);1==n.showCategory&&a.categories&&e.unshift({text:a.categories[a.tooltip.index],color:null});var s=n.fontSize*a.pix,c=n.lineHeight*a.pix,h=n.boxPadding*a.pix,d=s,u=5*a.pix;0==n.legendShow&&(d=0,u=0);var p=n.showArrow?8*a.pix:0,x=!1;"line"!=a.type&&"mount"!=a.type&&"area"!=a.type&&"candle"!=a.type&&"mix"!=a.type||1==n.splitLine&&function(e,t,a,i){var o=t.extra.tooltip||{};o.gridType=null==o.gridType?"solid":o.gridType,o.dashLength=null==o.dashLength?4:o.dashLength;var r=t.area[0],l=t.height-t.area[2];if("dash"==o.gridType&&i.setLineDash([o.dashLength,o.dashLength]),i.setStrokeStyle(o.gridColor||"#cccccc"),i.setLineWidth(1*t.pix),i.beginPath(),i.moveTo(e,r),i.lineTo(e,l),i.stroke(),i.setLineDash([]),o.xAxisLabel){let r=t.categories[t.tooltip.index];i.setFontSize(a.fontSize);let n=$(r,a.fontSize,i),s=e-.5*n,c=l+2*t.pix;i.beginPath(),i.setFillStyle(L(o.labelBgColor||a.toolTipBackground,o.labelBgOpacity||a.toolTipOpacity)),i.setStrokeStyle(o.labelBgColor||a.toolTipBackground),i.setLineWidth(1*t.pix),i.rect(s-o.boxPadding*t.pix,c,n+2*o.boxPadding*t.pix,a.fontSize+2*o.boxPadding*t.pix),i.closePath(),i.stroke(),i.fill(),i.beginPath(),i.setFontSize(a.fontSize),i.setFillStyle(o.labelFontColor||t.fontColor),i.fillText(String(r),s,c+o.boxPadding*t.pix+a.fontSize),i.closePath(),i.stroke()}}(a.tooltip.offset.x,a,i,o),(t=N({x:0,y:0},t)).y-=8*a.pix;var g=e.map((function(e){return $(e.text,s,o)})),f=d+u+4*h+Math.max.apply(null,g),m=2*h+e.length*c;if(0!=n.showBox){t.x-Math.abs(a._scrollDistance_||0)+p+f>a.width&&(x=!0),m+t.y>a.height&&(t.y=a.height-m),o.beginPath(),o.setFillStyle(L(n.bgColor,n.bgOpacity)),o.setLineWidth(n.borderWidth*a.pix),o.setStrokeStyle(L(n.borderColor,n.borderOpacity));var y=n.borderRadius;x?(f+p>a.width&&(t.x=a.width+Math.abs(a._scrollDistance_||0)+p+(f-a.width)),f>t.x&&(t.x=a.width+Math.abs(a._scrollDistance_||0)+p+(f-a.width)),n.showArrow&&(o.moveTo(t.x,t.y+10*a.pix),o.lineTo(t.x-p,t.y+10*a.pix+5*a.pix)),o.arc(t.x-p-y,t.y+m-y,y,0,Math.PI/2,!1),o.arc(t.x-p-Math.round(f)+y,t.y+m-y,y,Math.PI/2,Math.PI,!1),o.arc(t.x-p-Math.round(f)+y,t.y+y,y,-Math.PI,-Math.PI/2,!1),o.arc(t.x-p-y,t.y+y,y,-Math.PI/2,0,!1),n.showArrow&&(o.lineTo(t.x-p,t.y+10*a.pix-5*a.pix),o.lineTo(t.x,t.y+10*a.pix))):(n.showArrow&&(o.moveTo(t.x,t.y+10*a.pix),o.lineTo(t.x+p,t.y+10*a.pix-5*a.pix)),o.arc(t.x+p+y,t.y+y,y,-Math.PI,-Math.PI/2,!1),o.arc(t.x+p+Math.round(f)-y,t.y+y,y,-Math.PI/2,0,!1),o.arc(t.x+p+Math.round(f)-y,t.y+m-y,y,0,Math.PI/2,!1),o.arc(t.x+p+y,t.y+m-y,y,Math.PI/2,Math.PI,!1),n.showArrow&&(o.lineTo(t.x+p,t.y+10*a.pix+5*a.pix),o.lineTo(t.x,t.y+10*a.pix))),o.closePath(),o.fill(),n.borderWidth>0&&o.stroke(),n.legendShow&&e.forEach((function(e,i){if(null!==e.color){o.beginPath(),o.setFillStyle(e.color);var r=t.x+p+2*h,l=t.y+(c-s)/2+c*i+h+1;switch(x&&(r=t.x-f-p+2*h),e.legendShape){case"line":o.moveTo(r,l+.5*d-2*a.pix),o.fillRect(r,l+.5*d-2*a.pix,d,4*a.pix);break;case"triangle":o.moveTo(r+7.5*a.pix,l+.5*d-5*a.pix),o.lineTo(r+2.5*a.pix,l+.5*d+5*a.pix),o.lineTo(r+12.5*a.pix,l+.5*d+5*a.pix),o.lineTo(r+7.5*a.pix,l+.5*d-5*a.pix);break;case"diamond":o.moveTo(r+7.5*a.pix,l+.5*d-5*a.pix),o.lineTo(r+2.5*a.pix,l+.5*d),o.lineTo(r+7.5*a.pix,l+.5*d+5*a.pix),o.lineTo(r+12.5*a.pix,l+.5*d),o.lineTo(r+7.5*a.pix,l+.5*d-5*a.pix);break;case"circle":o.moveTo(r+7.5*a.pix,l+.5*d),o.arc(r+7.5*a.pix,l+.5*d,5*a.pix,0,2*Math.PI);break;case"rect":default:o.moveTo(r,l+.5*d-5*a.pix),o.fillRect(r,l+.5*d-5*a.pix,15*a.pix,10*a.pix);break;case"square":o.moveTo(r+2*a.pix,l+.5*d-5*a.pix),o.fillRect(r+2*a.pix,l+.5*d-5*a.pix,10*a.pix,10*a.pix)}o.closePath(),o.fill()}})),e.forEach((function(e,a){var i=t.x+p+2*h+d+u;x&&(i=t.x-f-p+2*h+d+u);var r=t.y+c*a+(c-s)/2-1+h+s;o.beginPath(),o.setFontSize(s),o.setTextBaseline("normal"),o.setFillStyle(n.fontColor),o.fillText(e.text,i,r),o.closePath(),o.stroke()}))}}function Te(e,t,a,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=t.chartData.xAxisData,l=r.xAxisPoints,n=r.eachSpacing,s=N({},{type:"group",width:n/2,meterBorder:4,meterFillColor:"#FFFFFF",barBorderCircle:!1,barBorderRadius:[],seriesGap:2,linearType:"none",linearOpacity:1,customColor:[],colorStop:0,labelPosition:"outside"},t.extra.column),c=[];i.save();let h=-2,d=l.length+2;return t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),h=Math.floor(-t._scrollDistance_/n)-2,d=h+t.xAxis.itemCount+4),t.tooltip&&t.tooltip.textList&&t.tooltip.textList.length&&1===o&&function(e,t,a,i,o){var r=N({},{activeBgColor:"#000000",activeBgOpacity:.08,activeWidth:o},t.extra.column);r.activeWidth=r.activeWidth>o?o:r.activeWidth;var l=t.area[0],n=t.height-t.area[2];i.beginPath(),i.setFillStyle(L(r.activeBgColor,r.activeBgOpacity)),i.rect(e-r.activeWidth/2,l,r.activeWidth,n-l),i.closePath(),i.fill(),i.setFillStyle("#FFFFFF")}(t.tooltip.offset.x,t,0,i,n),s.customColor=W(s.linearType,s.customColor,e,a),e.forEach((function(r,u){let p,x,g;p=[].concat(t.chartData.yAxisData.ranges[r.index]),x=p.pop(),g=p.shift();let f=(t.height-t.area[0]-t.area[2])*(0-x)/(g-x),m=t.height-Math.round(f)-t.area[2];r.zeroPoints=m;var y=r.data;switch(s.type){case"group":var v=le(y,x,g,l,n,t,a,m,o),b=ce(y,x,g,l,n,t,a,u,e,o);c.push(b),v=ae(v,n,e.length,u,0,t);for(let e=0;e<v.length;e++){let a=v[e];if(null!==a&&e>h&&e<d){var w=a.x-a.width/2,S=t.height-a.y-t.area[2];i.beginPath();var A=a.color||r.color,T=a.color||r.color;if("none"!==s.linearType){var k=i.createLinearGradient(w,a.y,w,m);"opacity"==s.linearType?(k.addColorStop(0,L(A,s.linearOpacity)),k.addColorStop(1,L(A,1))):(k.addColorStop(0,L(s.customColor[r.linearIndex],s.linearOpacity)),k.addColorStop(s.colorStop,L(s.customColor[r.linearIndex],s.linearOpacity)),k.addColorStop(1,L(A,1))),A=k}if(s.barBorderRadius&&4===s.barBorderRadius.length||!0===s.barBorderCircle){const e=w,t=a.y>m?m:a.y,o=a.width,r=Math.abs(m-a.y);s.barBorderCircle&&(s.barBorderRadius=[o/2,o/2,0,0]),a.y>m&&(s.barBorderRadius=[0,0,o/2,o/2]);let[l,n,c,h]=s.barBorderRadius,d=Math.min(o/2,r/2);l=l>d?d:l,n=n>d?d:n,c=c>d?d:c,h=h>d?d:h,l=l<0?0:l,n=n<0?0:n,c=c<0?0:c,h=h<0?0:h,i.arc(e+l,t+l,l,-Math.PI,-Math.PI/2),i.arc(e+o-n,t+n,n,-Math.PI/2,0),i.arc(e+o-c,t+r-c,c,0,Math.PI/2),i.arc(e+h,t+r-h,h,Math.PI/2,Math.PI)}else i.moveTo(w,a.y),i.lineTo(w+a.width,a.y),i.lineTo(w+a.width,m),i.lineTo(w,m),i.lineTo(w,a.y),i.setLineWidth(1),i.setStrokeStyle(T);i.setFillStyle(A),i.closePath(),i.fill()}}break;case"stack":v=ce(y,x,g,l,n,t,a,u,e,o);c.push(v),v=function(e,t,a,i,o,r){var l=r.extra.column.categoryGap*r.pix||0;return e.map((function(e,a){return null===e?null:(e.width=Math.ceil(t-2*l),r.extra.column&&r.extra.column.width&&+r.extra.column.width>0&&(e.width=Math.min(e.width,+r.extra.column.width*r.pix)),e.width<=0&&(e.width=1),e)}))}(v,n,e.length,0,0,t);for(let e=0;e<v.length;e++){let a=v[e];if(null!==a&&e>h&&e<d){i.beginPath();A=a.color||r.color,w=a.x-a.width/2+1,S=t.height-a.y-t.area[2];var C=t.height-a.y0-t.area[2];u>0&&(S-=C),i.setFillStyle(A),i.moveTo(w,a.y),i.fillRect(w,a.y,a.width,S),i.closePath(),i.fill()}}break;case"meter":v=re(y,x,g,l,n,t,a,o);c.push(v),v=function(e,t,a,i,o,r,l){var n=r.extra.column.categoryGap*r.pix||0;return e.map((function(e){return null===e?null:(e.width=t-2*n,r.extra.column&&r.extra.column.width&&+r.extra.column.width>0&&(e.width=Math.min(e.width,+r.extra.column.width*r.pix)),i>0&&(e.width-=l),e)}))}(v,n,e.length,u,0,t,s.meterBorder);for(let e=0;e<v.length;e++){let a=v[e];if(null!==a&&e>h&&e<d){i.beginPath(),0==u&&s.meterBorder>0&&(i.setStrokeStyle(r.color),i.setLineWidth(s.meterBorder*t.pix)),0==u?i.setFillStyle(s.meterFillColor):i.setFillStyle(a.color||r.color);w=a.x-a.width/2,S=t.height-a.y-t.area[2];if(s.barBorderRadius&&4===s.barBorderRadius.length||!0===s.barBorderCircle){const e=w,t=a.y,o=a.width,r=m-a.y;s.barBorderCircle&&(s.barBorderRadius=[o/2,o/2,0,0]);let[l,n,c,h]=s.barBorderRadius,d=Math.min(o/2,r/2);l=l>d?d:l,n=n>d?d:n,c=c>d?d:c,h=h>d?d:h,l=l<0?0:l,n=n<0?0:n,c=c<0?0:c,h=h<0?0:h,i.arc(e+l,t+l,l,-Math.PI,-Math.PI/2),i.arc(e+o-n,t+n,n,-Math.PI/2,0),i.arc(e+o-c,t+r-c,c,0,Math.PI/2),i.arc(e+h,t+r-h,h,Math.PI/2,Math.PI),i.fill()}else i.moveTo(w,a.y),i.lineTo(w+a.width,a.y),i.lineTo(w+a.width,m),i.lineTo(w,m),i.lineTo(w,a.y),i.fill();0==u&&s.meterBorder>0&&(i.closePath(),i.stroke())}}}})),!1!==t.dataLabel&&1===o&&e.forEach((function(r,c){let h,d,u;h=[].concat(t.chartData.yAxisData.ranges[r.index]),d=h.pop(),u=h.shift();var p=r.data;switch(s.type){case"group":ye(ae(le(p,d,u,l,n,t,a,o),n,e.length,c,0,t),r,a,i,t);break;case"stack":ye(ce(p,d,u,l,n,t,a,c,e,o),r,a,i,t);break;case"meter":ye(re(p,d,u,l,n,t,a,o),r,a,i,t)}})),i.restore(),{xAxisPoints:l,calPoints:c,eachSpacing:n}}function ke(e,t,a,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=t.chartData.xAxisData,l=r.xAxisPoints,n=r.eachSpacing,s=N({},{type:"mount",widthRatio:1,borderWidth:1,barBorderCircle:!1,barBorderRadius:[],linearType:"none",linearOpacity:1,customColor:[],colorStop:0},t.extra.mount);s.widthRatio=s.widthRatio<=0?0:s.widthRatio,s.widthRatio=s.widthRatio>=2?2:s.widthRatio,i.save();let c,h,d,u=-2,p=l.length+2;t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),u=Math.floor(-t._scrollDistance_/n)-2,p=u+t.xAxis.itemCount+4),s.customColor=W(s.linearType,s.customColor,e,a),c=[].concat(t.chartData.yAxisData.ranges[0]),h=c.pop(),d=c.shift();let x=(t.height-t.area[0]-t.area[2])*(0-h)/(d-h),g=t.height-Math.round(x)-t.area[2];var f=ne(e,h,d,l,n,t,s,g,o);switch(s.type){case"bar":for(let a=0;a<f.length;a++){let o=f[a];if(null!==o&&a>u&&a<p){var m=o.x-n*s.widthRatio/2,y=t.height-o.y-t.area[2];i.beginPath();var v=o.color||e[a].color,b=o.color||e[a].color;if("none"!==s.linearType){var w=i.createLinearGradient(m,o.y,m,g);"opacity"==s.linearType?(w.addColorStop(0,L(v,s.linearOpacity)),w.addColorStop(1,L(v,1))):(w.addColorStop(0,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(s.colorStop,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(1,L(v,1))),v=w}if(s.barBorderRadius&&4===s.barBorderRadius.length||!0===s.barBorderCircle){const e=m,t=o.y>g?g:o.y,a=o.width,r=Math.abs(g-o.y);s.barBorderCircle&&(s.barBorderRadius=[a/2,a/2,0,0]),o.y>g&&(s.barBorderRadius=[0,0,a/2,a/2]);let[l,n,c,h]=s.barBorderRadius,d=Math.min(a/2,r/2);l=l>d?d:l,n=n>d?d:n,c=c>d?d:c,h=h>d?d:h,l=l<0?0:l,n=n<0?0:n,c=c<0?0:c,h=h<0?0:h,i.arc(e+l,t+l,l,-Math.PI,-Math.PI/2),i.arc(e+a-n,t+n,n,-Math.PI/2,0),i.arc(e+a-c,t+r-c,c,0,Math.PI/2),i.arc(e+h,t+r-h,h,Math.PI/2,Math.PI)}else i.moveTo(m,o.y),i.lineTo(m+o.width,o.y),i.lineTo(m+o.width,g),i.lineTo(m,g),i.lineTo(m,o.y);i.setStrokeStyle(b),i.setFillStyle(v),s.borderWidth>0&&(i.setLineWidth(s.borderWidth*t.pix),i.closePath(),i.stroke()),i.fill()}}break;case"triangle":for(let a=0;a<f.length;a++){let o=f[a];if(null!==o&&a>u&&a<p){m=o.x-n*s.widthRatio/2,y=t.height-o.y-t.area[2];i.beginPath();v=o.color||e[a].color,b=o.color||e[a].color;if("none"!==s.linearType){w=i.createLinearGradient(m,o.y,m,g);"opacity"==s.linearType?(w.addColorStop(0,L(v,s.linearOpacity)),w.addColorStop(1,L(v,1))):(w.addColorStop(0,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(s.colorStop,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(1,L(v,1))),v=w}i.moveTo(m,g),i.lineTo(o.x,o.y),i.lineTo(m+o.width,g),i.setStrokeStyle(b),i.setFillStyle(v),s.borderWidth>0&&(i.setLineWidth(s.borderWidth*t.pix),i.stroke()),i.fill()}}break;case"mount":for(let a=0;a<f.length;a++){let o=f[a];if(null!==o&&a>u&&a<p){m=o.x-n*s.widthRatio/2,y=t.height-o.y-t.area[2];i.beginPath();v=o.color||e[a].color,b=o.color||e[a].color;if("none"!==s.linearType){w=i.createLinearGradient(m,o.y,m,g);"opacity"==s.linearType?(w.addColorStop(0,L(v,s.linearOpacity)),w.addColorStop(1,L(v,1))):(w.addColorStop(0,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(s.colorStop,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(1,L(v,1))),v=w}i.moveTo(m,g),i.bezierCurveTo(o.x-o.width/4,g,o.x-o.width/4,o.y,o.x,o.y),i.bezierCurveTo(o.x+o.width/4,o.y,o.x+o.width/4,g,m+o.width,g),i.setStrokeStyle(b),i.setFillStyle(v),s.borderWidth>0&&(i.setLineWidth(s.borderWidth*t.pix),i.stroke()),i.fill()}}break;case"sharp":for(let a=0;a<f.length;a++){let o=f[a];if(null!==o&&a>u&&a<p){m=o.x-n*s.widthRatio/2,y=t.height-o.y-t.area[2];i.beginPath();v=o.color||e[a].color,b=o.color||e[a].color;if("none"!==s.linearType){w=i.createLinearGradient(m,o.y,m,g);"opacity"==s.linearType?(w.addColorStop(0,L(v,s.linearOpacity)),w.addColorStop(1,L(v,1))):(w.addColorStop(0,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(s.colorStop,L(s.customColor[e[a].linearIndex],s.linearOpacity)),w.addColorStop(1,L(v,1))),v=w}i.moveTo(m,g),i.quadraticCurveTo(o.x-0,g-y/4,o.x,o.y),i.quadraticCurveTo(o.x+0,g-y/4,m+o.width,g),i.setStrokeStyle(b),i.setFillStyle(v),s.borderWidth>0&&(i.setLineWidth(s.borderWidth*t.pix),i.stroke()),i.fill()}}}if(!1!==t.dataLabel&&1===o){let r,c,h;r=[].concat(t.chartData.yAxisData.ranges[0]),c=r.pop(),h=r.shift(),function(e,t,a,i,o,r){t.data;var l=t.textOffset?t.textOffset:0;o.extra.mount.labelPosition,e.forEach((function(e,n){if(null!==e){i.beginPath();var s=t[n].textSize?t[n].textSize*o.pix:a.fontSize;i.setFontSize(s),i.setFillStyle(t[n].textColor||o.fontColor);var c=e.value,h=t[n].formatter?t[n].formatter(c,n,t,o):c;i.setTextAlign("center");var d=e.y-4*o.pix+l*o.pix;e.y>r&&(d=e.y+l*o.pix+s),i.fillText(String(h),e.x,d),i.closePath(),i.stroke(),i.setTextAlign("left")}}))}(f=ne(e,c,h,l,n,t,s,g,o),e,a,i,t,g)}return i.restore(),{xAxisPoints:l,calPoints:f,eachSpacing:n}}function Ce(e,t,a,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=[],l=(t.height-t.area[0]-t.area[2])/t.categories.length;for(let h=0;h<t.categories.length;h++)r.push(t.area[0]+l/2+l*h);let n=N({},{type:"group",width:l/2,meterBorder:4,meterFillColor:"#FFFFFF",barBorderCircle:!1,barBorderRadius:[],seriesGap:2,linearType:"none",linearOpacity:1,customColor:[],colorStop:0},t.extra.bar),s=[];i.save();let c=r.length+2;return t.tooltip&&t.tooltip.textList&&t.tooltip.textList.length&&1===o&&function(e,t,a,i,o){var r=N({},{activeBgColor:"#000000",activeBgOpacity:.08},t.extra.bar),l=t.area[3],n=t.width-t.area[1];i.beginPath(),i.setFillStyle(L(r.activeBgColor,r.activeBgOpacity)),i.rect(l,e-o/2,n-l,o),i.closePath(),i.fill(),i.setFillStyle("#FFFFFF")}(t.tooltip.offset.y,t,0,i,l),n.customColor=W(n.linearType,n.customColor,e,a),e.forEach((function(h,d){let u,p,x;u=[].concat(t.chartData.xAxisData.ranges),x=u.pop(),p=u.shift();var g=h.data;switch(n.type){case"group":var f=se(g,p,x,r,l,t,a,o),m=he(g,p,x,r,l,t,a,d,e,o);s.push(m),f=ie(f,l,e.length,d,0,t);for(let e=0;e<f.length;e++){let a=f[e];if(null!==a&&e>-2&&e<c){var y=t.area[3],v=a.y-a.width/2;a.height,i.beginPath();var b=a.color||h.color,w=a.color||h.color;if("none"!==n.linearType){var S=i.createLinearGradient(y,a.y,a.x,a.y);"opacity"==n.linearType?(S.addColorStop(0,L(b,n.linearOpacity)),S.addColorStop(1,L(b,1))):(S.addColorStop(0,L(n.customColor[h.linearIndex],n.linearOpacity)),S.addColorStop(n.colorStop,L(n.customColor[h.linearIndex],n.linearOpacity)),S.addColorStop(1,L(b,1))),b=S}if(n.barBorderRadius&&4===n.barBorderRadius.length||!0===n.barBorderCircle){const e=y,t=a.width,o=a.y-a.width/2,r=a.height;n.barBorderCircle&&(n.barBorderRadius=[t/2,t/2,0,0]);let[l,s,c,h]=n.barBorderRadius,d=Math.min(t/2,r/2);l=l>d?d:l,s=s>d?d:s,c=c>d?d:c,h=h>d?d:h,l=l<0?0:l,s=s<0?0:s,c=c<0?0:c,h=h<0?0:h,i.arc(e+h,o+h,h,-Math.PI,-Math.PI/2),i.arc(a.x-l,o+l,l,-Math.PI/2,0),i.arc(a.x-s,o+t-s,s,0,Math.PI/2),i.arc(e+c,o+t-c,c,Math.PI/2,Math.PI)}else i.moveTo(y,v),i.lineTo(a.x,v),i.lineTo(a.x,v+a.width),i.lineTo(y,v+a.width),i.lineTo(y,v),i.setLineWidth(1),i.setStrokeStyle(w);i.setFillStyle(b),i.closePath(),i.fill()}}break;case"stack":f=he(g,p,x,r,l,t,a,d,e,o);s.push(f),f=function(e,t,a,i,o,r){var l=r.extra.bar.categoryGap*r.pix||0;return e.map((function(e,a){return null===e?null:(e.width=Math.ceil(t-2*l),r.extra.bar&&r.extra.bar.width&&+r.extra.bar.width>0&&(e.width=Math.min(e.width,+r.extra.bar.width*r.pix)),e.width<=0&&(e.width=1),e)}))}(f,l,e.length,0,0,t);for(let e=0;e<f.length;e++){let t=f[e];if(null!==t&&e>-2&&e<c){i.beginPath();b=t.color||h.color,y=t.x0;i.setFillStyle(b),i.moveTo(y,t.y-t.width/2),i.fillRect(y,t.y-t.width/2,t.height,t.width),i.closePath(),i.fill()}}}})),!1!==t.dataLabel&&1===o&&e.forEach((function(s,c){let h,d,u;h=[].concat(t.chartData.xAxisData.ranges),u=h.pop(),d=h.shift();var p=s.data;switch(n.type){case"group":ve(ie(se(p,d,u,r,l,t,a,o),l,e.length,c,0,t),s,a,i,t);break;case"stack":ve(he(p,d,u,r,l,t,a,c,e,o),s,a,i,t)}})),{yAxisPoints:r,calPoints:s,eachSpacing:l}}function Pe(e,t,a,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=N({},{color:{},average:{}},a.extra.candle);l.color=N({},{upLine:"#f04864",upFill:"#f04864",downLine:"#2fc25b",downFill:"#2fc25b"},l.color),l.average=N({},{show:!1,name:[],day:[],color:i.color},l.average),a.extra.candle=l;let n=a.chartData.xAxisData,s=n.xAxisPoints,c=n.eachSpacing,h=[];o.save();let d=-2,u=s.length+2,p=0,x=a.width+c;return a._scrollDistance_&&0!==a._scrollDistance_&&!0===a.enableScroll&&(o.translate(a._scrollDistance_,0),d=Math.floor(-a._scrollDistance_/c)-2,u=d+a.xAxis.itemCount+4,p=-a._scrollDistance_-2*c+a.area[3],x=p+(a.xAxis.itemCount+4)*c),(l.average.show||t)&&t.forEach((function(e,t){let l,n,h;l=[].concat(a.chartData.yAxisData.ranges[e.index]),n=l.pop(),h=l.shift();var d=J(re(e.data,n,h,s,c,a,i,r),e);for(let a=0;a<d.length;a++){let t=d[a];if(o.beginPath(),o.setStrokeStyle(e.color),o.setLineWidth(1),1===t.length)o.moveTo(t[0].x,t[0].y),o.arc(t[0].x,t[0].y,1,0,2*Math.PI);else{o.moveTo(t[0].x,t[0].y);let e=0;for(let a=0;a<t.length;a++){let i=t[a];if(0==e&&i.x>p&&(o.moveTo(i.x,i.y),e=1),a>0&&i.x>p&&i.x<x){var u=B(t,a-1);o.bezierCurveTo(u.ctrA.x,u.ctrA.y,u.ctrB.x,u.ctrB.y,i.x,i.y)}}o.moveTo(t[0].x,t[0].y)}o.closePath(),o.stroke()}})),e.forEach((function(e,t){let n,p,x;n=[].concat(a.chartData.yAxisData.ranges[e.index]),p=n.pop(),x=n.shift();var g=e.data,f=function(e,t,a,i,o,r,l){var n=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,s=[],c=r.height-r.area[0]-r.area[2];return e.forEach((function(e,l){if(null===e)s.push(null);else{var h=[];e.forEach((function(e,s){var d={};d.x=i[l]+Math.round(o/2);var u=e.value||e,p=c*(u-t)/(a-t);p*=n,d.y=r.height-Math.round(p)-r.area[2],h.push(d)})),s.push(h)}})),s}(g,p,x,s,c,a,i,r);h.push(f);var m=J(f,e);for(let i=0;i<m[0].length;i++)if(i>d&&i<u){let e=m[0][i];o.beginPath(),g[i][1]-g[i][0]>0?(o.setStrokeStyle(l.color.upLine),o.setFillStyle(l.color.upFill),o.setLineWidth(1*a.pix),o.moveTo(e[3].x,e[3].y),o.lineTo(e[1].x,e[1].y),o.lineTo(e[1].x-c/4,e[1].y),o.lineTo(e[0].x-c/4,e[0].y),o.lineTo(e[0].x,e[0].y),o.lineTo(e[2].x,e[2].y),o.lineTo(e[0].x,e[0].y),o.lineTo(e[0].x+c/4,e[0].y),o.lineTo(e[1].x+c/4,e[1].y),o.lineTo(e[1].x,e[1].y),o.moveTo(e[3].x,e[3].y)):(o.setStrokeStyle(l.color.downLine),o.setFillStyle(l.color.downFill),o.setLineWidth(1*a.pix),o.moveTo(e[3].x,e[3].y),o.lineTo(e[0].x,e[0].y),o.lineTo(e[0].x-c/4,e[0].y),o.lineTo(e[1].x-c/4,e[1].y),o.lineTo(e[1].x,e[1].y),o.lineTo(e[2].x,e[2].y),o.lineTo(e[1].x,e[1].y),o.lineTo(e[1].x+c/4,e[1].y),o.lineTo(e[0].x+c/4,e[0].y),o.lineTo(e[0].x,e[0].y),o.moveTo(e[3].x,e[3].y)),o.closePath(),o.fill(),o.stroke()}})),o.restore(),{xAxisPoints:s,calPoints:h,eachSpacing:c}}function Ee(e,t,a,i,o,r){(e.extra.tooltip||{}).horizentalLine&&e.tooltip&&1===i&&("line"==e.type||"area"==e.type||"column"==e.type||"mount"==e.type||"candle"==e.type||"mix"==e.type)&&Se(e,t,a),a.save(),e._scrollDistance_&&0!==e._scrollDistance_&&!0===e.enableScroll&&a.translate(e._scrollDistance_,0),e.tooltip&&e.tooltip.textList&&e.tooltip.textList.length&&1===i&&Ae(e.tooltip.textList,e.tooltip.offset,e,t,a),a.restore()}function _e(e,t,a,i){let o=t.chartData.xAxisData,r=o.xAxisPoints,l=o.startX,n=o.endX,s=o.eachSpacing;var c="center";"bar"!=t.type&&"line"!=t.type&&"area"!=t.type&&"scatter"!=t.type&&"bubble"!=t.type||(c=t.xAxis.boundaryGap);var h=t.height-t.area[2],d=t.area[0];if(t.enableScroll&&t.xAxis.scrollShow){var u=t.height-t.area[2]+a.xAxisHeight,p=n-l,x=s*(r.length-1);"mount"==t.type&&t.extra&&t.extra.mount&&t.extra.mount.widthRatio&&t.extra.mount.widthRatio>1&&(t.extra.mount.widthRatio>2&&(t.extra.mount.widthRatio=2),x+=(t.extra.mount.widthRatio-1)*s);var g=p*p/x,f=0;t._scrollDistance_&&(f=-t._scrollDistance_*p/x),i.beginPath(),i.setLineCap("round"),i.setLineWidth(6*t.pix),i.setStrokeStyle(t.xAxis.scrollBackgroundColor||"#EFEBEF"),i.moveTo(l,u),i.lineTo(n,u),i.stroke(),i.closePath(),i.beginPath(),i.setLineCap("round"),i.setLineWidth(6*t.pix),i.setStrokeStyle(t.xAxis.scrollColor||"#A6A6A6"),i.moveTo(l+f,u),i.lineTo(l+f+g,u),i.stroke(),i.closePath(),i.setLineCap("butt")}if(i.save(),t._scrollDistance_&&0!==t._scrollDistance_&&i.translate(t._scrollDistance_,0),!0===t.xAxis.calibration&&(i.setStrokeStyle(t.xAxis.gridColor||"#cccccc"),i.setLineCap("butt"),i.setLineWidth(1*t.pix),r.forEach((function(e,a){a>0&&(i.beginPath(),i.moveTo(e-s/2,h),i.lineTo(e-s/2,h+3*t.pix),i.closePath(),i.stroke())}))),!0!==t.xAxis.disableGrid&&(i.setStrokeStyle(t.xAxis.gridColor||"#cccccc"),i.setLineCap("butt"),i.setLineWidth(1*t.pix),"dash"==t.xAxis.gridType&&i.setLineDash([t.xAxis.dashLength*t.pix,t.xAxis.dashLength*t.pix]),t.xAxis.gridEval=t.xAxis.gridEval||1,r.forEach((function(e,a){a%t.xAxis.gridEval==0&&(i.beginPath(),i.moveTo(e,h),i.lineTo(e,d),i.stroke())})),i.setLineDash([])),!0!==t.xAxis.disabled){let o=e.length;t.xAxis.labelCount&&(o=t.xAxis.itemCount?Math.ceil(e.length/t.xAxis.itemCount*t.xAxis.labelCount):t.xAxis.labelCount,o-=1);let l=Math.ceil(e.length/o),n=[],d=e.length;for(let t=0;t<d;t++)t%l!=0?n.push(""):n.push(e[t]);n[d-1]=e[d-1];var m=t.xAxis.fontSize*t.pix||a.fontSize;0===a._xAxisTextAngle_?n.forEach((function(e,a){var o=t.xAxis.formatter?t.xAxis.formatter(e,a,t):e,l=-$(String(o),m,i)/2;"center"==c&&(l+=s/2),t.xAxis.scrollShow&&t.pix;var n=t._scrollDistance_||0,d="center"==c?r[a]+s/2:r[a];d-Math.abs(n)>=t.area[3]-1&&d-Math.abs(n)<=t.width-t.area[1]+1&&(i.beginPath(),i.setFontSize(m),i.setFillStyle(t.xAxis.fontColor||t.fontColor),i.fillText(String(o),r[a]+l,h+t.xAxis.marginTop*t.pix+(t.xAxis.lineHeight-t.xAxis.fontSize)*t.pix/2+t.xAxis.fontSize*t.pix),i.closePath(),i.stroke())})):n.forEach((function(e,o){var l=t.xAxis.formatter?t.xAxis.formatter(e):e,n=t._scrollDistance_||0,d="center"==c?r[o]+s/2:r[o];if(d-Math.abs(n)>=t.area[3]-1&&d-Math.abs(n)<=t.width-t.area[1]+1){i.save(),i.beginPath(),i.setFontSize(m),i.setFillStyle(t.xAxis.fontColor||t.fontColor);var u=$(String(l),m,i),p=r[o];"center"==c&&(p=r[o]+s/2),t.xAxis.scrollShow&&t.pix;var x=h+t.xAxis.marginTop*t.pix+m-m*Math.abs(Math.sin(a._xAxisTextAngle_));t.xAxis.rotateAngle<0?(p-=m/2,u=0):(p+=m/2,u=-u),i.translate(p,x),i.rotate(-1*a._xAxisTextAngle_),i.fillText(String(l),u,0),i.closePath(),i.stroke(),i.restore()}}))}i.restore(),t.xAxis.title&&(i.beginPath(),i.setFontSize(t.xAxis.titleFontSize*t.pix),i.setFillStyle(t.xAxis.titleFontColor),i.fillText(String(t.xAxis.title),t.width-t.area[1]+t.xAxis.titleOffsetX*t.pix,t.height-t.area[2]+t.xAxis.marginTop*t.pix+(t.xAxis.lineHeight-t.xAxis.titleFontSize)*t.pix/2+(t.xAxis.titleFontSize+t.xAxis.titleOffsetY)*t.pix),i.closePath(),i.stroke()),t.xAxis.axisLine&&(i.beginPath(),i.setStrokeStyle(t.xAxis.axisLineColor),i.setLineWidth(1*t.pix),i.moveTo(l,t.height-t.area[2]),i.lineTo(n,t.height-t.area[2]),i.stroke())}function De(e,t,a,i){if(!0===t.yAxis.disableGrid)return;let o=(t.height-t.area[0]-t.area[2])/t.yAxis.splitNumber,r=t.area[3],l=t.chartData.xAxisData.xAxisPoints,n=t.chartData.xAxisData.eachSpacing,s=n*(l.length-1);"mount"==t.type&&t.extra&&t.extra.mount&&t.extra.mount.widthRatio&&t.extra.mount.widthRatio>1&&(t.extra.mount.widthRatio>2&&(t.extra.mount.widthRatio=2),s+=(t.extra.mount.widthRatio-1)*n);let c=r+s,h=[],d=1;!1===t.xAxis.axisLine&&(d=0);for(let u=d;u<t.yAxis.splitNumber+1;u++)h.push(t.height-t.area[2]-o*u);i.save(),t._scrollDistance_&&0!==t._scrollDistance_&&i.translate(t._scrollDistance_,0),"dash"==t.yAxis.gridType&&i.setLineDash([t.yAxis.dashLength*t.pix,t.yAxis.dashLength*t.pix]),i.setStrokeStyle(t.yAxis.gridColor),i.setLineWidth(1*t.pix),h.forEach((function(e,t){i.beginPath(),i.moveTo(r,e),i.lineTo(c,e),i.stroke()})),i.setLineDash([]),i.restore()}function Ne(e,t,a,i){if(!0===t.yAxis.disabled)return;var o=t.height-t.area[0]-t.area[2],r=o/t.yAxis.splitNumber,l=t.area[3],n=t.width-t.area[1],s=t.height-t.area[2];i.beginPath(),i.setFillStyle(t.background),1==t.enableScroll&&t.xAxis.scrollPosition&&"left"!==t.xAxis.scrollPosition&&i.fillRect(0,0,l,s+2*t.pix),1==t.enableScroll&&t.xAxis.scrollPosition&&"right"!==t.xAxis.scrollPosition&&i.fillRect(n,0,t.width,s+2*t.pix),i.closePath(),i.stroke();let c=t.area[3],h=t.width-t.area[1],d=t.area[3]+(t.width-t.area[1]-t.area[3])/2;if(t.yAxis.data)for(let p=0;p<t.yAxis.data.length;p++){let e=t.yAxis.data[p];var u=[];if("categories"===e.type)for(let a=0;a<=e.categories.length;a++)u.push(t.area[0]+o/e.categories.length/2+o/e.categories.length*a);else for(let a=0;a<=t.yAxis.splitNumber;a++)u.push(t.area[0]+r*a);if(!0!==e.disabled){let o=t.chartData.yAxisData.rangesFormat[p],r=e.fontSize?e.fontSize*t.pix:a.fontSize,l=t.chartData.yAxisData.yAxisWidth[p],n=e.textAlign||"right";if(o.forEach((function(a,o){var s=u[o];i.beginPath(),i.setFontSize(r),i.setLineWidth(1*t.pix),i.setStrokeStyle(e.axisLineColor||"#cccccc"),i.setFillStyle(e.fontColor||t.fontColor);let p=0,x=4*t.pix;if("left"==l.position){switch(1==e.calibration&&(i.moveTo(c,s),i.lineTo(c-3*t.pix,s),x+=3*t.pix),n){case"left":i.setTextAlign("left"),p=c-l.width;break;case"right":i.setTextAlign("right"),p=c-x;break;default:i.setTextAlign("center"),p=c-l.width/2}i.fillText(String(a),p,s+r/2-3*t.pix)}else if("right"==l.position){switch(1==e.calibration&&(i.moveTo(h,s),i.lineTo(h+3*t.pix,s),x+=3*t.pix),n){case"left":i.setTextAlign("left"),p=h+x;break;case"right":i.setTextAlign("right"),p=h+l.width;break;default:i.setTextAlign("center"),p=h+l.width/2}i.fillText(String(a),p,s+r/2-3*t.pix)}else if("center"==l.position){switch(1==e.calibration&&(i.moveTo(d,s),i.lineTo(d-3*t.pix,s),x+=3*t.pix),n){case"left":i.setTextAlign("left"),p=d-l.width;break;case"right":i.setTextAlign("right"),p=d-x;break;default:i.setTextAlign("center"),p=d-l.width/2}i.fillText(String(a),p,s+r/2-3*t.pix)}i.closePath(),i.stroke(),i.setTextAlign("left")})),!1!==e.axisLine&&(i.beginPath(),i.setStrokeStyle(e.axisLineColor||"#cccccc"),i.setLineWidth(1*t.pix),"left"==l.position?(i.moveTo(c,t.height-t.area[2]),i.lineTo(c,t.area[0])):"right"==l.position?(i.moveTo(h,t.height-t.area[2]),i.lineTo(h,t.area[0])):"center"==l.position&&(i.moveTo(d,t.height-t.area[2]),i.lineTo(d,t.area[0])),i.stroke()),t.yAxis.showTitle){let o=e.titleFontSize*t.pix||a.fontSize,r=e.title;i.beginPath(),i.setFontSize(o),i.setFillStyle(e.titleFontColor||t.fontColor),"left"==l.position?i.fillText(r,c-$(r,o,i)/2+(e.titleOffsetX||0),t.area[0]-(10-(e.titleOffsetY||0))*t.pix):"right"==l.position?i.fillText(r,h-$(r,o,i)/2+(e.titleOffsetX||0),t.area[0]-(10-(e.titleOffsetY||0))*t.pix):"center"==l.position&&i.fillText(r,d-$(r,o,i)/2+(e.titleOffsetX||0),t.area[0]-(10-(e.titleOffsetY||0))*t.pix),i.closePath(),i.stroke()}"left"==l.position?c-=l.width+t.yAxis.padding*t.pix:h+=l.width+t.yAxis.padding*t.pix}}}function Me(e,t,a,i,o){if(!1===t.legend.show)return;let r=o.legendData,l=r.points,n=r.area,s=t.legend.padding*t.pix,c=t.legend.fontSize*t.pix,h=15*t.pix,d=5*t.pix,u=t.legend.itemGap*t.pix,p=Math.max(t.legend.lineHeight*t.pix,c);i.beginPath(),i.setLineWidth(t.legend.borderWidth*t.pix),i.setStrokeStyle(t.legend.borderColor),i.setFillStyle(t.legend.backgroundColor),i.moveTo(n.start.x,n.start.y),i.rect(n.start.x,n.start.y,n.width,n.height),i.closePath(),i.fill(),i.stroke(),l.forEach((function(e,o){let l=0,x=0;l=r.widthArr[o],x=r.heightArr[o];let g=0,f=0;if("top"==t.legend.position||"bottom"==t.legend.position){switch(t.legend.float){case"left":g=n.start.x+s;break;case"right":g=n.start.x+n.width-l;break;default:g=n.start.x+(n.width-l)/2}f=n.start.y+s+o*p}else l=0==o?0:r.widthArr[o-1],g=n.start.x+s+l,f=n.start.y+s+(n.height-x)/2;i.setFontSize(a.fontSize);for(let a=0;a<e.length;a++){let o=e[a];switch(o.area=[0,0,0,0],o.area[0]=g,o.area[1]=f,o.area[3]=f+p,i.beginPath(),i.setLineWidth(1*t.pix),i.setStrokeStyle(o.show?o.color:t.legend.hiddenColor),i.setFillStyle(o.show?o.color:t.legend.hiddenColor),o.legendShape){case"line":i.moveTo(g,f+.5*p-2*t.pix),i.fillRect(g,f+.5*p-2*t.pix,15*t.pix,4*t.pix);break;case"triangle":i.moveTo(g+7.5*t.pix,f+.5*p-5*t.pix),i.lineTo(g+2.5*t.pix,f+.5*p+5*t.pix),i.lineTo(g+12.5*t.pix,f+.5*p+5*t.pix),i.lineTo(g+7.5*t.pix,f+.5*p-5*t.pix);break;case"diamond":i.moveTo(g+7.5*t.pix,f+.5*p-5*t.pix),i.lineTo(g+2.5*t.pix,f+.5*p),i.lineTo(g+7.5*t.pix,f+.5*p+5*t.pix),i.lineTo(g+12.5*t.pix,f+.5*p),i.lineTo(g+7.5*t.pix,f+.5*p-5*t.pix);break;case"circle":i.moveTo(g+7.5*t.pix,f+.5*p),i.arc(g+7.5*t.pix,f+.5*p,5*t.pix,0,2*Math.PI);break;case"rect":default:i.moveTo(g,f+.5*p-5*t.pix),i.fillRect(g,f+.5*p-5*t.pix,15*t.pix,10*t.pix);break;case"square":i.moveTo(g+5*t.pix,f+.5*p-5*t.pix),i.fillRect(g+5*t.pix,f+.5*p-5*t.pix,10*t.pix,10*t.pix);case"none":}i.closePath(),i.fill(),i.stroke(),g+=h+d;let r=.5*p+.5*c-2;const l=o.legendText?o.legendText:o.name;i.beginPath(),i.setFontSize(c),i.setFillStyle(o.show?t.legend.fontColor:t.legend.hiddenColor),i.fillText(l,g,f+r),i.closePath(),i.stroke(),"top"==t.legend.position||"bottom"==t.legend.position?(g+=$(l,c,i)+u,o.area[2]=g):(o.area[2]=g+$(l,c,i)+u,g-=h+d,f+=p)}}))}function Le(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{activeOpacity:.5,activeRadius:10,offsetAngle:0,labelWidth:15,ringWidth:30,customRadius:0,border:!1,borderWidth:2,borderColor:"#FFFFFF",centerColor:"#FFFFFF",linearType:"none",customColor:[]},"pie"==t.type?t.extra.pie:t.extra.ring),l={x:t.area[3]+(t.width-t.area[1]-t.area[3])/2,y:t.area[0]+(t.height-t.area[0]-t.area[2])/2};0==a.pieChartLinePadding&&(a.pieChartLinePadding=r.activeRadius*t.pix);var n=Math.min((t.width-t.area[1]-t.area[3])/2-a.pieChartLinePadding-a.pieChartTextPadding-a._pieTextMaxLength_,(t.height-t.area[0]-t.area[2])/2-a.pieChartLinePadding-a.pieChartTextPadding);n=n<10?10:n,r.customRadius>0&&(n=r.customRadius*t.pix),e=ee(e,n,o);var s=r.activeRadius*t.pix;if(r.customColor=W(r.linearType,r.customColor,e,a),(e=e.map((function(e){return e._start_+=r.offsetAngle*Math.PI/180,e}))).forEach((function(e,a){t.tooltip&&t.tooltip.index==a&&(i.beginPath(),i.setFillStyle(L(e.color,r.activeOpacity||.5)),i.moveTo(l.x,l.y),i.arc(l.x,l.y,e._radius_+s,e._start_,e._start_+2*e._proportion_*Math.PI),i.closePath(),i.fill()),i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.lineJoin="round",i.setStrokeStyle(r.borderColor);var o,n=e.color;"custom"==r.linearType&&((o=i.createCircularGradient?i.createCircularGradient(l.x,l.y,e._radius_):i.createRadialGradient(l.x,l.y,0,l.x,l.y,e._radius_)).addColorStop(0,L(r.customColor[e.linearIndex],1)),o.addColorStop(1,L(e.color,1)),n=o);i.setFillStyle(n),i.moveTo(l.x,l.y),i.arc(l.x,l.y,e._radius_,e._start_,e._start_+2*e._proportion_*Math.PI),i.closePath(),i.fill(),1==r.border&&i.stroke()})),"ring"===t.type){var c=.6*n;"number"==typeof r.ringWidth&&r.ringWidth>0&&(c=Math.max(0,n-r.ringWidth*t.pix)),i.beginPath(),i.setFillStyle(r.centerColor),i.moveTo(l.x,l.y),i.arc(l.x,l.y,c,0,2*Math.PI),i.closePath(),i.fill()}return!1!==t.dataLabel&&1===o&&be(e,t,a,i,0,l),1===o&&"ring"===t.type&&fe(t,a,i,l),{center:l,radius:n,series:e}}function Fe(e,t,a,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=N({},{type:"default",startAngle:.75,endAngle:.25,width:15,labelOffset:13,splitLine:{fixRadius:0,splitNumber:10,width:15,color:"#FFFFFF",childNumber:5,childWidth:5},pointer:{width:15,color:"auto"}},a.extra.gauge);null==l.oldAngle&&(l.oldAngle=l.startAngle),null==l.oldData&&(l.oldData=0),e=function(e,t,a){let i;i=a<t?2+a-t:t-a;let o=t;for(let r=0;r<e.length;r++)e[r].value=null===e[r].value?0:e[r].value,e[r]._startAngle_=o,e[r]._endAngle_=i*e[r].value+t,e[r]._endAngle_>=2&&(e[r]._endAngle_=e[r]._endAngle_%2),o=e[r]._endAngle_;return e}(e,l.startAngle,l.endAngle);var n={x:a.width/2,y:a.height/2},s=Math.min(n.x,n.y);s-=5*a.pix;var c=(s=(s-=l.width/2)<10?10:s)-l.width,h=0;if("progress"==l.type){var d=s-3*l.width;o.beginPath();let e=o.createLinearGradient(n.x,n.y-d,n.x,n.y+d);e.addColorStop("0",L(t[0].color,.3)),e.addColorStop("1.0",L("#FFFFFF",.1)),o.setFillStyle(e),o.arc(n.x,n.y,d,0,2*Math.PI,!1),o.fill(),o.setLineWidth(l.width),o.setStrokeStyle(L(t[0].color,.3)),o.setLineCap("round"),o.beginPath(),o.arc(n.x,n.y,c,l.startAngle*Math.PI,l.endAngle*Math.PI,!1),o.stroke(),h=l.endAngle<l.startAngle?2+l.endAngle-l.startAngle:l.startAngle-l.endAngle,l.splitLine.splitNumber;let i=h/l.splitLine.splitNumber/l.splitLine.childNumber,u=-s-.5*l.width-l.splitLine.fixRadius,p=-s-l.width-l.splitLine.fixRadius+l.splitLine.width;o.save(),o.translate(n.x,n.y),o.rotate((l.startAngle-1)*Math.PI);let x=l.splitLine.splitNumber*l.splitLine.childNumber+1,g=t[0].data*r;for(let r=0;r<x;r++)o.beginPath(),g>r/x?o.setStrokeStyle(L(t[0].color,1)):o.setStrokeStyle(L(t[0].color,.3)),o.setLineWidth(3*a.pix),o.moveTo(u,0),o.lineTo(p,0),o.stroke(),o.rotate(i*Math.PI);o.restore(),t=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;1==a&&(a=.999999);for(let i=0;i<e.length;i++){let o,r=e[i];r.data=null===r.data?0:r.data,o="circle"==t.type?2:t.endAngle<t.startAngle?2+t.endAngle-t.startAngle:t.startAngle-t.endAngle,r._proportion_=o*r.data*a+t.startAngle,r._proportion_>=2&&(r._proportion_=r._proportion_%2)}return e}(t,l,r),o.setLineWidth(l.width),o.setStrokeStyle(t[0].color),o.setLineCap("round"),o.beginPath(),o.arc(n.x,n.y,c,l.startAngle*Math.PI,t[0]._proportion_*Math.PI,!1),o.stroke();let f=s-2.5*l.width;o.save(),o.translate(n.x,n.y),o.rotate((t[0]._proportion_-1)*Math.PI),o.beginPath(),o.setLineWidth(l.width/3);let m=o.createLinearGradient(0,.6*-f,0,.6*f);m.addColorStop("0",L("#FFFFFF",0)),m.addColorStop("0.5",L(t[0].color,1)),m.addColorStop("1.0",L("#FFFFFF",0)),o.setStrokeStyle(m),o.arc(0,0,f,.85*Math.PI,1.15*Math.PI,!1),o.stroke(),o.beginPath(),o.setLineWidth(1),o.setStrokeStyle(t[0].color),o.setFillStyle(t[0].color),o.moveTo(-f-l.width/3/2,-4),o.lineTo(-f-l.width/3/2-4,0),o.lineTo(-f-l.width/3/2,4),o.lineTo(-f-l.width/3/2,-4),o.stroke(),o.fill(),o.restore()}else{o.setLineWidth(l.width),o.setLineCap("butt");for(let t=0;t<e.length;t++){let a=e[t];o.beginPath(),o.setStrokeStyle(a.color),o.arc(n.x,n.y,s,a._startAngle_*Math.PI,a._endAngle_*Math.PI,!1),o.stroke()}o.save();let d=(h=l.endAngle<l.startAngle?2+l.endAngle-l.startAngle:l.startAngle-l.endAngle)/l.splitLine.splitNumber,u=h/l.splitLine.splitNumber/l.splitLine.childNumber,p=-s-.5*l.width-l.splitLine.fixRadius,x=-s-.5*l.width-l.splitLine.fixRadius+l.splitLine.width,g=-s-.5*l.width-l.splitLine.fixRadius+l.splitLine.childWidth;o.translate(n.x,n.y),o.rotate((l.startAngle-1)*Math.PI);for(let e=0;e<l.splitLine.splitNumber+1;e++)o.beginPath(),o.setStrokeStyle(l.splitLine.color),o.setLineWidth(2*a.pix),o.moveTo(p,0),o.lineTo(x,0),o.stroke(),o.rotate(d*Math.PI);o.restore(),o.save(),o.translate(n.x,n.y),o.rotate((l.startAngle-1)*Math.PI);for(let e=0;e<l.splitLine.splitNumber*l.splitLine.childNumber+1;e++)o.beginPath(),o.setStrokeStyle(l.splitLine.color),o.setLineWidth(1*a.pix),o.moveTo(p,0),o.lineTo(g,0),o.stroke(),o.rotate(u*Math.PI);o.restore(),t=function(e,t,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;for(let o=0;o<e.length;o++){let r,l=e[o];if(l.data=null===l.data?0:l.data,"auto"==a.pointer.color){for(let e=0;e<t.length;e++)if(l.data<=t[e].value){l.color=t[e].color;break}}else l.color=a.pointer.color;r=a.endAngle<a.startAngle?2+a.endAngle-a.startAngle:a.startAngle-a.endAngle,l._endAngle_=r*l.data+a.startAngle,l._oldAngle_=a.oldAngle,a.oldAngle<a.endAngle&&(l._oldAngle_+=2),l.data>=a.oldData?l._proportion_=(l._endAngle_-l._oldAngle_)*i+a.oldAngle:l._proportion_=l._oldAngle_-(l._oldAngle_-l._endAngle_)*i,l._proportion_>=2&&(l._proportion_=l._proportion_%2)}return e}(t,e,l,r);for(let e=0;e<t.length;e++){let a=t[e];o.save(),o.translate(n.x,n.y),o.rotate((a._proportion_-1)*Math.PI),o.beginPath(),o.setFillStyle(a.color),o.moveTo(l.pointer.width,0),o.lineTo(0,-l.pointer.width/2),o.lineTo(-c,0),o.lineTo(0,l.pointer.width/2),o.lineTo(l.pointer.width,0),o.closePath(),o.fill(),o.beginPath(),o.setFillStyle("#FFFFFF"),o.arc(0,0,l.pointer.width/6,0,2*Math.PI,!1),o.fill(),o.restore()}!1!==a.dataLabel&&function(e,t,a,i,o,r){let l;t=(t-=e.width/2+e.labelOffset*i.pix)<10?10:t,l=e.endAngle<e.startAngle?2+e.endAngle-e.startAngle:e.startAngle-e.endAngle;let n=l/e.splitLine.splitNumber,s=(e.endNumber-e.startNumber)/e.splitLine.splitNumber,c=e.startAngle,h=e.startNumber;for(let g=0;g<e.splitLine.splitNumber+1;g++){var d={x:t*Math.cos(c*Math.PI),y:t*Math.sin(c*Math.PI)},u=e.formatter?e.formatter(h,g,i):h;d.x+=a.x-$(u,o.fontSize,r)/2,d.y+=a.y;var p=d.x,x=d.y;r.beginPath(),r.setFontSize(o.fontSize),r.setFillStyle(e.labelColor||i.fontColor),r.fillText(u,p,x+o.fontSize/2),r.closePath(),r.stroke(),c+=n,c>=2&&(c%=2),h+=s}}(l,s,n,a,i,o)}return fe(a,i,o,n),1===r&&"gauge"===a.type&&(a.extra.gauge.oldAngle=t[0]._proportion_,a.extra.gauge.oldData=t[0].data),{center:n,radius:s,innerRadius:c,categories:e,totalAngle:h}}function Ve(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{gridColor:"#cccccc",gridType:"radar",gridEval:1,axisLabel:!1,axisLabelTofix:0,labelShow:!0,labelColor:"#666666",labelPointShow:!1,labelPointRadius:3,labelPointColor:"#cccccc",opacity:.2,gridCount:3,border:!1,borderWidth:2,linearType:"none",customColor:[]},t.extra.radar),l=function(e){for(var t=2*Math.PI/e,a=[],i=0;i<e;i++)a.push(t*i);return a.map((function(e){return-1*e+Math.PI/2}))}(t.categories.length),n={x:t.area[3]+(t.width-t.area[1]-t.area[3])/2,y:t.area[0]+(t.height-t.area[0]-t.area[2])/2},s=(t.width-t.area[1]-t.area[3])/2,c=(t.height-t.area[0]-t.area[2])/2,h=Math.min(s-(function(e,t,a){var i=e.map((function(e){return $(e,t,a)}));return Math.max.apply(null,i)}(t.categories,a.fontSize,i)+a.radarLabelTextMargin),c-a.radarLabelTextMargin);h=(h-=a.radarLabelTextMargin*t.pix)<10?10:h,h=r.radius?r.radius:h,i.beginPath(),i.setLineWidth(1*t.pix),i.setStrokeStyle(r.gridColor),l.forEach((function(e,t){var a=z(h*Math.cos(e),h*Math.sin(e),n);i.moveTo(n.x,n.y),t%r.gridEval==0&&i.lineTo(a.x,a.y)})),i.stroke(),i.closePath();for(var d=function(e){var a={};if(i.beginPath(),i.setLineWidth(1*t.pix),i.setStrokeStyle(r.gridColor),"radar"==r.gridType)l.forEach((function(t,o){var l=z(h/r.gridCount*e*Math.cos(t),h/r.gridCount*e*Math.sin(t),n);0===o?(a=l,i.moveTo(l.x,l.y)):i.lineTo(l.x,l.y)})),i.lineTo(a.x,a.y);else{var o=z(h/r.gridCount*e*Math.cos(1.5),h/r.gridCount*e*Math.sin(1.5),n);i.arc(n.x,n.y,n.y-o.y,0,2*Math.PI,!1)}i.stroke(),i.closePath()},u=1;u<=r.gridCount;u++)d(u);r.customColor=W(r.linearType,r.customColor,e,a);var p=function(e,t,a,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=o.extra.radar||{};l.max=l.max||0;var n=Math.max(l.max,Math.max.apply(null,G(i))),s=[];for(let c=0;c<i.length;c++){let o=i[c],l={};l.color=o.color,l.legendShape=o.legendShape,l.pointShape=o.pointShape,l.data=[],o.data.forEach((function(i,o){let s={};s.angle=e[o],s.proportion=i/n,s.value=i,s.position=z(a*s.proportion*r*Math.cos(s.angle),a*s.proportion*r*Math.sin(s.angle),t),l.data.push(s)})),s.push(l)}return s}(l,n,h,e,t,o);if(p.forEach((function(a,o){i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.setStrokeStyle(a.color);var l,s=L(a.color,r.opacity);"custom"==r.linearType&&((l=i.createCircularGradient?i.createCircularGradient(n.x,n.y,h):i.createRadialGradient(n.x,n.y,0,n.x,n.y,h)).addColorStop(0,L(r.customColor[e[o].linearIndex],r.opacity)),l.addColorStop(1,L(a.color,r.opacity)),s=l);(i.setFillStyle(s),a.data.forEach((function(e,t){0===t?i.moveTo(e.position.x,e.position.y):i.lineTo(e.position.x,e.position.y)})),i.closePath(),i.fill(),!0===r.border&&i.stroke(),i.closePath(),!1!==t.dataPointShape)&&xe(a.data.map((function(e){return e.position})),a.color,a.pointShape,i,t)})),!0===r.axisLabel){const a=Math.max(r.max,Math.max.apply(null,G(e))),o=h/r.gridCount,l=t.fontSize*t.pix;i.setFontSize(l),i.setFillStyle(t.fontColor),i.setTextAlign("left");for(u=0;u<r.gridCount+1;u++){let e=u*a/r.gridCount;e=e.toFixed(r.axisLabelTofix),i.fillText(String(e),n.x+3*t.pix,n.y-u*o+l/2)}}return function(e,t,a,i,o,r){var l=i.extra.radar||{};e.forEach((function(e,n){if(!0===l.labelPointShow&&""!==i.categories[n]){var s={x:t*Math.cos(e),y:t*Math.sin(e)},c=z(s.x,s.y,a);r.setFillStyle(l.labelPointColor),r.beginPath(),r.arc(c.x,c.y,l.labelPointRadius*i.pix,0,2*Math.PI,!1),r.closePath(),r.fill()}if(!0===l.labelShow){var h={x:(t+o.radarLabelTextMargin*i.pix)*Math.cos(e),y:(t+o.radarLabelTextMargin*i.pix)*Math.sin(e)},d=z(h.x,h.y,a),u=d.x,p=d.y;M.approximatelyEqual(h.x,0)?u-=$(i.categories[n]||"",o.fontSize,r)/2:h.x<0&&(u-=$(i.categories[n]||"",o.fontSize,r)),r.beginPath(),r.setFontSize(o.fontSize),r.setFillStyle(l.labelColor||i.fontColor),r.fillText(i.categories[n]||"",u,p+o.fontSize/2),r.closePath(),r.stroke()}}))}(l,h,n,t,a,i),!1!==t.dataLabel&&1===o&&(p.forEach((function(e,o){i.beginPath();var r=e.textSize*t.pix||a.fontSize;i.setFontSize(r),i.setFillStyle(e.textColor||t.fontColor),e.data.forEach((function(e,t){Math.abs(e.position.x-n.x)<2?e.position.y<n.y?(i.setTextAlign("center"),i.fillText(e.value,e.position.x,e.position.y-4)):(i.setTextAlign("center"),i.fillText(e.value,e.position.x,e.position.y+r+2)):e.position.x<n.x?(i.setTextAlign("right"),i.fillText(e.value,e.position.x-4,e.position.y+r/2-2)):(i.setTextAlign("left"),i.fillText(e.value,e.position.x+4,e.position.y+r/2-2))})),i.closePath(),i.stroke()})),i.setTextAlign("left")),{center:n,radius:h,angleList:l}}function Ie(e,t){var a=Array(2),i=20037508.34*e/180,o=Math.log(Math.tan((90+t)*Math.PI/360))/(Math.PI/180);return o=20037508.34*o/180,a[0]=i,a[1]=o,a}function Be(e,t,a,i,o,r){return{x:(t-a.xMin)*i+o,y:(a.yMax-e)*i+r}}function ze(e,t,a){if(t[1]==a[1])return!1;if(t[1]>e[1]&&a[1]>e[1])return!1;if(t[1]<e[1]&&a[1]<e[1])return!1;if(t[1]==e[1]&&a[1]>e[1])return!1;if(a[1]==e[1]&&t[1]>e[1])return!1;if(t[0]<e[0]&&a[1]<e[1])return!1;return!(a[0]-(a[0]-t[0])*(a[1]-e[1])/(a[1]-t[1])<e[0])}function Oe(e,t,a){let i=0;for(let o=0;o<t.length;o++){let r=t[o][0];1==t.length&&(r=t[o][0]);for(let t=0;t<r.length-1;t++){let o=r[t],l=r[t+1];a&&(o=Ie(r[t][0],r[t][1]),l=Ie(r[t+1][0],r[t+1][1])),ze(e,o,l)&&(i+=1)}}return i%2==1}function Re(e,t,a){a=0==a?1:a;for(var i=[],o=0;o<a;o++)i[o]=Math.random();return Math.floor(i.reduce((function(e,t){return e+t}))/a*(t-e))+e}function We(e,t,a,i){var o=!1;for(let r=0;r<t.length;r++)if(t[r].area){if(!(e[3]<t[r].area[1]||e[0]>t[r].area[2]||e[1]>t[r].area[3]||e[2]<t[r].area[0])){o=!0;break}if(e[0]<0||e[1]<0||e[2]>a||e[3]>i){o=!0;break}o=!1}return o}function $e(e,t,a,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{type:"normal",autoColors:!0},t.extra.word);t.chartData.wordCloudData||(t.chartData.wordCloudData=function(e,t,a){let i=e.series;switch(t){case"normal":for(let o=0;o<i.length;o++){let t,r,l,n=i[o].name,s=i[o].textSize*e.pix,c=$(n,s,a),h=0;for(;h++,t=Re(-e.width/2,e.width/2,5)-c/2,r=Re(-e.height/2,e.height/2,5)+s/2,l=[t-5+e.width/2,r-5-s+e.height/2,t+c+5+e.width/2,r+5+e.height/2],We(l,i,e.width,e.height);)if(1e3==h){l=[-100,-100,-100,-100];break}i[o].area=l}break;case"vertical":let t=function(){return Math.random()>.7};for(let o=0;o<i.length;o++){let r,l,n,s,c=i[o].name,h=i[o].textSize*e.pix,d=$(c,h,a),u=t(),p=0;for(;;){let t;if(p++,u?(r=Re(-e.width/2,e.width/2,5)-d/2,l=Re(-e.height/2,e.height/2,5)+h/2,n=[l-5-d+e.width/2,-r-5+e.height/2,l+5+e.width/2,-r+h+5+e.height/2],s=[e.width-(e.width/2-e.height/2)-(-r+h+5+e.height/2)-5,e.height/2-e.width/2+(l-5-d+e.width/2)-5,e.width-(e.width/2-e.height/2)-(-r+h+5+e.height/2)+h,e.height/2-e.width/2+(l-5-d+e.width/2)+d+5],t=We(s,i,e.height,e.width)):(r=Re(-e.width/2,e.width/2,5)-d/2,l=Re(-e.height/2,e.height/2,5)+h/2,n=[r-5+e.width/2,l-5-h+e.height/2,r+d+5+e.width/2,l+5+e.height/2],t=We(n,i,e.width,e.height)),!t)break;if(1e3==p){n=[-1e3,-1e3,-1e3,-1e3];break}}u?(i[o].area=s,i[o].areav=n):i[o].area=n,i[o].rotate=u}}return i}(t,r.type,i)),i.beginPath(),i.setFillStyle(t.background),i.rect(0,0,t.width,t.height),i.fill(),i.save();let l=t.chartData.wordCloudData;i.translate(t.width/2,t.height/2);for(let n=0;n<l.length;n++){i.save(),l[n].rotate&&i.rotate(90*Math.PI/180);let e=l[n].name,a=l[n].textSize*t.pix,r=$(e,a,i);i.beginPath(),i.setStrokeStyle(l[n].color),i.setFillStyle(l[n].color),i.setFontSize(a),l[n].rotate?l[n].areav[0]>0&&(t.tooltip&&t.tooltip.index==n?i.strokeText(e,(l[n].areav[0]+5-t.width/2)*o-r*(1-o)/2,(l[n].areav[1]+5+a-t.height/2)*o):i.fillText(e,(l[n].areav[0]+5-t.width/2)*o-r*(1-o)/2,(l[n].areav[1]+5+a-t.height/2)*o)):l[n].area[0]>0&&(t.tooltip&&t.tooltip.index==n?i.strokeText(e,(l[n].area[0]+5-t.width/2)*o-r*(1-o)/2,(l[n].area[1]+5+a-t.height/2)*o):i.fillText(e,(l[n].area[0]+5-t.width/2)*o-r*(1-o)/2,(l[n].area[1]+5+a-t.height/2)*o)),i.stroke(),i.restore()}i.restore()}function Ge(e,t,a,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{type:"funnel",activeWidth:10,activeOpacity:.3,border:!1,borderWidth:2,borderColor:"#FFFFFF",fillOpacity:1,minSize:0,labelAlign:"right",linearType:"none",customColor:[]},t.extra.funnel),l=(t.height-t.area[0]-t.area[2])/e.length,n={x:t.area[3]+(t.width-t.area[1]-t.area[3])/2,y:t.height-t.area[2]},s=r.activeWidth*t.pix,c=Math.min((t.width-t.area[1]-t.area[3])/2-s,(t.height-t.area[0]-t.area[2])/2-s),h=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;for(let r=0;r<e.length;r++)"funnel"==a.type?e[r].radius=e[r].data/e[0].data*t*o:e[r].radius=i*(e.length-r)/(i*e.length)*t*o,e[r]._proportion_=e[r].data/e[0].data;return e}(e,c,r,l,o);if(i.save(),i.translate(n.x,n.y),r.customColor=W(r.linearType,r.customColor,e,a),"pyramid"==r.type)for(let p=0;p<h.length;p++){if(p==h.length-1){t.tooltip&&t.tooltip.index==p&&(i.beginPath(),i.setFillStyle(L(h[p].color,r.activeOpacity)),i.moveTo(-s,-l),i.lineTo(-h[p].radius-s,0),i.lineTo(h[p].radius+s,0),i.lineTo(s,-l),i.lineTo(-s,-l),i.closePath(),i.fill()),h[p].funnelArea=[n.x-h[p].radius,n.y-l*(p+1),n.x+h[p].radius,n.y-l*p],i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.setStrokeStyle(r.borderColor);var d=L(h[p].color,r.fillOpacity);if("custom"==r.linearType)(u=i.createLinearGradient(h[p].radius,-l,-h[p].radius,-l)).addColorStop(0,L(h[p].color,r.fillOpacity)),u.addColorStop(.5,L(r.customColor[h[p].linearIndex],r.fillOpacity)),u.addColorStop(1,L(h[p].color,r.fillOpacity)),d=u;i.setFillStyle(d),i.moveTo(0,-l),i.lineTo(-h[p].radius,0),i.lineTo(h[p].radius,0),i.lineTo(0,-l),i.closePath(),i.fill(),1==r.border&&i.stroke()}else{t.tooltip&&t.tooltip.index==p&&(i.beginPath(),i.setFillStyle(L(h[p].color,r.activeOpacity)),i.moveTo(0,0),i.lineTo(-h[p].radius-s,0),i.lineTo(-h[p+1].radius-s,-l),i.lineTo(h[p+1].radius+s,-l),i.lineTo(h[p].radius+s,0),i.lineTo(0,0),i.closePath(),i.fill()),h[p].funnelArea=[n.x-h[p].radius,n.y-l*(p+1),n.x+h[p].radius,n.y-l*p],i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.setStrokeStyle(r.borderColor);d=L(h[p].color,r.fillOpacity);if("custom"==r.linearType)(u=i.createLinearGradient(h[p].radius,-l,-h[p].radius,-l)).addColorStop(0,L(h[p].color,r.fillOpacity)),u.addColorStop(.5,L(r.customColor[h[p].linearIndex],r.fillOpacity)),u.addColorStop(1,L(h[p].color,r.fillOpacity)),d=u;i.setFillStyle(d),i.moveTo(0,0),i.lineTo(-h[p].radius,0),i.lineTo(-h[p+1].radius,-l),i.lineTo(h[p+1].radius,-l),i.lineTo(h[p].radius,0),i.lineTo(0,0),i.closePath(),i.fill(),1==r.border&&i.stroke()}i.translate(0,-l)}else{i.translate(0,-(h.length-1)*l);for(let e=0;e<h.length;e++){if(e==h.length-1){t.tooltip&&t.tooltip.index==e&&(i.beginPath(),i.setFillStyle(L(h[e].color,r.activeOpacity)),i.moveTo(-s-r.minSize/2,0),i.lineTo(-h[e].radius-s,-l),i.lineTo(h[e].radius+s,-l),i.lineTo(s+r.minSize/2,0),i.lineTo(-s-r.minSize/2,0),i.closePath(),i.fill()),h[e].funnelArea=[n.x-h[e].radius,n.y-l,n.x+h[e].radius,n.y],i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.setStrokeStyle(r.borderColor);d=L(h[e].color,r.fillOpacity);if("custom"==r.linearType)(u=i.createLinearGradient(h[e].radius,-l,-h[e].radius,-l)).addColorStop(0,L(h[e].color,r.fillOpacity)),u.addColorStop(.5,L(r.customColor[h[e].linearIndex],r.fillOpacity)),u.addColorStop(1,L(h[e].color,r.fillOpacity)),d=u;i.setFillStyle(d),i.moveTo(0,0),i.lineTo(-r.minSize/2,0),i.lineTo(-h[e].radius,-l),i.lineTo(h[e].radius,-l),i.lineTo(r.minSize/2,0),i.lineTo(0,0),i.closePath(),i.fill(),1==r.border&&i.stroke()}else{t.tooltip&&t.tooltip.index==e&&(i.beginPath(),i.setFillStyle(L(h[e].color,r.activeOpacity)),i.moveTo(0,0),i.lineTo(-h[e+1].radius-s,0),i.lineTo(-h[e].radius-s,-l),i.lineTo(h[e].radius+s,-l),i.lineTo(h[e+1].radius+s,0),i.lineTo(0,0),i.closePath(),i.fill()),h[e].funnelArea=[n.x-h[e].radius,n.y-l*(h.length-e),n.x+h[e].radius,n.y-l*(h.length-e-1)],i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.setStrokeStyle(r.borderColor);var u;d=L(h[e].color,r.fillOpacity);if("custom"==r.linearType)(u=i.createLinearGradient(h[e].radius,-l,-h[e].radius,-l)).addColorStop(0,L(h[e].color,r.fillOpacity)),u.addColorStop(.5,L(r.customColor[h[e].linearIndex],r.fillOpacity)),u.addColorStop(1,L(h[e].color,r.fillOpacity)),d=u;i.setFillStyle(d),i.moveTo(0,0),i.lineTo(-h[e+1].radius,0),i.lineTo(-h[e].radius,-l),i.lineTo(h[e].radius,-l),i.lineTo(h[e+1].radius,0),i.lineTo(0,0),i.closePath(),i.fill(),1==r.border&&i.stroke()}i.translate(0,l)}}return i.restore(),!1!==t.dataLabel&&1===o&&function(e,t,a,i,o,r,l){for(let n=0;n<e.length;n++){let s,c,h,d,u=e[n];if(!1===u.labelShow)continue;let p=u.formatter?u.formatter(u,n,e,t):M.toFixed(100*u._proportion_)+"%";p=u.labelText?u.labelText:p,"right"==o&&(s=n==e.length-1?(u.funnelArea[2]+l.x)/2:(u.funnelArea[2]+e[n+1].funnelArea[2])/2,c=s+2*r,h=u.funnelArea[1]+i/2,d=u.textSize*t.pix||t.fontSize*t.pix,a.setLineWidth(1*t.pix),a.setStrokeStyle(u.color),a.setFillStyle(u.color),a.beginPath(),a.moveTo(s,h),a.lineTo(c,h),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(c,h),a.arc(c,h,2*t.pix,0,2*Math.PI),a.closePath(),a.fill(),a.beginPath(),a.setFontSize(d),a.setFillStyle(u.textColor||t.fontColor),a.fillText(p,c+5,h+d/2-2),a.closePath(),a.stroke(),a.closePath()),"left"==o&&(s=n==e.length-1?(u.funnelArea[0]+l.x)/2:(u.funnelArea[0]+e[n+1].funnelArea[0])/2,c=s-2*r,h=u.funnelArea[1]+i/2,d=u.textSize*t.pix||t.fontSize*t.pix,a.setLineWidth(1*t.pix),a.setStrokeStyle(u.color),a.setFillStyle(u.color),a.beginPath(),a.moveTo(s,h),a.lineTo(c,h),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(c,h),a.arc(c,h,2,0,2*Math.PI),a.closePath(),a.fill(),a.beginPath(),a.setFontSize(d),a.setFillStyle(u.textColor||t.fontColor),a.fillText(p,c-5-$(p,d,a),h+d/2-2),a.closePath(),a.stroke(),a.closePath())}}(h,t,i,l,r.labelAlign,s,n),1===o&&function(e,t,a,i,o,r,l){for(let n=0;n<e.length;n++){let o,r,s=e[n];s.centerText&&(o=s.funnelArea[1]+i/2,r=s.centerTextSize*t.pix||t.fontSize*t.pix,a.beginPath(),a.setFontSize(r),a.setFillStyle(s.centerTextColor||"#FFFFFF"),a.fillText(s.centerText,l.x-$(s.centerText,r,a)/2,o+r/2-2),a.closePath(),a.stroke(),a.closePath())}}(h,t,i,l,r.labelAlign,0,n),{center:n,radius:c,series:h}}function Xe(e,t){t.save(),t.translate(0,.5),t.restore(),t.draw()}var Ue={easeIn:function(e){return Math.pow(e,3)},easeOut:function(e){return Math.pow(e-1,3)+1},easeInOut:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},linear:function(e){return e}};function He(e){this.isStop=!1,e.duration=void 0===e.duration?1e3:e.duration,e.timing=e.timing||"easeInOut";var t="undefined"!=typeof setTimeout?function(e,t){setTimeout((function(){e(+new Date)}),t)}:"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(e){e(null)},a=null,i=function(o){if(null===o||!0===this.isStop)return e.onProcess&&e.onProcess(1),void(e.onAnimationFinish&&e.onAnimationFinish());if(null===a&&(a=o),o-a<e.duration){var r=(o-a)/e.duration;r=(0,Ue[e.timing])(r),e.onProcess&&e.onProcess(r),t(i,17)}else e.onProcess&&e.onProcess(1),e.onAnimationFinish&&e.onAnimationFinish()};i=i.bind(this),t(i,17)}function qe(e,t,a,i){var o=this,r=t.series;"pie"!==e&&"ring"!==e&&"mount"!==e&&"rose"!==e&&"funnel"!==e||(r=function(e,t){let a=[];if(e.length>0&&e[0].data.constructor.toString().indexOf("Array")>-1){t._pieSeries_=e;let o=e[0].data;for(var i=0;i<o.length;i++)o[i].formatter=e[0].formatter,o[i].data=o[i].value,a.push(o[i]);t.series=a}else a=e;return a}(r,t));var l=t.categories;if("mount"===e){l=[];for(let e=0;e<r.length;e++)!1!==r[e].show&&l.push(r[e].name);t.categories=l}r=R(r,t,a);var n=t.animation?t.duration:0;o.animationInstance&&o.animationInstance.stop();var s=null;if("candle"==e){let e=N({},t.extra.candle.average);e.show?(s=R(s=function(e,t,a,i){let o=[];for(let r=0;r<e.length;r++){let l={data:[],name:t[r],color:a[r]};for(let t=0,a=i.length;t<a;t++){if(t<e[r]){l.data.push(null);continue}let a=0;for(let o=0;o<e[r];o++)a+=i[t-o][1];l.data.push(+(a/e[r]).toFixed(3))}o.push(l)}return o}(e.day,e.name,e.color,r[0].data),t,a),t.seriesMA=s):s=t.seriesMA?t.seriesMA=R(t.seriesMA,t,a):r}else s=r;t._series_=r=j(r),t.area=new Array(4);for(let x=0;x<4;x++)t.area[x]=t.padding[x]*t.pix;var c=function(e,t,a,i,o){let r={area:{start:{x:0,y:0},end:{x:0,y:0},width:0,height:0,wholeWidth:0,wholeHeight:0},points:[],widthArr:[],heightArr:[]};if(!1===t.legend.show)return i.legendData=r,r;let l=t.legend.padding*t.pix,n=t.legend.margin*t.pix,s=t.legend.fontSize?t.legend.fontSize*t.pix:a.fontSize,c=15*t.pix,h=5*t.pix,d=Math.max(t.legend.lineHeight*t.pix,s);if("top"==t.legend.position||"bottom"==t.legend.position){let a=[],i=0,u=[],p=[];for(let r=0;r<e.length;r++){let l=e[r],n=c+h+$((l.legendText?l.legendText:l.name)||"undefined",s,o)+t.legend.itemGap*t.pix;i+n>t.width-t.area[1]-t.area[3]?(a.push(p),u.push(i-t.legend.itemGap*t.pix),i=n,p=[l]):(i+=n,p.push(l))}if(p.length){a.push(p),u.push(i-t.legend.itemGap*t.pix),r.widthArr=u;let e=Math.max.apply(null,u);switch(t.legend.float){case"left":r.area.start.x=t.area[3],r.area.end.x=t.area[3]+e+2*l;break;case"right":r.area.start.x=t.width-t.area[1]-e-2*l,r.area.end.x=t.width-t.area[1];break;default:r.area.start.x=(t.width-e)/2-l,r.area.end.x=(t.width+e)/2+l}r.area.width=e+2*l,r.area.wholeWidth=e+2*l,r.area.height=a.length*d+2*l,r.area.wholeHeight=a.length*d+2*l+2*n,r.points=a}}else{let a=e.length,i=t.height-t.area[0]-t.area[2]-2*n-2*l,u=Math.min(Math.floor(i/d),a);switch(r.area.height=u*d+2*l,r.area.wholeHeight=u*d+2*l,t.legend.float){case"top":r.area.start.y=t.area[0]+n,r.area.end.y=t.area[0]+n+r.area.height;break;case"bottom":r.area.start.y=t.height-t.area[2]-n-r.area.height,r.area.end.y=t.height-t.area[2]-n;break;default:r.area.start.y=(t.height-r.area.height)/2,r.area.end.y=(t.height+r.area.height)/2}let p=a%u==0?a/u:Math.floor(a/u+1),x=[];for(let t=0;t<p;t++){let a=e.slice(t*u,t*u+u);x.push(a)}if(r.points=x,x.length){for(let a=0;a<x.length;a++){let e=x[a],i=0;for(let a=0;a<e.length;a++){let r=c+h+$(e[a].name||"undefined",s,o)+t.legend.itemGap*t.pix;r>i&&(i=r)}r.widthArr.push(i),r.heightArr.push(e.length*d+2*l)}let e=0;for(let t=0;t<r.widthArr.length;t++)e+=r.widthArr[t];r.area.width=e-t.legend.itemGap*t.pix+2*l,r.area.wholeWidth=r.area.width+l}}switch(t.legend.position){case"top":r.area.start.y=t.area[0]+n,r.area.end.y=t.area[0]+n+r.area.height;break;case"bottom":r.area.start.y=t.height-t.area[2]-r.area.height-n,r.area.end.y=t.height-t.area[2]-n;break;case"left":r.area.start.x=t.area[3],r.area.end.x=t.area[3]+r.area.width;break;case"right":r.area.start.x=t.width-t.area[1]-r.area.width,r.area.end.x=t.width-t.area[1]}return i.legendData=r,r}(s,t,a,t.chartData,i),h=c.area.wholeHeight,d=c.area.wholeWidth;switch(t.legend.position){case"top":t.area[0]+=h;break;case"bottom":t.area[2]+=h;break;case"left":t.area[3]+=d;break;case"right":t.area[1]+=d}let u={},p=0;if("line"===t.type||"column"===t.type||"mount"===t.type||"area"===t.type||"mix"===t.type||"candle"===t.type||"scatter"===t.type||"bubble"===t.type||"bar"===t.type){if(u=ue(r,t,a,i),p=u.yAxisWidth,t.yAxis.showTitle){let e=0;for(let i=0;i<t.yAxis.data.length;i++)e=Math.max(e,t.yAxis.data[i].titleFontSize?t.yAxis.data[i].titleFontSize*t.pix:a.fontSize);t.area[0]+=e}let e=0,o=0;for(let a=0;a<p.length;a++)"left"==p[a].position?(t.area[3]+=o>0?p[a].width+t.yAxis.padding*t.pix:p[a].width,o+=1):"right"==p[a].position&&(t.area[1]+=e>0?p[a].width+t.yAxis.padding*t.pix:p[a].width,e+=1)}else a.yAxisWidth=p;if(t.chartData.yAxisData=u,t.categories&&t.categories.length&&"radar"!==t.type&&"gauge"!==t.type&&"bar"!==t.type){t.chartData.xAxisData=oe(t.categories,t);let e=K(t.categories,t,0,t.chartData.xAxisData.eachSpacing,i),o=e.xAxisHeight,r=e.angle;a.xAxisHeight=o,a._xAxisTextAngle_=r,t.area[2]+=o,t.chartData.categoriesData=e}else if("line"===t.type||"area"===t.type||"scatter"===t.type||"bubble"===t.type||"bar"===t.type){t.chartData.xAxisData=Q(r,t,a,i);let e=K(l=t.chartData.xAxisData.rangesFormat,t,0,t.chartData.xAxisData.eachSpacing,i),o=e.xAxisHeight,n=e.angle;a.xAxisHeight=o,a._xAxisTextAngle_=n,t.area[2]+=o,t.chartData.categoriesData=e}else t.chartData.xAxisData={xAxisPoints:[]};if(t.enableScroll&&"right"==t.xAxis.scrollAlign&&void 0===t._scrollDistance_){let e=0,a=t.chartData.xAxisData.xAxisPoints,i=t.chartData.xAxisData.startX;e=t.chartData.xAxisData.endX-i-t.chartData.xAxisData.eachSpacing*(a.length-1),o.scrollOption.currentOffset=e,o.scrollOption.startTouchX=e,o.scrollOption.distance=0,o.scrollOption.lastMoveTime=0,t._scrollDistance_=e}switch("pie"!==e&&"ring"!==e&&"rose"!==e||(a._pieTextMaxLength_=!1===t.dataLabel?0:function(e,t,a,i){e=ee(e);let o=0;for(let r=0;r<e.length;r++){let l=e[r],n=l.formatter?l.formatter(+l._proportion_.toFixed(2)):M.toFixed(100*l._proportion_)+"%";o=Math.max(o,$(n,l.textSize*i.pix||t.fontSize,a))}return o}(s,a,i,t)),e){case"word":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),$e(r,t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"map":i.clearRect(0,0,t.width,t.height),function(e,t,a,i){var o,r,l=N({},{border:!0,mercator:!1,borderWidth:1,active:!0,borderColor:"#666666",fillOpacity:.6,activeBorderColor:"#f04864",activeFillColor:"#facc14",activeFillOpacity:1},t.extra.map),n=e,s=function(e){for(var t,a={xMin:180,xMax:0,yMin:90,yMax:0},i=0;i<e.length;i++)for(var o=e[i].geometry.coordinates,r=0;r<o.length;r++){1==(t=o[r]).length&&(t=t[0]);for(var l=0;l<t.length;l++){var n={x:t[l][0],y:t[l][1]};a.xMin=a.xMin<n.x?a.xMin:n.x,a.xMax=a.xMax>n.x?a.xMax:n.x,a.yMin=a.yMin<n.y?a.yMin:n.y,a.yMax=a.yMax>n.y?a.yMax:n.y}}return a}(n);if(l.mercator){var c=Ie(s.xMax,s.yMax),h=Ie(s.xMin,s.yMin);s.xMax=c[0],s.yMax=c[1],s.xMin=h[0],s.yMin=h[1]}for(var d=t.width/Math.abs(s.xMax-s.xMin),u=t.height/Math.abs(s.yMax-s.yMin),p=d<u?d:u,x=t.width/2-Math.abs(s.xMax-s.xMin)/2*p,g=t.height/2-Math.abs(s.yMax-s.yMin)/2*p,f=0;f<n.length;f++){i.beginPath(),i.setLineWidth(l.borderWidth*t.pix),i.setStrokeStyle(l.borderColor),i.setFillStyle(L(e[f].color,e[f].fillOpacity||l.fillOpacity)),1==l.active&&t.tooltip&&t.tooltip.index==f&&(i.setStrokeStyle(l.activeBorderColor),i.setFillStyle(L(l.activeFillColor,l.activeFillOpacity)));for(var m=n[f].geometry.coordinates,y=0;y<m.length;y++){1==(o=m[y]).length&&(o=o[0]);for(var v=0;v<o.length;v++){var b=Array(2);r=Be((b=l.mercator?Ie(o[v][0],o[v][1]):o[v])[1],b[0],s,p,x,g),0===v?(i.beginPath(),i.moveTo(r.x,r.y)):i.lineTo(r.x,r.y)}i.fill(),1==l.border&&i.stroke()}}if(1==t.dataLabel)for(f=0;f<n.length;f++){var w=n[f].properties.centroid;if(w){l.mercator&&(w=Ie(n[f].properties.centroid[0],n[f].properties.centroid[1])),r=Be(w[1],w[0],s,p,x,g);let e=n[f].textSize*t.pix||a.fontSize,o=n[f].textColor||t.fontColor;l.active&&l.activeTextColor&&t.tooltip&&t.tooltip.index==f&&(o=l.activeTextColor);let c=n[f].properties.name;i.beginPath(),i.setFontSize(e),i.setFillStyle(o),i.fillText(c,r.x-$(c,e,i)/2,r.y+e/2),i.closePath(),i.stroke()}}t.chartData.mapData={bounds:s,scale:p,xoffset:x,yoffset:g,mercator:l.mercator},Ee(t,a,i,1),i.draw()}(r,t,a,i),setTimeout((()=>{this.uevent.trigger("renderComplete")}),50);break;case"funnel":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),t.chartData.funnelData=Ge(r,t,a,i,e),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"line":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{type:"straight",width:2,activeType:"none",linearType:"none",onShadow:!1,animation:"vertical"},t.extra.line);r.width*=t.pix;let l=t.chartData.xAxisData,n=l.xAxisPoints,s=l.eachSpacing;var c=[];i.save();let h=0,d=t.width+s;return t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),h=-t._scrollDistance_-2*s+t.area[3],d=h+(t.xAxis.itemCount+4)*s),e.forEach((function(e,l){let u,p,x;i.beginPath(),i.setStrokeStyle(e.color),i.moveTo(-1e4,-1e4),i.lineTo(-10001,-10001),i.stroke(),u=[].concat(t.chartData.yAxisData.ranges[e.index]),p=u.pop(),x=u.shift();var g=function(e,t,a,i,o,r,l,n,s){s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1;var c=r.xAxis.boundaryGap,h=[],d=r.height-r.area[0]-r.area[2],u=r.width-r.area[1]-r.area[3];return e.forEach((function(e,l){if(null===e)h.push(null);else{var p={};if(p.color=e.color,"vertical"==n.animation){p.x=i[l];var x=e;if("object"==typeof e&&null!==e)if(e.constructor.toString().indexOf("Array")>-1){let t,a,i;t=[].concat(r.chartData.xAxisData.ranges),a=t.shift(),i=t.pop(),x=e[1],p.x=r.area[3]+u*(e[0]-a)/(i-a)}else x=e.value;"center"==c&&(p.x+=o/2);var g=d*(x-t)/(a-t);g*=s,p.y=r.height-g-r.area[2],h.push(p)}else p.x=i[0]+o*l*s,x=e,"center"==c&&(p.x+=o/2),g=d*(x-t)/(a-t),p.y=r.height-g-r.area[2],h.push(p)}})),h}(e.data,p,x,n,s,t,a,r,o);c.push(g);var f=J(g,e);if("dash"==e.lineType){let a=e.dashLength?e.dashLength:8;a*=t.pix,i.setLineDash([a,a])}i.beginPath();var m=e.color;if("none"!==r.linearType&&e.linearColor&&e.linearColor.length>0){for(var y=i.createLinearGradient(t.chartData.xAxisData.startX,t.height/2,t.chartData.xAxisData.endX,t.height/2),v=0;v<e.linearColor.length;v++)y.addColorStop(e.linearColor[v][0],L(e.linearColor[v][1],1));m=y}i.setStrokeStyle(m),1==r.onShadow&&e.setShadow&&e.setShadow.length>0?i.setShadow(e.setShadow[0],e.setShadow[1],e.setShadow[2],e.setShadow[3]):i.setShadow(0,0,0,"rgba(0,0,0,0)"),i.setLineWidth(r.width),f.forEach((function(e,t){if(1===e.length)i.moveTo(e[0].x,e[0].y);else{i.moveTo(e[0].x,e[0].y);let t=0;if("curve"===r.type)for(let o=0;o<e.length;o++){let r=e[o];if(0==t&&r.x>h&&(i.moveTo(r.x,r.y),t=1),o>0&&r.x>h&&r.x<d){var a=B(e,o-1);i.bezierCurveTo(a.ctrA.x,a.ctrA.y,a.ctrB.x,a.ctrB.y,r.x,r.y)}}if("straight"===r.type)for(let a=0;a<e.length;a++){let o=e[a];0==t&&o.x>h&&(i.moveTo(o.x,o.y),t=1),a>0&&o.x>h&&o.x<d&&i.lineTo(o.x,o.y)}if("step"===r.type)for(let a=0;a<e.length;a++){let o=e[a];0==t&&o.x>h&&(i.moveTo(o.x,o.y),t=1),a>0&&o.x>h&&o.x<d&&(i.lineTo(o.x,e[a-1].y),i.lineTo(o.x,o.y))}i.moveTo(e[0].x,e[0].y)}})),i.stroke(),i.setLineDash([]),!1!==t.dataPointShape&&xe(g,e.color,e.pointShape,i,t),ge(g,e.color,e.pointShape,i,t,r)})),!1!==t.dataLabel&&1===o&&e.forEach((function(e,r){let l,c,h;l=[].concat(t.chartData.yAxisData.ranges[e.index]),c=l.pop(),h=l.shift(),me(re(e.data,c,h,n,s,t,a,o),e,a,i,t)})),i.restore(),{xAxisPoints:n,calPoints:c,eachSpacing:s}}(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"scatter":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;N({},{type:"circle"},t.extra.scatter);let r=t.chartData.xAxisData,l=r.xAxisPoints,n=r.eachSpacing;i.save();let s=0;return t.width,t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),s=-t._scrollDistance_-2*n+t.area[3],t.xAxis.itemCount),e.forEach((function(e,r){let s,c,h;s=[].concat(t.chartData.yAxisData.ranges[e.index]),c=s.pop(),h=s.shift();var d=re(e.data,c,h,l,n,t,a,o);i.beginPath(),i.setStrokeStyle(e.color),i.setFillStyle(e.color),i.setLineWidth(1*t.pix);var u=e.pointShape;if("diamond"===u)d.forEach((function(e,t){null!==e&&(i.moveTo(e.x,e.y-4.5),i.lineTo(e.x-4.5,e.y),i.lineTo(e.x,e.y+4.5),i.lineTo(e.x+4.5,e.y),i.lineTo(e.x,e.y-4.5))}));else if("circle"===u)d.forEach((function(e,a){null!==e&&(i.moveTo(e.x+2.5*t.pix,e.y),i.arc(e.x,e.y,3*t.pix,0,2*Math.PI,!1))}));else if("square"===u)d.forEach((function(e,t){null!==e&&(i.moveTo(e.x-3.5,e.y-3.5),i.rect(e.x-3.5,e.y-3.5,7,7))}));else if("triangle"===u)d.forEach((function(e,t){null!==e&&(i.moveTo(e.x,e.y-4.5),i.lineTo(e.x-4.5,e.y+4.5),i.lineTo(e.x+4.5,e.y+4.5),i.lineTo(e.x,e.y-4.5))}));else if("triangle"===u)return;i.closePath(),i.fill(),i.stroke()})),!1!==t.dataLabel&&1===o&&e.forEach((function(e,r){let s,c,h;s=[].concat(t.chartData.yAxisData.ranges[e.index]),c=s.pop(),h=s.shift(),me(re(e.data,c,h,l,n,t,a,o),e,a,i,t)})),i.restore(),{xAxisPoints:l,calPoints:[],eachSpacing:n}}(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"bubble":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{opacity:1,border:2},t.extra.bubble);let l=t.chartData.xAxisData,n=l.xAxisPoints,s=l.eachSpacing;i.save();let c=0;return t.width,t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),c=-t._scrollDistance_-2*s+t.area[3],t.xAxis.itemCount),e.forEach((function(e,l){let c,h,d;c=[].concat(t.chartData.yAxisData.ranges[e.index]),h=c.pop(),d=c.shift();var u=re(e.data,h,d,n,s,t,a,o);i.beginPath(),i.setStrokeStyle(e.color),i.setLineWidth(r.border*t.pix),i.setFillStyle(L(e.color,r.opacity)),u.forEach((function(e,a){i.moveTo(e.x+e.r,e.y),i.arc(e.x,e.y,e.r*t.pix,0,2*Math.PI,!1)})),i.closePath(),i.fill(),i.stroke(),!1!==t.dataLabel&&1===o&&u.forEach((function(o,r){i.beginPath();var l=e.textSize*t.pix||a.fontSize;i.setFontSize(l),i.setFillStyle(e.textColor||"#FFFFFF"),i.setTextAlign("center"),i.fillText(String(o.t),o.x,o.y+l/2),i.closePath(),i.stroke(),i.setTextAlign("left")}))})),i.restore(),{xAxisPoints:n,calPoints:[],eachSpacing:s}}(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"mix":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=function(e,t,a,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=t.chartData.xAxisData,l=r.xAxisPoints,n=r.eachSpacing,s=N({},{width:n/2,barBorderCircle:!1,barBorderRadius:[],seriesGap:2,linearType:"none",linearOpacity:1,customColor:[],colorStop:0},t.extra.mix.column),c=N({},{opacity:.2,gradient:!1},t.extra.mix.area),h=N({},{width:2},t.extra.mix.line),d=t.height-t.area[2],u=[];var p=0,x=0;e.forEach((function(e,t){"column"==e.type&&(x+=1)})),i.save();let g=-2,f=l.length+2,m=0,y=t.width+n;t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),g=Math.floor(-t._scrollDistance_/n)-2,f=g+t.xAxis.itemCount+4,m=-t._scrollDistance_-2*n+t.area[3],y=m+(t.xAxis.itemCount+4)*n),s.customColor=W(s.linearType,s.customColor,e,a),e.forEach((function(e,r){let v,b,w;v=[].concat(t.chartData.yAxisData.ranges[e.index]),b=v.pop(),w=v.shift();var S=re(e.data,b,w,l,n,t,a,o);if(u.push(S),"column"==e.type){S=ae(S,n,x,p,0,t);for(let a=0;a<S.length;a++){let o=S[a];if(null!==o&&a>g&&a<f){var A=o.x-o.width/2;t.height,o.y,t.area[2],i.beginPath();var T=o.color||e.color,k=o.color||e.color;if("none"!==s.linearType){var C=i.createLinearGradient(A,o.y,A,t.height-t.area[2]);"opacity"==s.linearType?(C.addColorStop(0,L(T,s.linearOpacity)),C.addColorStop(1,L(T,1))):(C.addColorStop(0,L(s.customColor[e.linearIndex],s.linearOpacity)),C.addColorStop(s.colorStop,L(s.customColor[e.linearIndex],s.linearOpacity)),C.addColorStop(1,L(T,1))),T=C}if(s.barBorderRadius&&4===s.barBorderRadius.length||s.barBorderCircle){const e=A,a=o.y,r=o.width,l=t.height-t.area[2]-o.y;s.barBorderCircle&&(s.barBorderRadius=[r/2,r/2,0,0]);let[n,c,h,d]=s.barBorderRadius,u=Math.min(r/2,l/2);n=n>u?u:n,c=c>u?u:c,h=h>u?u:h,d=d>u?u:d,n=n<0?0:n,c=c<0?0:c,h=h<0?0:h,d=d<0?0:d,i.arc(e+n,a+n,n,-Math.PI,-Math.PI/2),i.arc(e+r-c,a+c,c,-Math.PI/2,0),i.arc(e+r-h,a+l-h,h,0,Math.PI/2),i.arc(e+d,a+l-d,d,Math.PI/2,Math.PI)}else i.moveTo(A,o.y),i.lineTo(A+o.width,o.y),i.lineTo(A+o.width,t.height-t.area[2]),i.lineTo(A,t.height-t.area[2]),i.lineTo(A,o.y),i.setLineWidth(1),i.setStrokeStyle(k);i.setFillStyle(T),i.closePath(),i.fill()}}p+=1}if("area"==e.type){let a=J(S,e);for(let o=0;o<a.length;o++){let r=a[o];if(i.beginPath(),i.setStrokeStyle(e.color),i.setStrokeStyle(L(e.color,c.opacity)),c.gradient){let a=i.createLinearGradient(0,t.area[0],0,t.height-t.area[2]);a.addColorStop("0",L(e.color,c.opacity)),a.addColorStop("1.0",L("#FFFFFF",.1)),i.setFillStyle(a)}else i.setFillStyle(L(e.color,c.opacity));if(i.setLineWidth(2*t.pix),r.length>1){var P=r[0];let t=r[r.length-1];i.moveTo(P.x,P.y);let a=0;if("curve"===e.style)for(let e=0;e<r.length;e++){let t=r[e];if(0==a&&t.x>m&&(i.moveTo(t.x,t.y),a=1),e>0&&t.x>m&&t.x<y){var E=B(r,e-1);i.bezierCurveTo(E.ctrA.x,E.ctrA.y,E.ctrB.x,E.ctrB.y,t.x,t.y)}}else for(let e=0;e<r.length;e++){let t=r[e];0==a&&t.x>m&&(i.moveTo(t.x,t.y),a=1),e>0&&t.x>m&&t.x<y&&i.lineTo(t.x,t.y)}i.lineTo(t.x,d),i.lineTo(P.x,d),i.lineTo(P.x,P.y)}else{let e=r[0];i.moveTo(e.x-n/2,e.y)}i.closePath(),i.fill()}}"line"==e.type&&J(S,e).forEach((function(a,o){if("dash"==e.lineType){let a=e.dashLength?e.dashLength:8;a*=t.pix,i.setLineDash([a,a])}if(i.beginPath(),i.setStrokeStyle(e.color),i.setLineWidth(h.width*t.pix),1===a.length)i.moveTo(a[0].x,a[0].y);else{i.moveTo(a[0].x,a[0].y);let t=0;if("curve"==e.style)for(let e=0;e<a.length;e++){let o=a[e];if(0==t&&o.x>m&&(i.moveTo(o.x,o.y),t=1),e>0&&o.x>m&&o.x<y){var r=B(a,e-1);i.bezierCurveTo(r.ctrA.x,r.ctrA.y,r.ctrB.x,r.ctrB.y,o.x,o.y)}}else for(let e=0;e<a.length;e++){let o=a[e];0==t&&o.x>m&&(i.moveTo(o.x,o.y),t=1),e>0&&o.x>m&&o.x<y&&i.lineTo(o.x,o.y)}i.moveTo(a[0].x,a[0].y)}i.stroke(),i.setLineDash([])})),"point"==e.type&&(e.addPoint=!0),1==e.addPoint&&"column"!==e.type&&xe(S,e.color,e.pointShape,i,t)})),!1!==t.dataLabel&&1===o&&(p=0,e.forEach((function(e,r){let s,c,h;s=[].concat(t.chartData.yAxisData.ranges[e.index]),c=s.pop(),h=s.shift();var d=re(e.data,c,h,l,n,t,a,o);"column"!==e.type?me(d,e,a,i,t):(me(d=ae(d,n,x,p,0,t),e,a,i,t),p+=1)})));return i.restore(),{xAxisPoints:l,calPoints:u,eachSpacing:n}}(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"column":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=Te(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"mount":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=ke(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"bar":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),_e(l,t,a,i);var o=Ce(r,t,a,i,e),n=o.yAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.yAxisPoints=n,t.chartData.xAxisPoints=t.chartData.xAxisData.xAxisPoints,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"area":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{type:"straight",opacity:.2,addLine:!1,width:2,gradient:!1,activeType:"none"},t.extra.area);let l=t.chartData.xAxisData,n=l.xAxisPoints,s=l.eachSpacing,c=t.height-t.area[2],h=[];i.save();let d=0,u=t.width+s;return t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&(i.translate(t._scrollDistance_,0),d=-t._scrollDistance_-2*s+t.area[3],u=d+(t.xAxis.itemCount+4)*s),e.forEach((function(e,l){let p,x,g;p=[].concat(t.chartData.yAxisData.ranges[e.index]),x=p.pop(),g=p.shift();let f=re(e.data,x,g,n,s,t,a,o);h.push(f);let m=J(f,e);for(let a=0;a<m.length;a++){let o=m[a];if(i.beginPath(),i.setStrokeStyle(L(e.color,r.opacity)),r.gradient){let a=i.createLinearGradient(0,t.area[0],0,t.height-t.area[2]);a.addColorStop("0",L(e.color,r.opacity)),a.addColorStop("1.0",L("#FFFFFF",.1)),i.setFillStyle(a)}else i.setFillStyle(L(e.color,r.opacity));if(i.setLineWidth(r.width*t.pix),o.length>1){let e=o[0],t=o[o.length-1];i.moveTo(e.x,e.y);let a=0;if("curve"===r.type)for(let r=0;r<o.length;r++){let e=o[r];if(0==a&&e.x>d&&(i.moveTo(e.x,e.y),a=1),r>0&&e.x>d&&e.x<u){let t=B(o,r-1);i.bezierCurveTo(t.ctrA.x,t.ctrA.y,t.ctrB.x,t.ctrB.y,e.x,e.y)}}if("straight"===r.type)for(let r=0;r<o.length;r++){let e=o[r];0==a&&e.x>d&&(i.moveTo(e.x,e.y),a=1),r>0&&e.x>d&&e.x<u&&i.lineTo(e.x,e.y)}if("step"===r.type)for(let r=0;r<o.length;r++){let e=o[r];0==a&&e.x>d&&(i.moveTo(e.x,e.y),a=1),r>0&&e.x>d&&e.x<u&&(i.lineTo(e.x,o[r-1].y),i.lineTo(e.x,e.y))}i.lineTo(t.x,c),i.lineTo(e.x,c),i.lineTo(e.x,e.y)}else{let e=o[0];i.moveTo(e.x-s/2,e.y)}if(i.closePath(),i.fill(),r.addLine){if("dash"==e.lineType){let a=e.dashLength?e.dashLength:8;a*=t.pix,i.setLineDash([a,a])}if(i.beginPath(),i.setStrokeStyle(e.color),i.setLineWidth(r.width*t.pix),1===o.length)i.moveTo(o[0].x,o[0].y);else{i.moveTo(o[0].x,o[0].y);let e=0;if("curve"===r.type)for(let t=0;t<o.length;t++){let a=o[t];if(0==e&&a.x>d&&(i.moveTo(a.x,a.y),e=1),t>0&&a.x>d&&a.x<u){let e=B(o,t-1);i.bezierCurveTo(e.ctrA.x,e.ctrA.y,e.ctrB.x,e.ctrB.y,a.x,a.y)}}if("straight"===r.type)for(let t=0;t<o.length;t++){let a=o[t];0==e&&a.x>d&&(i.moveTo(a.x,a.y),e=1),t>0&&a.x>d&&a.x<u&&i.lineTo(a.x,a.y)}if("step"===r.type)for(let t=0;t<o.length;t++){let a=o[t];0==e&&a.x>d&&(i.moveTo(a.x,a.y),e=1),t>0&&a.x>d&&a.x<u&&(i.lineTo(a.x,o[t-1].y),i.lineTo(a.x,a.y))}i.moveTo(o[0].x,o[0].y)}i.stroke(),i.setLineDash([])}}!1!==t.dataPointShape&&xe(f,e.color,e.pointShape,i,t),ge(f,e.color,e.pointShape,i,t,r,l)})),!1!==t.dataLabel&&1===o&&e.forEach((function(e,r){let l,c,h;l=[].concat(t.chartData.yAxisData.ranges[e.index]),c=l.pop(),h=l.shift(),me(re(e.data,c,h,n,s,t,a,o),e,a,i,t)})),i.restore(),{xAxisPoints:n,calPoints:h,eachSpacing:s}}(r,t,a,i,e),n=o.xAxisPoints,s=o.calPoints,c=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=s,t.chartData.eachSpacing=c,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"ring":case"pie":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),t.chartData.pieData=Le(r,t,a,i,e),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"rose":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),t.chartData.pieData=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=N({},{type:"area",activeOpacity:.5,activeRadius:10,offsetAngle:0,labelWidth:15,border:!1,borderWidth:2,borderColor:"#FFFFFF",linearType:"none",customColor:[]},t.extra.rose);0==a.pieChartLinePadding&&(a.pieChartLinePadding=r.activeRadius*t.pix);var l={x:t.area[3]+(t.width-t.area[1]-t.area[3])/2,y:t.area[0]+(t.height-t.area[0]-t.area[2])/2},n=Math.min((t.width-t.area[1]-t.area[3])/2-a.pieChartLinePadding-a.pieChartTextPadding-a._pieTextMaxLength_,(t.height-t.area[0]-t.area[2])/2-a.pieChartLinePadding-a.pieChartTextPadding);n=n<10?10:n;var s=r.minRadius||.5*n;n<s&&(n=s+10),e=te(e,r.type,s,n,o);var c=r.activeRadius*t.pix;return r.customColor=W(r.linearType,r.customColor,e,a),(e=e.map((function(e){return e._start_+=(r.offsetAngle||0)*Math.PI/180,e}))).forEach((function(e,a){t.tooltip&&t.tooltip.index==a&&(i.beginPath(),i.setFillStyle(L(e.color,r.activeOpacity||.5)),i.moveTo(l.x,l.y),i.arc(l.x,l.y,c+e._radius_,e._start_,e._start_+2*e._rose_proportion_*Math.PI),i.closePath(),i.fill()),i.beginPath(),i.setLineWidth(r.borderWidth*t.pix),i.lineJoin="round",i.setStrokeStyle(r.borderColor);var o,n=e.color;"custom"==r.linearType&&((o=i.createCircularGradient?i.createCircularGradient(l.x,l.y,e._radius_):i.createRadialGradient(l.x,l.y,0,l.x,l.y,e._radius_)).addColorStop(0,L(r.customColor[e.linearIndex],1)),o.addColorStop(1,L(e.color,1)),n=o),i.setFillStyle(n),i.moveTo(l.x,l.y),i.arc(l.x,l.y,e._radius_,e._start_,e._start_+2*e._rose_proportion_*Math.PI),i.closePath(),i.fill(),1==r.border&&i.stroke()})),!1!==t.dataLabel&&1===o&&be(e,t,a,i,0,l),{center:l,radius:n,series:e}}(r,t,a,i,e),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"radar":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),t.chartData.radarData=Ve(r,t,a,i,e),Me(t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"arcbar":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),t.chartData.arcbarData=function(e,t,a,i){var o,r,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=N({},{startAngle:.75,endAngle:.25,type:"default",direction:"cw",lineCap:"round",width:12,gap:2,linearType:"none",customColor:[]},t.extra.arcbar);e=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;1==a&&(a=.999999);for(let i=0;i<e.length;i++){let o,r=e[i];r.data=null===r.data?0:r.data,o="circle"==t.type?2:"ccw"==t.direction?t.startAngle<t.endAngle?2+t.startAngle-t.endAngle:t.startAngle-t.endAngle:t.endAngle<t.startAngle?2+t.endAngle-t.startAngle:t.startAngle-t.endAngle,r._proportion_=o*r.data*a+t.startAngle,"ccw"==t.direction&&(r._proportion_=t.startAngle-o*r.data*a),r._proportion_>=2&&(r._proportion_=r._proportion_%2)}return e}(e,n,l),o=n.centerX||n.centerY?{x:n.centerX?n.centerX:t.width/2,y:n.centerY?n.centerY:t.height/2}:{x:t.width/2,y:t.height/2},n.radius?r=n.radius:(r=Math.min(o.x,o.y),r-=5*t.pix,r-=n.width/2),r=r<10?10:r,n.customColor=W(n.linearType,n.customColor,e,a);for(let h=0;h<e.length;h++){let a=e[h];i.setLineWidth(n.width*t.pix),i.setStrokeStyle(n.backgroundColor||"#E9E9E9"),i.setLineCap(n.lineCap),i.beginPath(),"default"==n.type?i.arc(o.x,o.y,r-(n.width*t.pix+n.gap*t.pix)*h,n.startAngle*Math.PI,n.endAngle*Math.PI,"ccw"==n.direction):i.arc(o.x,o.y,r-(n.width*t.pix+n.gap*t.pix)*h,0,2*Math.PI,"ccw"==n.direction),i.stroke();var s=a.color;if("custom"==n.linearType){var c=i.createLinearGradient(o.x-r,o.y,o.x+r,o.y);c.addColorStop(1,L(n.customColor[a.linearIndex],1)),c.addColorStop(0,L(a.color,1)),s=c}i.setLineWidth(n.width*t.pix),i.setStrokeStyle(s),i.setLineCap(n.lineCap),i.beginPath(),i.arc(o.x,o.y,r-(n.width*t.pix+n.gap*t.pix)*h,n.startAngle*Math.PI,a._proportion_*Math.PI,"ccw"==n.direction),i.stroke()}return fe(t,a,i,o),{center:o,radius:r,series:e}}(r,t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"gauge":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),t.chartData.gaugeData=Fe(l,r,t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}});break;case"candle":this.animationInstance=new He({timing:t.timing,duration:n,onProcess:function(e){i.clearRect(0,0,t.width,t.height),t.rotate&&pe(i,t),De(0,t,0,i),_e(l,t,a,i);var o=Pe(r,s,t,a,i,e),n=o.xAxisPoints,c=o.calPoints,h=o.eachSpacing;t.chartData.xAxisPoints=n,t.chartData.calPoints=c,t.chartData.eachSpacing=h,Ne(0,t,a,i),!1!==t.enableMarkLine&&1===e&&we(t,0,i),Me(s?0:t.series,t,a,i,t.chartData),Ee(t,a,i,e),Xe(0,i)},onAnimationFinish:function(){o.uevent.trigger("renderComplete")}})}}function je(){this.events={}}He.prototype.stop=function(){this.isStop=!0},je.prototype.addEventListener=function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},je.prototype.delEventListener=function(e){this.events[e]=[]},je.prototype.trigger=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];var i=t[0],o=t.slice(1);this.events[i]&&this.events[i].forEach((function(e){try{e.apply(null,o)}catch(t){}}))};var Ye=function(e){e.pix=e.pixelRatio?e.pixelRatio:1,e.fontSize=e.fontSize?e.fontSize:13,e.fontColor=e.fontColor?e.fontColor:D.fontColor,""!=e.background&&"none"!=e.background||(e.background="#FFFFFF"),e.title=N({},e.title),e.subtitle=N({},e.subtitle),e.duration=e.duration?e.duration:1e3,e.yAxis=N({},{data:[],showTitle:!1,disabled:!1,disableGrid:!1,gridSet:"number",splitNumber:5,gridType:"solid",dashLength:4*e.pix,gridColor:"#cccccc",padding:10,fontColor:"#666666"},e.yAxis),e.xAxis=N({},{rotateLabel:!1,rotateAngle:45,disabled:!1,disableGrid:!1,splitNumber:5,calibration:!1,fontColor:"#666666",fontSize:13,lineHeight:20,marginTop:0,gridType:"solid",dashLength:4,scrollAlign:"left",boundaryGap:"center",axisLine:!0,axisLineColor:"#cccccc",titleFontSize:13,titleOffsetY:0,titleOffsetX:0,titleFontColor:"#666666"},e.xAxis),e.xAxis.scrollPosition=e.xAxis.scrollAlign,e.legend=N({},{show:!0,position:"bottom",float:"center",backgroundColor:"rgba(0,0,0,0)",borderColor:"rgba(0,0,0,0)",borderWidth:0,padding:5,margin:5,itemGap:10,fontSize:e.fontSize,lineHeight:e.fontSize,fontColor:e.fontColor,formatter:{},hiddenColor:"#CECECE"},e.legend),e.extra=N({tooltip:{legendShape:"auto"}},e.extra),e.rotate=!!e.rotate,e.animation=!!e.animation,e.rotate=!!e.rotate,e.canvas2d=!!e.canvas2d;let t=N({},D);if(t.color=e.color?e.color:t.color,"pie"==e.type&&(t.pieChartLinePadding=!1===e.dataLabel?0:e.extra.pie.labelWidth*e.pix||t.pieChartLinePadding*e.pix),"ring"==e.type&&(t.pieChartLinePadding=!1===e.dataLabel?0:e.extra.ring.labelWidth*e.pix||t.pieChartLinePadding*e.pix),"rose"==e.type&&(t.pieChartLinePadding=!1===e.dataLabel?0:e.extra.rose.labelWidth*e.pix||t.pieChartLinePadding*e.pix),t.pieChartTextPadding=!1===e.dataLabel?0:t.pieChartTextPadding*e.pix,t.rotate=e.rotate,e.rotate){let t=e.width,a=e.height;e.width=a,e.height=t}if(e.padding=e.padding?e.padding:t.padding,t.yAxisWidth=D.yAxisWidth*e.pix,t.fontSize=e.fontSize*e.pix,t.titleFontSize=D.titleFontSize*e.pix,t.subtitleFontSize=D.subtitleFontSize*e.pix,!e.context)throw new Error("[uCharts] 未获取到context！注意：v2.0版本后，需要自行获取canvas的绘图上下文并传入opts.context！");this.context=e.context,this.context.setTextAlign||(this.context.setStrokeStyle=function(e){return this.strokeStyle=e},this.context.setLineWidth=function(e){return this.lineWidth=e},this.context.setLineCap=function(e){return this.lineCap=e},this.context.setFontSize=function(e){return this.font=e+"px sans-serif"},this.context.setFillStyle=function(e){return this.fillStyle=e},this.context.setTextAlign=function(e){return this.textAlign=e},this.context.setTextBaseline=function(e){return this.textBaseline=e},this.context.setShadow=function(e,t,a,i){this.shadowColor=i,this.shadowOffsetX=e,this.shadowOffsetY=t,this.shadowBlur=a},this.context.draw=function(){}),this.context.setLineDash||(this.context.setLineDash=function(e){}),e.chartData={},this.uevent=new je,this.scrollOption={currentOffset:0,startTouchX:0,distance:0,lastMoveTime:0},this.opts=e,this.config=t,qe.call(this,e.type,e,t,this.context)};Ye.prototype.updateData=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(this.opts=N({},this.opts,e),this.opts.updateData=!0,e.scrollPosition||"current"){case"current":this.opts._scrollDistance_=this.scrollOption.currentOffset;break;case"left":this.opts._scrollDistance_=0,this.scrollOption={currentOffset:0,startTouchX:0,distance:0,lastMoveTime:0};break;case"right":let e=ue(this.opts.series,this.opts,this.config,this.context).yAxisWidth;this.config.yAxisWidth=e;let t=0,a=oe(this.opts.categories,this.opts,this.config),i=a.xAxisPoints,o=a.startX;t=a.endX-o-a.eachSpacing*(i.length-1),this.scrollOption={currentOffset:t,startTouchX:t,distance:0,lastMoveTime:0},this.opts._scrollDistance_=t}qe.call(this,this.opts.type,this.opts,this.config,this.context)},Ye.prototype.zoom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.opts.xAxis.itemCount;if(!0!==this.opts.enableScroll)return void console.log("[uCharts] 请启用滚动条后使用");let t=Math.round(Math.abs(this.scrollOption.currentOffset)/this.opts.chartData.eachSpacing)+Math.round(this.opts.xAxis.itemCount/2);this.opts.animation=!1,this.opts.xAxis.itemCount=e.itemCount;let a=ue(this.opts.series,this.opts,this.config,this.context).yAxisWidth;this.config.yAxisWidth=a;let i=0,o=oe(this.opts.categories,this.opts,this.config),r=o.xAxisPoints,l=o.startX,n=o.endX,s=o.eachSpacing,c=s*t,h=n-l,d=h-s*(r.length-1);i=h/2-c,i>0&&(i=0),i<d&&(i=d),this.scrollOption={currentOffset:i,startTouchX:0,distance:0,lastMoveTime:0},V(this,i,this.opts.chartData,this.config,this.opts),this.opts._scrollDistance_=i,qe.call(this,this.opts.type,this.opts,this.config,this.context)},Ye.prototype.dobuleZoom=function(e){if(!0!==this.opts.enableScroll)return void console.log("[uCharts] 请启用滚动条后使用");const t=e.changedTouches;if(t.length<2)return;for(var a=0;a<t.length;a++)t[a].x=t[a].x?t[a].x:t[a].clientX,t[a].y=t[a].y?t[a].y:t[a].clientY;const i=[U(t[0],this.opts,e),U(t[1],this.opts,e)],o=Math.abs(i[0].x-i[1].x);if(!this.scrollOption.moveCount){let e={changedTouches:[{x:t[0].x,y:this.opts.area[0]/this.opts.pix+2}]},a={changedTouches:[{x:t[1].x,y:this.opts.area[0]/this.opts.pix+2}]};this.opts.rotate&&(e={changedTouches:[{x:this.opts.height/this.opts.pix-this.opts.area[0]/this.opts.pix-2,y:t[0].y}]},a={changedTouches:[{x:this.opts.height/this.opts.pix-this.opts.area[0]/this.opts.pix-2,y:t[1].y}]});const i=this.getCurrentDataIndex(e).index,o=this.getCurrentDataIndex(a).index,r=Math.abs(i-o);return this.scrollOption.moveCount=r,this.scrollOption.moveCurrent1=Math.min(i,o),void(this.scrollOption.moveCurrent2=Math.max(i,o))}let r=o/this.scrollOption.moveCount,l=(this.opts.width-this.opts.area[1]-this.opts.area[3])/r;l=l<=2?2:l,l=l>=this.opts.categories.length?this.opts.categories.length:l,this.opts.animation=!1,this.opts.xAxis.itemCount=l;let n=0,s=oe(this.opts.categories,this.opts,this.config),c=s.xAxisPoints,h=s.startX,d=s.endX,u=s.eachSpacing,p=u*this.scrollOption.moveCurrent1,x=d-h-u*(c.length-1);n=-p+Math.min(i[0].x,i[1].x)-this.opts.area[3]-u,n>0&&(n=0),n<x&&(n=x),this.scrollOption.currentOffset=n,this.scrollOption.startTouchX=0,this.scrollOption.distance=0,V(this,n,this.opts.chartData,this.config,this.opts),this.opts._scrollDistance_=n,qe.call(this,this.opts.type,this.opts,this.config,this.context)},Ye.prototype.stopAnimation=function(){this.animationInstance&&this.animationInstance.stop()},Ye.prototype.addEventListener=function(e,t){this.uevent.addEventListener(e,t)},Ye.prototype.delEventListener=function(e){this.uevent.delEventListener(e)},Ye.prototype.getCurrentDataIndex=function(e){var t=null;if(t=e.changedTouches?e.changedTouches[0]:e.mp.changedTouches[0]){let a=U(t,this.opts,e);return"pie"===this.opts.type||"ring"===this.opts.type?function(e,t,a){var i=-1,o=ee(t.series);if(t&&t.center&&Z(e,t.center,t.radius)){var r=Math.atan2(t.center.y-e.y,e.x-t.center.x);r=-r,a.extra.pie&&a.extra.pie.offsetAngle&&(r-=a.extra.pie.offsetAngle*Math.PI/180),a.extra.ring&&a.extra.ring.offsetAngle&&(r-=a.extra.ring.offsetAngle*Math.PI/180);for(var l=0,n=o.length;l<n;l++)if(I(r,o[l]._start_,o[l]._start_+2*o[l]._proportion_*Math.PI)){i=l;break}}return i}({x:a.x,y:a.y},this.opts.chartData.pieData,this.opts):"rose"===this.opts.type?function(e,t,a){var i=-1,o=te(a._series_,a.extra.rose.type,t.radius,t.radius);if(t&&t.center&&Z(e,t.center,t.radius)){var r=Math.atan2(t.center.y-e.y,e.x-t.center.x);r=-r,a.extra.rose&&a.extra.rose.offsetAngle&&(r-=a.extra.rose.offsetAngle*Math.PI/180);for(var l=0,n=o.length;l<n;l++)if(I(r,o[l]._start_,o[l]._start_+2*o[l]._rose_proportion_*Math.PI)){i=l;break}}return i}({x:a.x,y:a.y},this.opts.chartData.pieData,this.opts):"radar"===this.opts.type?function(e,t,a){var i=2*Math.PI/a,o=-1;if(Z(e,t.center,t.radius)){var r=function(e){return e<0&&(e+=2*Math.PI),e>2*Math.PI&&(e-=2*Math.PI),e},l=Math.atan2(t.center.y-e.y,e.x-t.center.x);(l*=-1)<0&&(l+=2*Math.PI),t.angleList.map((function(e){return r(-1*e)})).forEach((function(e,t){var a=r(e-i/2),n=r(e+i/2);n<a&&(n+=2*Math.PI),(l>=a&&l<=n||l+2*Math.PI>=a&&l+2*Math.PI<=n)&&(o=t)}))}return o}({x:a.x,y:a.y},this.opts.chartData.radarData,this.opts.categories.length):"funnel"===this.opts.type?function(e,t){for(var a=-1,i=0,o=t.series.length;i<o;i++){var r=t.series[i];if(e.x>r.funnelArea[0]&&e.x<r.funnelArea[2]&&e.y>r.funnelArea[1]&&e.y<r.funnelArea[3]){a=i;break}}return a}({x:a.x,y:a.y},this.opts.chartData.funnelData):"map"===this.opts.type?function(e,t){for(var a,i,o,r,l,n,s=-1,c=t.chartData.mapData,h=t.series,d=(a=e.y,i=e.x,o=c.bounds,r=c.scale,l=c.xoffset,n=c.yoffset,{x:(i-l)/r+o.xMin,y:o.yMax-(a-n)/r}),u=[d.x,d.y],p=0,x=h.length;p<x;p++)if(Oe(u,h[p].geometry.coordinates,t.chartData.mapData.mercator)){s=p;break}return s}({x:a.x,y:a.y},this.opts):"word"===this.opts.type?function(e,t){for(var a=-1,i=0,o=t.length;i<o;i++){var r=t[i];if(e.x>r.area[0]&&e.x<r.area[2]&&e.y>r.area[1]&&e.y<r.area[3]){a=i;break}}return a}({x:a.x,y:a.y},this.opts.chartData.wordCloudData):"bar"===this.opts.type?function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r={index:-1,group:[]},l=a.chartData.eachSpacing/2;let n=a.chartData.yAxisPoints;return t&&t.length>0&&Y(e,a)&&n.forEach((function(t,a){e.y+o+l>t&&(r.index=a)})),r}({x:a.x,y:a.y},this.opts.chartData.calPoints,this.opts,this.config,Math.abs(this.scrollOption.currentOffset)):function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r={index:-1,group:[]},l=a.chartData.eachSpacing/2;let n=[];if(t&&t.length>0){if(a.categories){for(let e=1;e<a.chartData.xAxisPoints.length;e++)n.push(a.chartData.xAxisPoints[e]-l);"line"!=a.type&&"area"!=a.type||"justify"!=a.xAxis.boundaryGap||(n=a.chartData.xAxisPoints)}else l=0;if(Y(e,a))if(a.categories)n.forEach((function(t,a){e.x+o+l>t&&(r.index=a)}));else{let a=Array(t.length);for(let r=0;r<t.length;r++){a[r]=Array(t[r].length);for(let i=0;i<t[r].length;i++)a[r][i]=Math.abs(t[r][i].x-e.x)}let i=Array(a.length),o=Array(a.length);for(let e=0;e<a.length;e++)i[e]=Math.min.apply(null,a[e]),o[e]=a[e].indexOf(i[e]);let l=Math.min.apply(null,i);r.index=[];for(let e=0;e<i.length;e++)i[e]==l&&(r.group.push(e),r.index.push(o[e]))}}return r}({x:a.x,y:a.y},this.opts.chartData.calPoints,this.opts,this.config,Math.abs(this.scrollOption.currentOffset))}return-1},Ye.prototype.getLegendDataIndex=function(e){var t=null;if(t=e.changedTouches?e.changedTouches[0]:e.mp.changedTouches[0]){let a=U(t,this.opts,e);return function(e,t){let a=-1;if(function(e,t){return e.x>t.start.x&&e.x<t.end.x&&e.y>t.start.y&&e.y<t.end.y}(e,t.area)){let i=t.points,o=-1;for(let t=0,r=i.length;t<r;t++){let r=i[t];for(let t=0;t<r.length;t++){o+=1;let i=r[t].area;if(i&&e.x>i[0]-0&&e.x<i[2]+0&&e.y>i[1]-0&&e.y<i[3]+0){a=o;break}}}return a}return a}({x:a.x,y:a.y},this.opts.chartData.legendData)}return-1},Ye.prototype.touchLegend=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null;if(a=e.changedTouches?e.changedTouches[0]:e.mp.changedTouches[0]){U(a,this.opts,e);var i=this.getLegendDataIndex(e);i>=0&&("candle"==this.opts.type?this.opts.seriesMA[i].show=!this.opts.seriesMA[i].show:this.opts.series[i].show=!this.opts.series[i].show,this.opts.animation=!!t.animation,this.opts._scrollDistance_=this.scrollOption.currentOffset,qe.call(this,this.opts.type,this.opts,this.config,this.context))}},Ye.prototype.showToolTip=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null;(a=e.changedTouches?e.changedTouches[0]:e.mp.changedTouches[0])||console.log("[uCharts] 未获取到event坐标信息");var i=U(a,this.opts,e),o=this.scrollOption.currentOffset,r=N({},this.opts,{_scrollDistance_:o,animation:!1});if("line"===this.opts.type||"area"===this.opts.type||"column"===this.opts.type||"scatter"===this.opts.type||"bubble"===this.opts.type){var l=this.getCurrentDataIndex(e);if((u=null==t.index?l.index:t.index)>-1||u.length>0)if(0!==(s=H(this.opts.series,u,l.group)).length){var n=(d=q(s,this.opts,u,l.group,this.opts.categories,t)).textList;(c=d.offset).y=i.y,r.tooltip={textList:void 0!==t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u,group:l.group}}qe.call(this,r.type,r,this.config,this.context)}if("mount"===this.opts.type){if((u=null==t.index?this.getCurrentDataIndex(e).index:t.index)>-1){r=N({},this.opts,{animation:!1});var s=N({},r._series_[u]),c=(n=[{text:t.formatter?t.formatter(s,void 0,u,r):s.name+": "+s.data,color:s.color,legendShape:"auto"==this.opts.extra.tooltip.legendShape?s.legendShape:this.opts.extra.tooltip.legendShape}],{x:r.chartData.calPoints[u].x,y:i.y});r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}qe.call(this,r.type,r,this.config,this.context)}if("bar"===this.opts.type){l=this.getCurrentDataIndex(e);if((u=null==t.index?l.index:t.index)>-1||u.length>0)if(0!==(s=H(this.opts.series,u,l.group)).length){n=(d=q(s,this.opts,u,l.group,this.opts.categories,t)).textList;(c=d.offset).x=i.x,r.tooltip={textList:void 0!==t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}qe.call(this,r.type,r,this.config,this.context)}if("mix"===this.opts.type){l=this.getCurrentDataIndex(e);if((u=null==t.index?l.index:t.index)>-1){o=this.scrollOption.currentOffset,r=N({},this.opts,{_scrollDistance_:o,animation:!1});if(0!==(s=H(this.opts.series,u)).length){var h=function(e,t,a,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},r=t.chartData.xAxisPoints[a]+t.chartData.eachSpacing/2,l=e.map((function(e){return{text:o.formatter?o.formatter(e,i[a],a,t):e.name+": "+e.data,color:e.color,disableLegend:!!e.disableLegend,legendShape:"auto"==t.extra.tooltip.legendShape?e.legendShape:t.extra.tooltip.legendShape}}));return{textList:l=l.filter((function(e){if(!0!==e.disableLegend)return e})),offset:{x:Math.round(r),y:0}}}(s,this.opts,u,this.opts.categories,t);n=h.textList;(c=h.offset).y=i.y,r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}}qe.call(this,r.type,r,this.config,this.context)}if("candle"===this.opts.type){l=this.getCurrentDataIndex(e);if((u=null==t.index?l.index:t.index)>-1){o=this.scrollOption.currentOffset,r=N({},this.opts,{_scrollDistance_:o,animation:!1});if(0!==(s=H(this.opts.series,u)).length){var d=function(e,t,a,i,o,r){var l=a.chartData.calPoints;let n=r.color.upFill,s=r.color.downFill,c=[n,n,s,n];var h=[];t.map((function(t){0==i?t.data[1]-t.data[0]<0?c[1]=s:c[1]=n:(t.data[0]<e[i-1][1]&&(c[0]=s),t.data[1]<t.data[0]&&(c[1]=s),t.data[2]>e[i-1][1]&&(c[2]=n),t.data[3]<e[i-1][1]&&(c[3]=s));let o={text:"开盘："+t.data[0],color:c[0],legendShape:"auto"==a.extra.tooltip.legendShape?t.legendShape:a.extra.tooltip.legendShape},r={text:"收盘："+t.data[1],color:c[1],legendShape:"auto"==a.extra.tooltip.legendShape?t.legendShape:a.extra.tooltip.legendShape},l={text:"最低："+t.data[2],color:c[2],legendShape:"auto"==a.extra.tooltip.legendShape?t.legendShape:a.extra.tooltip.legendShape},d={text:"最高："+t.data[3],color:c[3],legendShape:"auto"==a.extra.tooltip.legendShape?t.legendShape:a.extra.tooltip.legendShape};h.push(o,r,l,d)}));var d=[],u={x:0,y:0};for(let p=0;p<l.length;p++){let e=l[p];void 0!==e[i]&&null!==e[i]&&d.push(e[i])}return u.x=Math.round(d[0][0].x),{textList:h,offset:u}}(this.opts.series[0].data,s,this.opts,u,this.opts.categories,this.opts.extra.candle);n=d.textList;(c=d.offset).y=i.y,r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}}qe.call(this,r.type,r,this.config,this.context)}if("pie"===this.opts.type||"ring"===this.opts.type||"rose"===this.opts.type||"funnel"===this.opts.type){if((u=null==t.index?this.getCurrentDataIndex(e):t.index)>-1){r=N({},this.opts,{animation:!1}),s=N({},r._series_[u]),n=[{text:t.formatter?t.formatter(s,void 0,u,r):s.name+": "+s.data,color:s.color,legendShape:"auto"==this.opts.extra.tooltip.legendShape?s.legendShape:this.opts.extra.tooltip.legendShape}],c={x:i.x,y:i.y};r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}qe.call(this,r.type,r,this.config,this.context)}if("map"===this.opts.type){if((u=null==t.index?this.getCurrentDataIndex(e):t.index)>-1){r=N({},this.opts,{animation:!1});(s=N({},this.opts.series[u])).name=s.properties.name;n=[{text:t.formatter?t.formatter(s,void 0,u,this.opts):s.name,color:s.color,legendShape:"auto"==this.opts.extra.tooltip.legendShape?s.legendShape:this.opts.extra.tooltip.legendShape}],c={x:i.x,y:i.y};r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}r.updateData=!1,qe.call(this,r.type,r,this.config,this.context)}if("word"===this.opts.type){if((u=null==t.index?this.getCurrentDataIndex(e):t.index)>-1){r=N({},this.opts,{animation:!1}),s=N({},this.opts.series[u]),n=[{text:t.formatter?t.formatter(s,void 0,u,this.opts):s.name,color:s.color,legendShape:"auto"==this.opts.extra.tooltip.legendShape?s.legendShape:this.opts.extra.tooltip.legendShape}],c={x:i.x,y:i.y};r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}r.updateData=!1,qe.call(this,r.type,r,this.config,this.context)}if("radar"===this.opts.type){var u;if((u=null==t.index?this.getCurrentDataIndex(e):t.index)>-1){r=N({},this.opts,{animation:!1});if(0!==(s=H(this.opts.series,u)).length){n=s.map((e=>({text:t.formatter?t.formatter(e,this.opts.categories[u],u,this.opts):e.name+": "+e.data,color:e.color,legendShape:"auto"==this.opts.extra.tooltip.legendShape?e.legendShape:this.opts.extra.tooltip.legendShape}))),c={x:i.x,y:i.y};r.tooltip={textList:t.textList?t.textList:n,offset:void 0!==t.offset?t.offset:c,option:t,index:u}}}qe.call(this,r.type,r,this.config,this.context)}},Ye.prototype.translate=function(e){this.scrollOption={currentOffset:e,startTouchX:e,distance:0,lastMoveTime:0};let t=N({},this.opts,{_scrollDistance_:e,animation:!1});qe.call(this,this.opts.type,t,this.config,this.context)},Ye.prototype.scrollStart=function(e){var t=null,a=U(t=e.changedTouches?e.changedTouches[0]:e.mp.changedTouches[0],this.opts,e);t&&!0===this.opts.enableScroll&&(this.scrollOption.startTouchX=a.x)},Ye.prototype.scroll=function(e){0===this.scrollOption.lastMoveTime&&(this.scrollOption.lastMoveTime=Date.now());let t=this.opts.touchMoveLimit||60,a=Date.now();if(!(a-this.scrollOption.lastMoveTime<Math.floor(1e3/t))&&0!=this.scrollOption.startTouchX){this.scrollOption.lastMoveTime=a;var i=null;if((i=e.changedTouches?e.changedTouches[0]:e.mp.changedTouches[0])&&!0===this.opts.enableScroll){var o;o=U(i,this.opts,e).x-this.scrollOption.startTouchX;var r=this.scrollOption.currentOffset,l=V(this,r+o,this.opts.chartData,this.config,this.opts);this.scrollOption.distance=o=l-r;var n=N({},this.opts,{_scrollDistance_:r+o,animation:!1});return this.opts=n,qe.call(this,n.type,n,this.config,this.context),r+o}}},Ye.prototype.scrollEnd=function(e){if(!0===this.opts.enableScroll){var t=this.scrollOption,a=t.currentOffset,i=t.distance;this.scrollOption.currentOffset=a+i,this.scrollOption.distance=0,this.scrollOption.moveCount=0}};const Ze={__name:"data1",setup(a){let i=null,o=null;const l=e.ref("line"),n=e.ref({}),s=e.ref({}),c=e.ref([]),h=e.ref([]),d=e.ref(-1),u=e.ref(null),p=e=>{o.touchLegend(e),o.showToolTip(e)},x=e=>{d.value=Number(e.detail.value);const a=h.value[d.value];a&&(u.value=a.number,t("log","at pages/data1.vue:209","选中设备ID:",u.value),g())},g=async()=>{try{const e={};u.value&&(e.deviceId=u.value);const t=await uni.request({url:E.API_BASE_URL+"/api/data1",method:"GET",data:e});if(200===t.statusCode){const{header:e,units:a,data:i}=t.data;if(c.value=a,i&&i.length>0){const t=i[0];s.value={},n.value={d_no:t.d_no,time:t["创建时间"],data_type:t.data_type},e.forEach(((e,a)=>{"创建时间"!==e&&"设备ID"!==e&&(s.value[e]=t[e])}))}}}catch(e){t("error","at pages/data1.vue:248","获取传感器数据失败:",e)}},f=async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/data2",method:"GET"});if(200===e.statusCode){const{data:t}=e.data,a=[...t].reverse(),i=a.map((e=>e.c_time));((e,t)=>{o=new Ye({type:l.value,context:uni.createCanvasContext("dataChart"),width:uni.upx2px(700),height:300,categories:e,series:t,animation:!0,background:"#FFFFFF",padding:[15,15,0,15],legend:{show:!0,position:"top",float:"center"},xAxis:{disableGrid:!0,scrollShow:!0,itemCount:5,rotateLabel:!0},yAxis:{gridType:"dash",splitNumber:5,min:0,max:200,data:[{min:0,max:200,title:"数值",titleFontSize:12}],calibration:!0,disabled:!1,disableGrid:!1},extra:{line:{type:"curve",width:2},column:{width:20,activeBgColor:"#000000",activeBgOpacity:.1}}})})(i,[{name:"烟雾浓度",data:a.map((e=>e["烟雾浓度"])),color:"#1890FF"},{name:"空气温度",data:a.map((e=>e["空气温度"])),color:"#91CB74"},{name:"水位",data:a.map((e=>e["水位"])),color:"#FAC858"}])}}catch(e){t("error","at pages/data1.vue:285","获取图表数据失败:",e)}},m=e=>{l.value=e,f()},y=()=>{i&&(clearInterval(i),i=null)};return e.onMounted((()=>{(async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/allDevices",method:"GET"});200===e.statusCode&&e.data.data&&(h.value=e.data.data)}catch(e){t("error","at pages/data1.vue:198","获取设备列表失败:",e),h.value=[]}})(),g(),f(),y(),i=setInterval((()=>{g(),f()}),3e3)})),r((()=>{y()})),(t,a)=>{var i;return e.openBlock(),e.createElementBlock("view",{class:"data-container"},[e.createElementVNode("view",{class:"device-selector"},[e.createElementVNode("view",{class:"selector-label"},"选择场景："),e.createElementVNode("picker",{mode:"selector",range:h.value,value:d.value,"range-key":"device_name",onChange:x,class:"device-picker"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(-1===d.value?"请选择场景":null==(i=h.value[d.value])?void 0:i.device_name),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"data-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"title"},"传感器数据"),e.createElementVNode("text",{class:"time"},e.toDisplayString(n.value.time||"暂无数据"),1)]),e.createElementVNode("view",{class:"data-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,((t,a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"data-item"},[e.createElementVNode("text",{class:"label"},e.toDisplayString(a)+"("+e.toDisplayString(c.value[i])+")",1),e.createElementVNode("text",{class:"value"},e.toDisplayString(t),1)])))),128))])]),e.createElementVNode("view",{class:"chart-control"},[e.createElementVNode("view",{class:"chart-type-selector"},[e.createElementVNode("text",{class:"label"},"图表类型："),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{class:e.normalizeClass(["type-btn","line"===l.value?"active":""]),onClick:a[0]||(a[0]=e=>m("line"))},"曲线图",2),e.createElementVNode("button",{class:e.normalizeClass(["type-btn","column"===l.value?"active":""]),onClick:a[1]||(a[1]=e=>m("column"))},"柱状图",2)])])]),e.createElementVNode("view",{class:"chart-card"},[e.createElementVNode("view",{class:"charts-box"},[e.createElementVNode("canvas",{"canvas-id":"dataChart",id:"dataChart",class:"charts",onTouchstart:p},null,32)])])])}}},Je={__name:"data2",setup(a){let i=null;const o=e.ref("line"),r=e.ref([]),l=e.ref([]),n=e.ref([]),s=e.ref(1),c=e.ref(5),h=e.ref(0),d=e.ref([]),u=e.ref(-1),p=e.ref(null),x=e.ref(""),g=e.ref(""),f=e.ref(""),m=e.ref(""),y=e.ref([]),v=e.ref(1),b=e.ref(5),w=e.ref(0),S=e.ref([]),A=e.ref(-1),T=e.ref(null),k=e.ref(""),C=e.ref(""),P=e.ref(""),_=e.ref(""),D=e=>{i.touchLegend(e),i.showToolTip(e)},N=e=>{u.value=Number(e.detail.value);const t=d.value[u.value];t&&(p.value=t.number,s.value=1,G())},M=e=>{A.value=Number(e.detail.value);const t=S.value[A.value];t&&(T.value=t.number,v.value=1,X())},L=e=>{x.value=e.detail.value},F=e=>{g.value=e.detail.value},V=e=>{f.value=e.detail.value},I=e=>{m.value=e.detail.value},B=e=>{k.value=e.detail.value},z=e=>{C.value=e.detail.value},O=e=>{P.value=e.detail.value},R=e=>{_.value=e.detail.value},W=()=>{x.value="",g.value="",f.value="",m.value=""},$=()=>{k.value="",C.value="",P.value="",_.value=""},G=async()=>{try{const e={page:s.value,pageSize:c.value};x.value&&g.value&&(e.startTime=`${x.value} ${g.value}:00`),f.value&&m.value&&(e.endTime=`${f.value} ${m.value}:00`),p.value&&(e.deviceId=p.value);const t=await uni.request({url:E.API_BASE_URL+"/api/data2",method:"GET",data:e});if(200===t.statusCode){const{data:e,header:a,units:i,total:o}=t.data;r.value=e,l.value=a,n.value=i,h.value=o||e.length,U(e)}}catch(e){t("error","at pages/data2.vue:440","获取传感器数据失败:",e)}},X=async()=>{try{const e={page:v.value,pageSize:b.value};k.value&&C.value&&(e.startTime=`${k.value} ${C.value}:00`),P.value&&_.value&&(e.endTime=`${P.value} ${_.value}:00`),T.value&&(e.sceneId=T.value);const t=await uni.request({url:E.API_BASE_URL+"/api/behaviorData",method:"GET",data:e});if(200===t.statusCode){const{data:e,total:a}=t.data;y.value=e,w.value=a}}catch(e){t("error","at pages/data2.vue:474","获取AI检测数据失败:",e)}},U=e=>{if(!e||0===e.length)return;const t=[...e].reverse();((e,t)=>{i=new Ye({type:o.value,context:uni.createCanvasContext("historyChart"),width:uni.upx2px(700),height:300,categories:e,series:t,animation:!0,background:"#FFFFFF",padding:[15,15,0,15],legend:{show:!0,position:"top",float:"center"},xAxis:{disableGrid:!0,scrollShow:!0,itemCount:5,rotateLabel:!0},yAxis:{gridType:"dash",splitNumber:5,min:0,max:200,calibration:!0},extra:{line:{type:"curve",width:2},column:{width:20,activeBgColor:"#000000",activeBgOpacity:.1}}})})(t.map((e=>e.c_time)),l.value.map(((e,a)=>({name:e,data:t.map((t=>t[e])),color:["#1890FF","#91CB74","#FAC858","#EE6666"][a%4]}))))},H=e=>{o.value=e,U(r.value)},q=()=>{s.value=1,G()},j=()=>{v.value=1,X()},Y=()=>{s.value>1&&(s.value--,G())},Z=()=>{s.value<Math.ceil(h.value/c.value)&&(s.value++,G())},J=()=>{v.value>1&&(v.value--,X())},K=()=>{v.value<Math.ceil(w.value/b.value)&&(v.value++,X())},Q=e=>{uni.previewImage({urls:[`${E.API_BASE_URL}/${e}`]})},ee=e=>{try{if(!e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}catch(a){return t("error","at pages/data2.vue:553","解析检测结果失败:",a),[]}};return e.onMounted((()=>{(async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/sceneIds",method:"GET"});200===e.statusCode&&e.data.data&&(d.value=e.data.data,S.value=e.data.data)}catch(e){t("error","at pages/data2.vue:330","获取设备列表失败:",e)}})(),G(),X()})),(t,a)=>{var i,p;return e.openBlock(),e.createElementBlock("view",{class:"data-container"},[e.createElementVNode("view",{class:"device-selector"},[e.createElementVNode("view",{class:"selector-label"},"选择场景："),e.createElementVNode("picker",{mode:"selector",range:d.value,value:u.value,"range-key":"device_name",onChange:N,class:"device-picker"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(-1===u.value?"请选择场景":null==(i=d.value[u.value])?void 0:i.device_name),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"time-selector"},[e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"开始时间："),e.createElementVNode("view",{class:"datetime-picker"},[e.createElementVNode("picker",{mode:"date",value:x.value,onChange:L,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(x.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:g.value,onChange:F,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(g.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])])]),e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"结束时间："),e.createElementVNode("view",{class:"datetime-picker"},[e.createElementVNode("picker",{mode:"date",value:f.value,onChange:V,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(f.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:m.value,onChange:I,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(m.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])])]),e.createElementVNode("view",{class:"button-container"},[e.createElementVNode("button",{class:"clear-btn",onClick:W},"清除时间"),e.createElementVNode("button",{class:"search-btn",onClick:q},"查询")])]),e.createElementVNode("view",{class:"chart-control"},[e.createElementVNode("view",{class:"chart-type-selector"},[e.createElementVNode("text",{class:"label"},"图表类型："),e.createElementVNode("view",{class:"button-group"},[e.createElementVNode("button",{class:e.normalizeClass(["type-btn","line"===o.value?"active":""]),onClick:a[0]||(a[0]=e=>H("line"))},"曲线图",2),e.createElementVNode("button",{class:e.normalizeClass(["type-btn","column"===o.value?"active":""]),onClick:a[1]||(a[1]=e=>H("column"))},"柱状图",2)])])]),e.createElementVNode("view",{class:"chart-card"},[e.createElementVNode("canvas",{"canvas-id":"historyChart",id:"historyChart",class:"charts",onTouchstart:D},null,32)]),e.createElementVNode("view",{class:"data-table"},[e.createElementVNode("view",{class:"table-header"},[e.createElementVNode("text",{class:"title"},"传感器历史数据")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"table-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"table-row"},[e.createElementVNode("view",{class:"row-header"},[e.createElementVNode("text",{class:"device-id"},"场景ID: "+e.toDisplayString(t.d_no),1),e.createElementVNode("text",{class:"time"},e.toDisplayString(t.c_time),1)]),e.createElementVNode("view",{class:"row-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(l.value,((a,i)=>(e.openBlock(),e.createElementBlock("view",{key:i,class:"data-row"},[e.createElementVNode("text",{class:"label"},e.toDisplayString(a)+"("+e.toDisplayString(n.value[i])+"):",1),e.createElementVNode("text",{class:"value"},e.toDisplayString(t[a]),1)])))),128))])])))),128))]),e.createElementVNode("view",{class:"pagination"},[e.createElementVNode("button",{disabled:s.value<=1,onClick:Y,class:"page-btn"},"上一页",8,["disabled"]),e.createElementVNode("text",{class:"page-info"},"第 "+e.toDisplayString(s.value)+" 页，共 "+e.toDisplayString(Math.ceil(h.value/c.value))+" 页",1),e.createElementVNode("button",{disabled:s.value>=Math.ceil(h.value/c.value),onClick:Z,class:"page-btn"},"下一页",8,["disabled"])])]),e.createElementVNode("view",{class:"ai-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"title"},"AI检测结果")]),e.createElementVNode("view",{class:"device-selector"},[e.createElementVNode("view",{class:"selector-label"},"选择机房："),e.createElementVNode("picker",{mode:"selector",range:S.value,value:A.value,"range-key":"device_name",onChange:M,class:"device-picker"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(-1===A.value?"请选择机房":null==(p=S.value[A.value])?void 0:p.device_name),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"time-selector"},[e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"开始时间："),e.createElementVNode("view",{class:"datetime-picker"},[e.createElementVNode("picker",{mode:"date",value:k.value,onChange:B,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(k.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:C.value,onChange:z,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(C.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])])]),e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"结束时间："),e.createElementVNode("view",{class:"datetime-picker"},[e.createElementVNode("picker",{mode:"date",value:P.value,onChange:O,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(P.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:_.value,onChange:R,class:"picker-item"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(_.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])])]),e.createElementVNode("view",{class:"button-container"},[e.createElementVNode("button",{class:"clear-btn",onClick:$},"清除时间"),e.createElementVNode("button",{class:"search-btn",onClick:j},"查询")])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"ai-results"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"ai-item"},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("text",{class:"room-id"},"机房编号: "+e.toDisplayString(t.d_no),1),e.createElementVNode("text",{class:"detection-time"},e.toDisplayString(t.c_time),1)]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"images-row"},[e.createElementVNode("view",{class:"image-item"},[e.createElementVNode("text",{class:"image-label"},"原始图像"),t["原始图像"]?(e.openBlock(),e.createElementBlock("image",{key:0,src:`${e.unref(E).API_BASE_URL}/${t["原始图像"]}`,class:"detection-image",mode:"aspectFit",onClick:e=>Q(t["原始图像"])},null,8,["src","onClick"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-image"},"无图片"))]),e.createElementVNode("view",{class:"image-item"},[e.createElementVNode("text",{class:"image-label"},"标注图像"),t["检测结果图"]?(e.openBlock(),e.createElementBlock("image",{key:0,src:`${e.unref(E).API_BASE_URL}/${t["检测结果图"]}`,class:"detection-image",mode:"aspectFit",onClick:e=>Q(t["检测结果图"])},null,8,["src","onClick"])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"no-image"},"无图片"))])]),e.createElementVNode("view",{class:"detection-info"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"label"},"检测数量:"),e.createElementVNode("text",{class:"count"},e.toDisplayString(t["目标数量"]||0),1)]),t["检测详情"]?(e.openBlock(),e.createElementBlock("view",{key:0,class:"info-row"},[e.createElementVNode("text",{class:"label"},"检测详情:"),e.createElementVNode("view",{class:"detection-details"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(ee(t["检测详情"]),((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"detail-tag"},e.toDisplayString(t.label)+": "+e.toDisplayString(t.confidence)+"% ",1)))),128))])])):e.createCommentVNode("",!0)])])])))),128))]),e.createElementVNode("view",{class:"pagination"},[e.createElementVNode("button",{disabled:v.value<=1,onClick:J,class:"page-btn"},"上一页",8,["disabled"]),e.createElementVNode("text",{class:"page-info"},"第 "+e.toDisplayString(v.value)+" 页，共 "+e.toDisplayString(Math.ceil(w.value/b.value))+" 页",1),e.createElementVNode("button",{disabled:v.value>=Math.ceil(w.value/b.value),onClick:K,class:"page-btn"},"下一页",8,["disabled"])])])])}}},Ke={__name:"error",setup(a){const i=e.ref([]),o=e.ref(0),r=e.ref(1),l=e.ref(5),n=e.ref([]),s=e.ref(-1),c=e.ref(null),h=e.ref(""),d=e.ref(""),u=e.ref(""),p=e.ref(""),x=async()=>{try{const e={page:r.value,pageSize:l.value};h.value&&d.value&&(e.startTime=`${h.value} ${d.value}:00`),u.value&&p.value&&(e.endTime=`${u.value} ${p.value}:00`),c.value&&(e.deviceId=c.value);const t=await uni.request({url:E.API_BASE_URL+"/api/error-messages",method:"GET",data:e});200===t.statusCode&&(i.value=t.data.data,o.value=t.data.total)}catch(e){t("error","at pages/error.vue:174","获取错误消息失败:",e),uni.showToast({title:"获取错误消息失败",icon:"none"})}},g=e=>{s.value=Number(e.detail.value);const t=n.value[s.value];t&&(c.value=t.number)},f=e=>{h.value=e.detail.value},m=e=>{d.value=e.detail.value},y=e=>{u.value=e.detail.value},v=e=>{p.value=e.detail.value},b=()=>{r.value=1,x()},w=()=>{r.value>1&&(r.value--,x())},S=()=>{r.value<Math.ceil(o.value/l.value)&&(r.value++,x())},A=e=>{if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}`};return e.onMounted((()=>{(async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/sceneIds",method:"GET"});200===e.statusCode&&e.data.data&&(n.value=e.data.data)}catch(e){t("error","at pages/error.vue:137","获取设备列表失败:",e),uni.showToast({title:"获取设备列表失败",icon:"none"})}})(),x()})),(t,a)=>{var c;return e.openBlock(),e.createElementBlock("view",{class:"error-container"},[e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-row"},[e.createElementVNode("view",{class:"filter-item"},[e.createElementVNode("text",{class:"filter-label"},"选择场景："),e.createElementVNode("picker",{mode:"selector",range:n.value,value:s.value,"range-key":"device_name",onChange:g,class:"filter-picker"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(-1===s.value?"请选择场景":null==(c=n.value[s.value])?void 0:c.device_name),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["range","value"])])]),e.createElementVNode("view",{class:"filter-row"},[e.createElementVNode("view",{class:"time-filter"},[e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"开始时间："),e.createElementVNode("picker",{mode:"date",value:h.value,onChange:f},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(h.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:d.value,onChange:m},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(d.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])]),e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"结束时间："),e.createElementVNode("picker",{mode:"date",value:u.value,onChange:y},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(u.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:p.value,onChange:v},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(p.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])])])]),e.createElementVNode("view",{class:"filter-actions"},[e.createElementVNode("button",{class:"query-btn",onClick:b},"查询")])]),e.createElementVNode("view",{class:"error-list"},[e.createElementVNode("view",{class:"list-header"},[e.createElementVNode("text",{class:"title"},"错误消息列表")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"list-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:"error-item"},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("view",{class:"error-info"},[e.createElementVNode("text",{class:"scene-id"},"场景ID: "+e.toDisplayString(t.d_no),1),e.createElementVNode("view",{class:e.normalizeClass(["error-type","1"===t.type?"warning":"error"])},e.toDisplayString("1"===t.type?"告警":"错误"),3)]),e.createElementVNode("view",{class:"time-info"},[e.createElementVNode("text",{class:"time"},e.toDisplayString(A(t.c_time)),1)])]),e.createElementVNode("view",{class:"item-content"},[e.createElementVNode("view",{class:"error-message"},[e.createElementVNode("text",{class:"message-label"},"错误信息:"),e.createElementVNode("text",{class:e.normalizeClass(["message-text","1"===t.type?"warning-text":"error-text"])},e.toDisplayString(t.e_msg),3)])])])))),128))]),e.createElementVNode("view",{class:"pagination"},[e.createElementVNode("button",{disabled:r.value<=1,onClick:w,class:"page-btn"},"上一页",8,["disabled"]),e.createElementVNode("text",{class:"page-info"},"第 "+e.toDisplayString(r.value)+" 页，共 "+e.toDisplayString(Math.ceil(o.value/l.value))+" 页",1),e.createElementVNode("button",{disabled:r.value>=Math.ceil(o.value/l.value),onClick:S,class:"page-btn"},"下一页",8,["disabled"])])])])}}},Qe={__name:"direct",setup(i){const o=e.ref([]),r=e.ref({}),l=e.ref({}),n=e.ref([]),s=e.ref(0),c=e.ref(1),h=e.ref(10),d=e.ref({targetName:""}),u=e.ref(""),p=e.ref(""),x=e.ref(""),g=e.ref(""),f=e.ref(null),m=async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/config",method:"GET"});if(200===e.statusCode){const t=e.data.data;o.value=t.filter((e=>"1"===e.mode)),o.value.forEach((e=>{"3"===e.f_type&&(r.value[e.id]=Number(e.direct_value)),l.value[e.id]=e.direct_value}))}}catch(e){t("error","at pages/direct.vue:227","获取配置失败:",e),uni.showToast({title:"获取配置失败",icon:"none"})}},y=async()=>{try{const e={page:c.value,pageSize:h.value};u.value&&p.value&&(e.startTime=`${u.value} ${p.value}:00`),x.value&&g.value&&(e.endTime=`${x.value} ${g.value}:00`),d.value.targetName&&(e.targetName=d.value.targetName);const t=await uni.request({url:E.API_BASE_URL+"/api/operation-logs",method:"GET",data:e});200===t.statusCode&&(n.value=t.data.data,s.value=t.data.total)}catch(e){t("error","at pages/direct.vue:264","获取操作日志失败:",e),uni.showToast({title:"获取操作日志失败",icon:"none"})}},v=e=>{if(!e||"string"!=typeof e)return[];return e.split("|").map((e=>{const[t,a]=e.split(":");return{label:t,value:a}}))},b=e=>{if(e.f_value&&e.f_value.includes("|")){const[,t]=e.f_value.split("|");return t.split(":")[1]}return"on"},S=async(e,a,i,o,r=1)=>{try{await uni.request({url:E.API_BASE_URL+"/api/operation-log",method:"POST",data:{operation_type:e,target_name:a,old_value:i,new_value:o,status:r}})}catch(l){t("error","at pages/direct.vue:318","记录操作日志失败:",l)}},A=async(e,a)=>{try{await uni.request({url:E.API_BASE_URL+"/api/send-direct",method:"POST",data:{topic:"send",message:{scene:e,device:"light",action:String(a)}}}),t("log","at pages/direct.vue:337",`机房 ${e} 控制指令发送成功：${a}`)}catch(i){t("error","at pages/direct.vue:339",`机房 ${e} 控制指令发送失败：`,i),uni.showToast({title:"设备控制失败",icon:"none"})}},T=async(e,a)=>{const i=l.value[e.id]||e.direct_value;try{let t=a;"1"!==e.f_type&&"5"!==e.f_type||(t=String(a)),"3"===e.f_type&&(t=String(a));200===(await uni.request({url:`${E.API_BASE_URL}/api/direct/${e.id}`,method:"PUT",data:{value:t}})).statusCode&&("机房1灯泡开关"===e.t_name?await A("01",t):"机房2灯泡开关"===e.t_name?await A("02",t):"机房3灯泡开关"===e.t_name&&await A("03",t),await S("指令操作",e.t_name,i,t,1),l.value[e.id]=t,e.direct_value=t,uni.showToast({title:"更新成功",icon:"success"}),m(),y())}catch(o){await S("指令操作",e.t_name,i,a,0),t("error","at pages/direct.vue:398","更新失败:",o),uni.showToast({title:"更新失败",icon:"none"})}},k=e=>{u.value=e.detail.value},P=e=>{p.value=e.detail.value},_=e=>{x.value=e.detail.value},D=e=>{g.value=e.detail.value},N=()=>{f.value.open()},M=()=>{},L=async()=>{try{200===(await uni.request({url:E.API_BASE_URL+"/api/operation-logs",method:"DELETE"})).statusCode&&(uni.showToast({title:"日志清空成功",icon:"success"}),f.value.close(),y())}catch(e){t("error","at pages/direct.vue:466","清空日志失败:",e),uni.showToast({title:"清空日志失败",icon:"none"})}},F=()=>{c.value>1&&(c.value--,y())},V=()=>{c.value<Math.ceil(s.value/h.value)&&(c.value++,y())},I=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN")};return e.onMounted((()=>{m(),y()})),(t,i)=>{const m=a(e.resolveDynamicComponent("uni-popup-dialog"),w),S=a(e.resolveDynamicComponent("uni-popup"),C);return e.openBlock(),e.createElementBlock("view",{class:"direct-container"},[e.createElementVNode("view",{class:"config-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"title"},"指令配置")]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"config-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["config-item",{disabled:!t.visible}])},[e.createElementVNode("view",{class:"config-header"},[e.createElementVNode("text",{class:"config-name"},e.toDisplayString(t.t_name),1),e.createElementVNode("view",{class:"config-status"},[e.createElementVNode("text",{class:e.normalizeClass(["status-tag",t.visible?"available":"unavailable"])},e.toDisplayString(t.visible?"可用":"不可用"),3)])]),t.visible?(e.openBlock(),e.createElementBlock("view",{key:0,class:"config-control"},["1"===t.f_type?(e.openBlock(),e.createElementBlock("view",{key:0,class:"control-switch"},[e.createElementVNode("switch",{checked:t.direct_value===b(t),onChange:e=>(async(e,t)=>{const a=t.detail.value?b(e):(e=>{if(e.f_value&&e.f_value.includes("|")){const[t]=e.f_value.split("|");return t.split(":")[1]}return"off"})(e);await T(e,a)})(t,e),color:"#007AFF"},null,40,["checked","onChange"])])):"2"===t.f_type?(e.openBlock(),e.createElementBlock("view",{key:1,class:"control-input"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":e=>t.direct_value=e,placeholder:"请输入值",onBlur:()=>T(t,t.direct_value),class:"input-field"},null,40,["onUpdate:modelValue","onBlur"]),[[e.vModelText,t.direct_value]])])):"3"===t.f_type?(e.openBlock(),e.createElementBlock("view",{key:2,class:"control-slider"},[e.createElementVNode("slider",{value:Number(t.direct_value)||0,min:t.min?Number(t.min):0,max:t.max?Number(t.max):100,onChange:e=>(async(e,t)=>{e.id in l.value||(l.value[e.id]=r.value[e.id]||e.direct_value);const a=Number(t);r.value[e.id]=a,await T(e,String(a))})(t,e.detail.value),activeColor:"#007AFF",backgroundColor:"#f5f6fa","block-color":"#007AFF","block-size":"24","show-value":""},null,40,["value","min","max","onChange"])])):"4"===t.f_type?(e.openBlock(),e.createElementBlock("view",{key:3,class:"control-time"},[e.createElementVNode("picker",{mode:"time",value:t.direct_value,onChange:e=>T(t,e.detail.value)},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(t.direct_value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value","onChange"])])):"5"===t.f_type?(e.openBlock(),e.createElementBlock("view",{key:4,class:"control-radio"},[e.createElementVNode("radio-group",{onChange:e=>T(t,e.detail.value)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v(t.f_value),(a=>(e.openBlock(),e.createElementBlock("label",{key:a.value,class:"radio-item"},[e.createElementVNode("radio",{value:a.value,checked:t.direct_value===a.value,color:"#007AFF"},null,8,["value","checked"]),e.createElementVNode("text",{class:"radio-text"},e.toDisplayString(a.label),1)])))),128))],40,["onChange"])])):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"config-value"},[e.createElementVNode("text",{class:"disabled-value"},e.toDisplayString(t.direct_value||t.f_value),1)]))],2)))),128))])]),e.createElementVNode("view",{class:"log-section"},[e.createElementVNode("view",{class:"section-header"},[e.createElementVNode("text",{class:"title"},"操作日志"),e.createElementVNode("view",{class:"log-controls"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[0]||(i[0]=e=>d.value.targetName=e),placeholder:"搜索目标名称",class:"search-input",onConfirm:y},null,544),[[e.vModelText,d.value.targetName]]),e.createElementVNode("button",{class:"search-btn",onClick:y},"查询"),e.createElementVNode("button",{class:"clear-btn",onClick:N},"清空")])]),e.createElementVNode("view",{class:"time-filter"},[e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"开始时间:"),e.createElementVNode("picker",{mode:"date",value:u.value,onChange:k},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(u.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:p.value,onChange:P},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(p.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])]),e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"time-label"},"结束时间:"),e.createElementVNode("picker",{mode:"date",value:x.value,onChange:_},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(x.value||"选择日期"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"]),e.createElementVNode("picker",{mode:"time",value:g.value,onChange:D},[e.createElementVNode("view",{class:"time-picker"},[e.createElementVNode("text",null,e.toDisplayString(g.value||"选择时间"),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["value"])])]),e.createElementVNode("scroll-view",{"scroll-y":"",class:"log-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.id,class:"log-item"},[e.createElementVNode("view",{class:"log-header"},[e.createElementVNode("text",{class:"operation-type"},e.toDisplayString(t.operation_type),1),e.createElementVNode("text",{class:"operation-time"},e.toDisplayString(I(t.operation_time)),1)]),e.createElementVNode("view",{class:"log-content"},[e.createElementVNode("text",{class:"target-name"},e.toDisplayString(t.target_name),1),e.createElementVNode("view",{class:"value-change"},[e.createElementVNode("text",{class:"old-value"},e.toDisplayString(t.old_value||"无"),1),e.createElementVNode("text",{class:"arrow"},"→"),e.createElementVNode("text",{class:"new-value"},e.toDisplayString(t.new_value),1)]),e.createElementVNode("view",{class:"log-status"},[e.createElementVNode("text",{class:e.normalizeClass(["status-tag",1===t.status?"success":"failed"])},e.toDisplayString(1===t.status?"成功":"失败"),3)])])])))),128))]),e.createElementVNode("view",{class:"pagination"},[e.createElementVNode("button",{disabled:c.value<=1,onClick:F,class:"page-btn"},"上一页",8,["disabled"]),e.createElementVNode("text",{class:"page-info"},"第 "+e.toDisplayString(c.value)+" 页，共 "+e.toDisplayString(Math.ceil(s.value/h.value))+" 页",1),e.createElementVNode("button",{disabled:c.value>=Math.ceil(s.value/h.value),onClick:V,class:"page-btn"},"下一页",8,["disabled"])])]),e.createVNode(S,{ref_key:"clearPopup",ref:f,type:"dialog"},{default:e.withCtx((()=>[e.createVNode(m,{title:"确认清空",content:"确定要清空所有操作日志吗？此操作不可恢复！",onConfirm:L,onClose:M})])),_:1},512)])}}},et={__name:"roomDetail",setup(a){const i=e.ref({}),l=e.ref([]),n=e.ref([]),s=e.ref([]),c=e.ref([]),h=e.ref(-1),d=e.ref(""),u=e.ref(null),p=e.ref(""),x=e.ref(!1),g=e.ref(!1),f=e.ref("");o((e=>{e.roomId&&(f.value=e.roomId)}));const m=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN")},y=async e=>{x.value=!0,u.value={type:"warning",text:"切换中..."};try{const a=await uni.request({url:`${E.API_BASE_URL}/api/camera/${e}/switch`,method:"POST"});200===a.statusCode&&a.data.success&&(p.value=a.data.iframeUrl,u.value={type:"success",text:"连接成功"},t("log","at pages/roomDetail.vue:195","摄像头切换成功"))}catch(a){u.value={type:"danger",text:"切换失败"},uni.showToast({title:"摄像头切换失败",icon:"none"}),t("error","at pages/roomDetail.vue:206","摄像头切换失败:",a)}finally{x.value=!1}},v=async e=>{h.value=Number(e.detail.value);const t=c.value[h.value];t&&(d.value=t.address,await y(d.value))},b=async()=>{if(d.value){x.value=!0;try{await y(d.value)}finally{x.value=!1}}},w=async()=>{uni.navigateBack()},S=async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/data1",method:"GET",data:{deviceId:f.value}});200===e.statusCode&&(l.value=e.data.data,n.value=e.data.header,s.value=e.data.units)}catch(e){t("error","at pages/roomDetail.vue:299","获取传感器数据失败:",e),uni.showToast({title:"获取传感器数据失败",icon:"none"})}},A=()=>{S(),uni.showToast({title:"数据已刷新",icon:"success"})},T=async()=>{if(d.value){g.value=!0;try{uni.showToast({title:"正在截取图像...",icon:"loading"});const e=await uni.request({url:`${E.API_BASE_URL}/api/camera/${d.value}/capture`,method:"POST"});if(200===e.statusCode&&e.data.success)return uni.showToast({title:"图像截取成功",icon:"success"}),e.data.data.base64Image}catch(e){return uni.showToast({title:"图像截取失败",icon:"none"}),t("error","at pages/roomDetail.vue:351","图像截取失败:",e),null}finally{g.value=!1}}else uni.showToast({title:"请先选择摄像头",icon:"none"})},k=async()=>{try{uni.showToast({title:"正在进行AI检测...",icon:"loading"});const i=await T();if(!i)throw new Error("截图失败");const o=await uni.request({url:"http://192.168.1.100:5000/infer",method:"POST",data:{image:i}});if(200===o.statusCode&&o.data.inference_results)try{await uni.request({url:E.API_BASE_URL+"/api/behaviorData/add",method:"POST",data:{d_no:f.value,originalImage:i,processedImage:o.data.processed_image,detectionCount:o.data.inference_results.length,results:o.data.inference_results}});if(o.data.inference_results.some((e=>"person"===e.label)))try{await uni.request({url:E.API_BASE_URL+"/api/error-messages",method:"POST",data:{d_no:f.value,e_msg:"人员报警"}}),uni.showToast({title:"AI检测完成，检测到人员信息，已记录报警信息",icon:"none"})}catch(e){t("error","at pages/roomDetail.vue:415","插入报警信息失败:",e),uni.showToast({title:`AI检测完成，检测到 ${o.data.inference_results.length} 个目标`,icon:"success"})}else uni.showToast({title:`AI检测完成，检测到 ${o.data.inference_results.length} 个目标`,icon:"success"})}catch(a){t("error","at pages/roomDetail.vue:428","保存AI检测结果失败:",a),uni.showToast({title:"保存检测结果失败",icon:"none"})}}catch(i){uni.showToast({title:"AI检测失败",icon:"none"}),t("error","at pages/roomDetail.vue:440","AI检测失败:",i)}},C=()=>{u.value={type:"danger",text:"画面异常"},uni.showToast({title:"视频流加载失败",icon:"none"})};return e.onMounted((async()=>{if(await(async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/allDevices",method:"GET"});if(200===e.statusCode){const t=e.data.data.find((e=>e.number===f.value));t?i.value=t:(uni.showToast({title:"未找到该机房信息",icon:"none"}),w())}}catch(e){t("error","at pages/roomDetail.vue:276","获取机房信息失败:",e),uni.showToast({title:"获取机房信息失败",icon:"none"})}})(),await S(),await(async()=>{try{const e=await uni.request({url:E.API_BASE_URL+"/api/cameras",method:"GET"});200===e.statusCode&&(c.value=e.data.data)}catch(e){t("error","at pages/roomDetail.vue:167","获取摄像头列表失败:",e),uni.showToast({title:"获取摄像头列表失败",icon:"none"})}})(),c.value.length>0){const e=f.value;let t=0;"01"===e?t=0:"02"===e?t=1:"03"===e&&(t=2),c.value[t]&&(h.value=t,d.value=c.value[t].address,await y(d.value))}})),r((async()=>{t("log","at pages/roomDetail.vue:482","页面卸载，停止所有摄像头流")})),(t,a)=>{var o;return e.openBlock(),e.createElementBlock("view",{class:"room-detail-container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("button",{class:"back-btn",onClick:w},"← 返回"),e.createElementVNode("text",{class:"page-title"},e.toDisplayString(i.value.device_name||"机房详情"),1)]),e.createElementVNode("view",{class:"info-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"机房基本信息"),e.createElementVNode("view",{class:"status-tag success"},"运行正常")]),e.createElementVNode("view",{class:"info-content"},[e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"机房名称:"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(i.value.device_name),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"机房编号:"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(i.value.number),1)]),e.createElementVNode("view",{class:"info-row"},[e.createElementVNode("text",{class:"info-label"},"创建时间:"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(m(i.value.ctime)),1)]),e.createElementVNode("view",{class:"info-row full-width"},[e.createElementVNode("text",{class:"info-label"},"描述:"),e.createElementVNode("text",{class:"info-value"},e.toDisplayString(i.value.remarks||"暂无描述"),1)])])]),e.createElementVNode("view",{class:"content-row"},[e.createElementVNode("view",{class:"env-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"实时环境参数"),e.createElementVNode("button",{class:"refresh-btn",onClick:A},"刷新")]),l.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"env-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:t,class:"env-item"},[e.createElementVNode("text",{class:"env-label"},e.toDisplayString(t)+"("+e.toDisplayString(s.value[a])+"):",1),e.createElementVNode("text",{class:"env-value"},e.toDisplayString(l.value[0][t]||"--"),1)])))),128)),e.createElementVNode("view",{class:"update-time"}," 更新时间: "+e.toDisplayString(l.value[0]["创建时间"]),1)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no-data"},[e.createElementVNode("text",null,"暂无传感器数据")]))]),e.createElementVNode("view",{class:"video-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"视频监控"),e.createElementVNode("picker",{mode:"selector",range:c.value,value:h.value,"range-key":"name",onChange:v,class:"camera-picker"},[e.createElementVNode("view",{class:"picker-value"},[e.createElementVNode("text",null,e.toDisplayString(-1===h.value?"选择摄像头":null==(o=c.value[h.value])?void 0:o.name),1),e.createElementVNode("text",{class:"picker-arrow"},"▼")])],40,["range","value"])]),e.createElementVNode("view",{class:"video-content"},[d.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"video-wrapper"},[e.createElementVNode("view",{class:"video-player"},[p.value&&!x.value?(e.openBlock(),e.createElementBlock("web-view",{key:0,src:p.value,class:"video-webview",onError:C},null,40,["src"])):x.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"loading-stream"},[e.createElementVNode("text",null,"正在连接摄像头...")])):(e.openBlock(),e.createElementBlock("view",{key:2,class:"loading-stream"},[e.createElementVNode("text",null,"选择摄像头查看实时画面")])),u.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"connection-status"},[e.createElementVNode("text",{class:e.normalizeClass(["status-text",u.value.type])},e.toDisplayString(u.value.text),3)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"video-controls"},[e.createElementVNode("button",{class:"control-btn capture",onClick:T,disabled:g.value}," 📷 截图 ",8,["disabled"]),e.createElementVNode("button",{class:"control-btn ai-detect",onClick:k}," 🤖 AI检测 "),e.createElementVNode("button",{class:"control-btn refresh",onClick:b}," 🔄 刷新画面 ")])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"no-camera"},[e.createElementVNode("text",null,"请选择摄像头")]))])])])])}}};__definePage("pages/device",_),__definePage("pages/data1",Ze),__definePage("pages/data2",Je),__definePage("pages/error",Ke),__definePage("pages/direct",Qe),__definePage("pages/roomDetail",et);const tt={onLaunch:function(){t("log","at App.vue:4","App Launch")},onShow:function(){t("log","at App.vue:7","App Show")},onHide:function(){t("log","at App.vue:10","App Hide")}},at=Symbol();
/*!
   * pinia v2.3.1
   * (c) 2025 Eduardo San Martin Morote
   * @license MIT
   */var it,ot;(ot=it||(it={})).direct="direct",ot.patchObject="patch object",ot.patchFunction="patch function";const{app:rt,Vuex:lt,Pinia:nt}=function(){const t=e.createVueApp(tt);return t.use(function(){const t=e.effectScope(!0),a=t.run((()=>e.ref({})));let i=[],o=[];const r=e.markRaw({install(e){r._a=e,e.provide(at,r),e.config.globalProperties.$pinia=r,o.forEach((e=>i.push(e))),o=[]},use(e){return this._a?i.push(e):o.push(e),this},_p:i,_a:null,_e:t,_s:new Map,state:a});return r}()),{app:t}}();uni.Vuex=lt,uni.Pinia=nt,rt.provide("__globalStyles",__uniConfig.styles),rt._component.mpType="app",rt._component.render=()=>{},rt.mount("#app")}(Vue);
